!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).wowzarts={})}(this,(function(e){"use strict";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(e){var t={exports:{}};return e(t,t.exports),t.exports}var s=i((function(e){!function(t){var r,n={};n.VERSION="1.6.1";var i={},s=function(e,t){return function(){return t.apply(e,arguments)}},o=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},a=function(e,t){return{value:e,name:t}};n.TRACE=a(1,"TRACE"),n.DEBUG=a(2,"DEBUG"),n.INFO=a(3,"INFO"),n.TIME=a(4,"TIME"),n.WARN=a(5,"WARN"),n.ERROR=a(8,"ERROR"),n.OFF=a(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(n.TRACE,arguments)},debug:function(){this.invoke(n.DEBUG,arguments)},info:function(){this.invoke(n.INFO,arguments)},warn:function(){this.invoke(n.WARN,arguments)},error:function(){this.invoke(n.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"end"])},invoke:function(e,t){r&&this.enabledFor(e)&&r(t,o({level:e},this.context))}};var u,l=new c({filterLevel:n.OFF});(u=n).enabledFor=s(l,l.enabledFor),u.trace=s(l,l.trace),u.debug=s(l,l.debug),u.time=s(l,l.time),u.timeEnd=s(l,l.timeEnd),u.info=s(l,l.info),u.warn=s(l,l.warn),u.error=s(l,l.error),u.log=u.info,n.setHandler=function(e){r=e},n.setLevel=function(e){for(var t in l.setLevel(e),i)i.hasOwnProperty(t)&&i[t].setLevel(e)},n.getLevel=function(){return l.getLevel()},n.get=function(e){return i[e]||(i[e]=new c(o({name:e},l.context)))},n.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(i,s){i=Array.prototype.slice.call(i);var o,a=console.log;s.level===n.TIME?(o=(s.name?"["+s.name+"] ":"")+i[0],"start"===i[1]?console.time?console.time(o):t[o]=(new Date).getTime():console.timeEnd?console.timeEnd(o):r(a,[o+": "+((new Date).getTime()-t[o])+"ms"])):(s.level===n.WARN&&console.warn?a=console.warn:s.level===n.ERROR&&console.error?a=console.error:s.level===n.INFO&&console.info?a=console.info:s.level===n.DEBUG&&console.debug?a=console.debug:s.level===n.TRACE&&console.trace&&(a=console.trace),e.formatter(i,s),r(a,i))}},n.useDefaults=function(e){n.setLevel(e&&e.defaultLevel||n.DEBUG),n.setHandler(n.createDefaultHandler(e))},n.setDefaults=n.useDefaults,e.exports?e.exports=n:(n._prevLogger=t.Logger,n.noConflict=function(){return t.Logger=n._prevLogger,n},t.Logger=n)}(n)}));function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function a(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}s.useDefaults({defaultLevel:s.TRACE});var l=function(e,t){e.unshift("[".concat(t.name||"Global","] ").concat((new Date).toISOString()," - ").concat(t.level.name," -"))},f=function(e,t){return t?e.value>=g[t].value:e.value>=m.value},d=s.createDefaultHandler({formatter:l});s.setHandler((function(e,t){!function(e,t){e=(e=Array.prototype.slice.call(e)).map((function(e){return"object"===r(e)?JSON.stringify(e):e})),l(e,t),0!==p?(h.push(e.join(" ")),h.length>=p&&(h=h.slice(-p))):h=[]}(e,t),f(t.level,t.name)&&d(e,t);var n,i=c(y);try{for(i.s();!(n=i.n()).done;){var s=n.value,o=s.handler,a=s.level;t.level.value>=a.value&&o(e,t)}}catch(e){i.e(e)}finally{i.f()}}));var p=1e4,h=[],m=s.OFF,g={},y=[],v=a(a({},s),{},{enabledFor:f,getHistory:function(){return h},getHistoryMaxSize:function(){return p},setHistoryMaxSize:function(e){p=e},setLevel:function(e){for(var t in m=e,g)g[t]=e},getLevel:function(){return m},get:function(e){g[e]||(g[e]=m);var t=s.get(e);return t.setLevel=function(t){g[e]=t},t.getLevel=function(){return g[e]},t},setHandler:function(e,t){y.push({handler:e,level:t})}});function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function b(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t,r,n,i,s,o){try{var a=e[s](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,i)}function C(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){S(s,n,i,o,a,"next",e)}function a(e){S(s,n,i,o,a,"throw",e)}o(void 0)}))}}function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t,r){return t&&k(e.prototype,t),r&&k(e,r),e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}function I(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var A=i((function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var i=t&&t.prototype instanceof g?t:g,s=Object.create(i.prototype),o=new I(n||[]);return s._invoke=function(e,t,r){var n=f;return function(i,s){if(n===p)throw new Error("Generator is already running");if(n===h){if("throw"===i)throw s;return A()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=x(o,r);if(a){if(a===m)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===f)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=l(e,t,r);if("normal"===c.type){if(n=r.done?h:d,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=h,r.method="throw",r.arg=c.arg)}}}(e,r,o),s}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var f="suspendedStart",d="suspendedYield",p="executing",h="completed",m={};function g(){}function y(){}function v(){}var w={};c(w,s,(function(){return this}));var b=Object.getPrototypeOf,S=b&&b(b(P([])));S&&S!==r&&n.call(S,s)&&(w=S);var C=v.prototype=g.prototype=Object.create(w);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(i,s,o,a){var c=l(e[i],e,s);if("throw"!==c.type){var u=c.arg,f=u.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,o,a)}),(function(e){r("throw",e,o,a)})):t.resolve(f).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,a)}))}a(c.arg)}var i;this._invoke=function(e,n){function s(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(s,s):s()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var s=i.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function P(e){if(e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:A}}function A(){return{value:t,done:!0}}return y.prototype=v,c(C,"constructor",v),c(v,"constructor",y),y.displayName=c(v,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,c(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},E(k.prototype),c(k.prototype,o,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new k(u(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(C),c(C,a,"Generator"),c(C,s,(function(){return this})),c(C,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=P,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})),O=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},L=Object.prototype.toString;function B(e){return"[object Array]"===L.call(e)}function N(e){return void 0===e}function D(e){return null!==e&&"object"==typeof e}function j(e){if("[object Object]"!==L.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function M(e){return"[object Function]"===L.call(e)}function U(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),B(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}var _={isArray:B,isArrayBuffer:function(e){return"[object ArrayBuffer]"===L.call(e)},isBuffer:function(e){return null!==e&&!N(e)&&null!==e.constructor&&!N(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:D,isPlainObject:j,isUndefined:N,isDate:function(e){return"[object Date]"===L.call(e)},isFile:function(e){return"[object File]"===L.call(e)},isBlob:function(e){return"[object Blob]"===L.call(e)},isFunction:M,isStream:function(e){return D(e)&&M(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:U,merge:function e(){var t={};function r(r,n){j(t[n])&&j(r)?t[n]=e(t[n],r):j(r)?t[n]=e({},r):B(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)U(arguments[n],r);return t},extend:function(e,t,r){return U(t,(function(t,n){e[n]=r&&"function"==typeof t?O(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}};function F(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var V=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(_.isURLSearchParams(t))n=t.toString();else{var i=[];_.forEach(t,(function(e,t){null!=e&&(_.isArray(e)?t+="[]":e=[e],_.forEach(e,(function(e){_.isDate(e)?e=e.toISOString():_.isObject(e)&&(e=JSON.stringify(e)),i.push(F(t)+"="+F(e))})))})),n=i.join("&")}if(n){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e};function z(){this.handlers=[]}z.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},z.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},z.prototype.forEach=function(e){_.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var G=z,q=function(e,t,r){return _.forEach(r,(function(r){e=r(e,t)})),e},$=function(e){return!(!e||!e.__CANCEL__)},H=function(e,t){_.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))},X=function(e,t,r,n,i){return function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,r,n,i)},W=_.isStandardBrowserEnv()?{write:function(e,t,r,n,i,s){var o=[];o.push(e+"="+encodeURIComponent(t)),_.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),_.isString(n)&&o.push("path="+n),_.isString(i)&&o.push("domain="+i),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},Y=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],J=_.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=_.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},Z=function(e){return new Promise((function(t,r){var n=e.data,i=e.headers;_.isFormData(n)&&delete i["Content-Type"];var s=new XMLHttpRequest;if(e.auth){var o=e.auth.username||"",a=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.Authorization="Basic "+btoa(o+":"+a)}var c,u,l=(c=e.baseURL,u=e.url,c&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(u)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(c,u):u);if(s.open(e.method.toUpperCase(),V(l,e.params,e.paramsSerializer),!0),s.timeout=e.timeout,s.onreadystatechange=function(){if(s&&4===s.readyState&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in s?function(e){var t,r,n,i={};return e?(_.forEach(e.split("\n"),(function(e){if(n=e.indexOf(":"),t=_.trim(e.substr(0,n)).toLowerCase(),r=_.trim(e.substr(n+1)),t){if(i[t]&&Y.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i}(s.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?s.response:s.responseText,status:s.status,statusText:s.statusText,headers:n,config:e,request:s};!function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(X("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}(t,r,i),s=null}},s.onabort=function(){s&&(r(X("Request aborted",e,"ECONNABORTED",s)),s=null)},s.onerror=function(){r(X("Network Error",e,null,s)),s=null},s.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(X(t,e,"ECONNABORTED",s)),s=null},_.isStandardBrowserEnv()){var f=(e.withCredentials||J(l))&&e.xsrfCookieName?W.read(e.xsrfCookieName):void 0;f&&(i[e.xsrfHeaderName]=f)}if("setRequestHeader"in s&&_.forEach(i,(function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete i[t]:s.setRequestHeader(t,e)})),_.isUndefined(e.withCredentials)||(s.withCredentials=!!e.withCredentials),e.responseType)try{s.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&s.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){s&&(s.abort(),r(e),s=null)})),n||(n=null),s.send(n)}))},K={"Content-Type":"application/x-www-form-urlencoded"};function Q(e,t){!_.isUndefined(e)&&_.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var ee,te={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(ee=Z),ee),transformRequest:[function(e,t){return H(t,"Accept"),H(t,"Content-Type"),_.isFormData(e)||_.isArrayBuffer(e)||_.isBuffer(e)||_.isStream(e)||_.isFile(e)||_.isBlob(e)?e:_.isArrayBufferView(e)?e.buffer:_.isURLSearchParams(e)?(Q(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):_.isObject(e)?(Q(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};te.headers={common:{Accept:"application/json, text/plain, */*"}},_.forEach(["delete","get","head"],(function(e){te.headers[e]={}})),_.forEach(["post","put","patch"],(function(e){te.headers[e]=_.merge(K)}));var re=te;function ne(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var ie=function(e){return ne(e),e.headers=e.headers||{},e.data=q(e.data,e.headers,e.transformRequest),e.headers=_.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),_.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||re.adapter)(e).then((function(t){return ne(e),t.data=q(t.data,t.headers,e.transformResponse),t}),(function(t){return $(t)||(ne(e),t&&t.response&&(t.response.data=q(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},se=function(e,t){t=t||{};var r={},n=["url","method","data"],i=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function a(e,t){return _.isPlainObject(e)&&_.isPlainObject(t)?_.merge(e,t):_.isPlainObject(t)?_.merge({},t):_.isArray(t)?t.slice():t}function c(n){_.isUndefined(t[n])?_.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(e[n],t[n])}_.forEach(n,(function(e){_.isUndefined(t[e])||(r[e]=a(void 0,t[e]))})),_.forEach(i,c),_.forEach(s,(function(n){_.isUndefined(t[n])?_.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(void 0,t[n])})),_.forEach(o,(function(n){n in t?r[n]=a(e[n],t[n]):n in e&&(r[n]=a(void 0,e[n]))}));var u=n.concat(i).concat(s).concat(o),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return _.forEach(l,c),r};function oe(e){this.defaults=e,this.interceptors={request:new G,response:new G}}oe.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=se(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[ie,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},oe.prototype.getUri=function(e){return e=se(this.defaults,e),V(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},_.forEach(["delete","get","head","options"],(function(e){oe.prototype[e]=function(t,r){return this.request(se(r||{},{method:e,url:t,data:(r||{}).data}))}})),_.forEach(["post","put","patch"],(function(e){oe.prototype[e]=function(t,r,n){return this.request(se(n||{},{method:e,url:t,data:r}))}}));var ae=oe;function ce(e){this.message=e}ce.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},ce.prototype.__CANCEL__=!0;var ue=ce;function le(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new ue(e),t(r.reason))}))}le.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},le.source=function(){var e;return{token:new le((function(t){e=t})),cancel:e}};var fe=le;function de(e){var t=new ae(e),r=O(ae.prototype.request,t);return _.extend(r,ae.prototype,t),_.extend(r,t),r}var pe=de(re);pe.Axios=ae,pe.create=function(e){return de(se(pe.defaults,e))},pe.Cancel=ue,pe.CancelToken=fe,pe.isCancel=$,pe.all=function(e){return Promise.all(e)},pe.spread=function(e){return function(t){return e.apply(null,t)}},pe.isAxiosError=function(e){return"object"==typeof e&&!0===e.isAxiosError};var he=pe,me=pe;he.default=me;var ge,ye=he,ve="object"==typeof Reflect?Reflect:null,we=ve&&"function"==typeof ve.apply?ve.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};ge=ve&&"function"==typeof ve.ownKeys?ve.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var be=Number.isNaN||function(e){return e!=e};function Se(){Se.init.call(this)}var Ce=Se,Ee=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,s),n(r)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}Be(e,t,s,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Be(e,"error",t,r)}(e,i,{once:!0})}))};Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var ke=10;function xe(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function Te(e){return void 0===e._maxListeners?Se.defaultMaxListeners:e._maxListeners}function Re(e,t,r,n){var i,s,o,a;if(xe(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),o=s[t]),void 0===o)o=s[t]=r,++e._eventsCount;else if("function"==typeof o?o=s[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(i=Te(e))>0&&o.length>i&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function Ie(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Pe(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=Ie.bind(n);return i.listener=r,n.wrapFn=i,i}function Ae(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):Le(i,i.length)}function Oe(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Le(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Be(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(s){n.once&&e.removeEventListener(t,i),r(s)}))}}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return ke},set:function(e){if("number"!=typeof e||e<0||be(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ke=e}}),Se.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||be(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},Se.prototype.getMaxListeners=function(){return Te(this)},Se.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var a=i[e];if(void 0===a)return!1;if("function"==typeof a)we(a,this,t);else{var c=a.length,u=Le(a,c);for(r=0;r<c;++r)we(u[r],this,t)}return!0},Se.prototype.addListener=function(e,t){return Re(this,e,t,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(e,t){return Re(this,e,t,!0)},Se.prototype.once=function(e,t){return xe(t),this.on(e,Pe(this,e,t)),this},Se.prototype.prependOnceListener=function(e,t){return xe(t),this.prependListener(e,Pe(this,e,t)),this},Se.prototype.removeListener=function(e,t){var r,n,i,s,o;if(xe(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){o=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},Se.prototype.listeners=function(e){return Ae(this,e,!0)},Se.prototype.rawListeners=function(e){return Ae(this,e,!1)},Se.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Oe.call(e,t)},Se.prototype.listenerCount=Oe,Se.prototype.eventNames=function(){return this._eventsCount>0?ge(this._events):[]},Ce.once=Ee;var Ne=Me,De=function(e,t){var r=new je;return Me(e,r,t),r},je=Ce.EventEmitter;function Me(e,t,r){Array.isArray(r)||(r=[r]);var n=[];return r.forEach((function(r){var i=function(){var e=[].slice.call(arguments);e.unshift(r),t.emit.apply(t,e)};n.push(i),e.on(r,i)})),function(){r.forEach((function(t,r){e.removeListener(t,n[r])}))}}function Ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function _e(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?Ue(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ve(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ze(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}Ne.filter=De;var Ge=v.get("PeerConnectionStats"),qe="stats",$e=function(e){R(r,e);var t=ze(r);function r(e){var n;return E(this,r),(n=t.call(this)).peer=e,n.stats=null,n.emitInterval=null,n.previousStats=null,n}return x(r,[{key:"init",value:function(){var e=this;Ge.info("Initializing peer connection stats"),this.emitInterval=setInterval(C(A.mark((function t(){var r;return A.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ge.debug("New interval executed"),t.next=3,e.peer.getStats();case 3:r=t.sent,e.parseStats(r),Ge.debug("Emitting stats"),e.emit(qe,e.stats);case 7:case"end":return t.stop()}}),t)}))),1e3)}},{key:"parseStats",value:function(e){Ge.debug("Parsing raw stats"),this.previousStats=this.stats;var t,r={audio:{inbounds:[],outbounds:[]},video:{inbounds:[],outbounds:[]},raw:e},n=Fe(e.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;switch(i.type){case"outbound-rtp":He(i,this.previousStats,r);break;case"inbound-rtp":Xe(i,this.previousStats,r);break;case"candidate-pair":i.nominated&&We(i,r)}}}catch(e){n.e(e)}finally{n.f()}this.stats=r}},{key:"stop",value:function(){Ge.info("Stopping peer connection stats"),clearInterval(this.emitInterval)}}]),r}(Ce),He=function(e,t,r){var n,i;Ge.debug("Parsing outbound-rtp report");var s=Ye(e),o=Je(e.codecId,r.raw),a=Ze(e,s);a.totalBytesSent=e.bytesSent,a.id=e.id;var c=t?null!==(n=null===(i=t[s].outbounds.find((function(e){return e.id===a.id})))||void 0===i?void 0:i.totalBytesSent)&&void 0!==n?n:0:null;a.bitrate=c?8*(e.bytesSent-c):0,"video"===s&&(a.qualityLimitationReason=e.qualityLimitationReason),r[s].outbounds.push(_e(_e({},o),a))},Xe=function(e,t,r){Ge.debug("Parsing inbound-rtp report");var n=Ye(e),i=Je(e.codecId,r.raw);["audio","video"].includes(n)||(n=e.id.includes("Video")?"video":"audio");var s=Ze(e,n);if(s.totalBytesReceived=e.bytesReceived,s.totalPacketsReceived=e.packetsReceived,s.totalPacketsLost=e.packetsLost,s.jitter=e.jitter,s.id=e.id,s.bitrate=0,s.packetsLostRatioPerSecond=0,s.packetsLostDeltaPerSecond=0,t){var o=t[n].inbounds.find((function(e){return e.id===s.id}));if(o){var a=o.totalBytesReceived;s.bitrate=8*(e.bytesReceived-a),s.packetsLostRatioPerSecond=Ke(s,o),s.packetsLostDeltaPerSecond=Qe(s,o)}}r[n].inbounds.push(_e(_e({},i),s))},We=function(e,t){Ge.debug("Parsing candidate-pair report"),t.totalRoundTripTime=e.totalRoundTripTime,t.currentRoundTripTime=e.currentRoundTripTime,t.availableOutgoingBitrate=e.availableOutgoingBitrate,t.candidateType=t.raw.get(e.localCandidateId).candidateType},Ye=function(e){return e.mediaType||e.kind},Je=function(e,t){var r;return{mimeType:(e&&null!==(r=t.get(e))&&void 0!==r?r:{}).mimeType}},Ze=function(e,t){var r={};return"video"===t&&(r.framesPerSecond=e.framesPerSecond,r.frameHeight=e.frameHeight,r.frameWidth=e.frameWidth),r.timestamp=e.timestamp,r},Ke=function(e,t){return Qe(e,t)/(e.totalPacketsReceived-t.totalPacketsReceived)},Qe=function(e,t){return e.totalPacketsLost-t.totalPacketsLost},et=i((function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))})),tt=i((function(e,t){var r=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var s=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=r(e[1]);else for(var s=0;s<n.length;s+=1)null!=e[s+1]&&(t[n[s]]=r(e[s+1]))}(n.match(e.reg),s,e.names,e.name),e.push&&t[e.push].push(s)},i=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],s=t;return e.split(/(\r\n|\r|\n)/).filter(i).forEach((function(e){var t=e[0],i=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),s=r[r.length-1]);for(var o=0;o<(et[t]||[]).length;o+=1){var a=et[t][o];if(a.reg.test(i))return n(a,s,i)}})),t.media=r,t};var s=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}})),rt=/%[sdv%]/g,nt=function(e){var t=1,r=arguments,n=r.length;return e.replace(rt,(function(e){if(t>=n)return e;var i=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},it=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var s=t.names[i];t.name?n.push(r[t.name][s]):n.push(r[t.names[i]])}else n.push(r[t.name]);return nt.apply(null,n)},st=["v","o","s","i","u","e","p","c","b","t","r","z","a"],ot=["i","c","b","a"],at={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||st,n=t.innerOrder||ot,i=[];return r.forEach((function(t){et[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(it(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(it(t,r,e))}))}))})),e.media.forEach((function(e){i.push(it("m",et.m[0],e)),n.forEach((function(t){et[t].forEach((function(r){r.name in e&&null!=e[r.name]?i.push(it(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){i.push(it(t,r,e))}))}))}))})),i.join("\r\n")+"\r\n"},parse:tt.parse,parseParams:tt.parseParams,parseFmtpConfig:tt.parseFmtpConfig,parsePayloads:tt.parsePayloads,parseRemoteCandidates:tt.parseRemoteCandidates,parseImageAttributes:tt.parseImageAttributes,parseSimulcastStreamList:tt.parseSimulcastStreamList};class ct{constructor(e,t,r,n,i,s,o,a,c){this.foundation=e,this.componentId=t,this.transport=r,this.priority=n,this.address=i,this.port=s,this.type=o,this.relAddr=a,this.relPort=c}equals(e){return e.foundation===this.foundation&&e.componentId===this.componentId&&e.transport===this.transport&&e.priority===this.priority&&e.address===this.address&&e.port===this.port&&e.type===this.type&&e.relAddr===this.relAddr&&e.relPort===this.relPort}clone(){return new ct(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.relAddr,this.relPort)}plain(){const e={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type};return this.relAddr&&(e.relAddr=this.relAddr),this.relPort&&(e.relPort=this.relPort),e}getFoundation(){return this.foundation}getComponentId(){return this.componentId}getTransport(){return this.transport}getPriority(){return this.priority}getAddress(){return this.address}getPort(){return this.port}getType(){return this.type}getRelAddr(){return this.relAddr}getRelPort(){return this.relPort}}ct.expand=function(e){return new ct(e.foundation,e.componentId,e.transport,e.priority,e.address,e.port,e.type,e.relAddr,e.relPort)};var ut=ct;class lt{constructor(e,t){this.id=e,this.params=t||[]}clone(){return new lt(this.id,this.params)}plain(){return this.params.length?{id:this.id,params:this.params}:{id:this.id}}getId(){return this.id}getParams(){return this.params}}lt.expand=function(e){return new lt(e.id,e.params)};var ft=lt;class dt{constructor(e,t,r){this.codec=e,this.type=t,this.params={},this.rtcpfbs=new Set,r&&this.addParams(r)}clone(){const e=new dt(this.codec,this.type,this.params);this.hasRTX()&&e.setRTX(this.getRTX());for(const t of this.rtcpfbs)e.addRTCPFeedback(t.clone());return this.hasChannels()&&e.setChannels(this.getChannels()),e}plain(){const e={codec:this.codec,type:this.type};this.rtx&&(e.rtx=this.rtx),this.channels&&(e.channels=this.channels),Object.keys(this.params).length&&(e.params=this.params);for(const t of this.rtcpfbs)e.rtcpfbs||(e.rtcpfbs=[]),e.rtcpfbs.push(t.plain());return e}setRTX(e){this.rtx=e}getType(){return this.type}setType(e){this.type=e}getCodec(){return this.codec}getParams(){return this.params}addParams(e){for(const t in e)this.params[t]=e[t]}addParam(e,t){this.params[e]=t}hasParam(e){return this.params.hasOwnProperty(e)}getParam(e,t){return this.hasParam(e)?this.params[e]:""+t}hasRTX(){return this.rtx}getRTX(){return this.rtx}hasChannels(){return this.channels}getChannels(){return this.channels}setChannels(e){this.channels=e}addRTCPFeedback(e){this.rtcpfbs.add(e)}getRTCPFeedbacks(){return this.rtcpfbs}}dt.expand=function(e){const t=new dt(e.codec,e.type,e.params);e.rtx&&t.setRTX(e.rtx),e.channels&&t.setChannels(e.channels);for(let r=0;e.rtcpfbs&&r<e.rtcpfbs.length;++r){const n=ft.expand(e.rtcpfbs[r]);t.addRTCPFeedback(n)}return t},dt.MapFromNames=function(e,t,r){const n=new Map;let i=96;for(let s=0;s<e.length;++s){let o;const a=e[s].split(";"),c=a[0].toLowerCase().trim();o="pcmu"===c?0:"pcma"===c?8:++i;const u=new dt(c,o);"opus"===c?u.setChannels(2):"multiopus"===c&&u.setChannels(6),t&&"ulpfec"!==c&&"flexfec-03"!==c&&"red"!==c&&u.setRTX(++i);for(let e=0;r&&e<r.length;++e)u.addRTCPFeedback(new ft(r[e].id,r[e].params));for(let e=1;e<a.length;++e){let t=a[e].split("=");u.addParam(t[0].trim(),t[1].trim())}n.set(u.getCodec().toLowerCase(),u)}return n};var pt=dt;var ht=function e(){var t=this;if(!(this instanceof e))return new(Function.prototype.bind.apply(e,[null].concat(Array.prototype.slice.call(arguments))));Array.from(arguments).forEach((function(e){t[e]=Symbol.for("MEDOOZE_SEMANTIC_SDP_"+e)}))};const mt=ht("ACTIVE","PASSIVE","ACTPASS","INACTIVE");mt.byValue=function(e){switch(e){case mt.ACTIVE:case mt.PASSIVE:case mt.ACTPASS:case mt.INACTIVE:return e}return mt[e.toUpperCase()]},mt.toString=function(e){switch(e){case mt.ACTIVE:return"active";case mt.PASSIVE:return"passive";case mt.ACTPASS:return"actpass";case mt.INACTIVE:return"inactive"}},mt.reverse=function(e){switch(e){case mt.ACTIVE:return mt.PASSIVE;case mt.PASSIVE:return mt.ACTIVE;case mt.ACTPASS:return mt.PASSIVE;case mt.INACTIVE:return mt.INACTIVE}};var gt=mt;class yt{constructor(e,t,r){this.setup=e,this.hash=t,this.fingerprint=r}clone(){return new yt(this.setup,this.hash,this.fingerprint)}plain(){return{setup:gt.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}}getFingerprint(){return this.fingerprint}getHash(){return this.hash}getSetup(){return this.setup}setSetup(e){this.setup=e}}yt.expand=function(e){return new yt(e.setup?gt.byValue(e.setup):gt.ACTPASS,e.hash,e.fingerprint)};var vt=yt;class wt{constructor(e,t,r,n){this.tag=e,this.suite=t,this.keyParams=r,this.sessionParams=n}clone(){return new wt(this.tag,this.suite,this.keyParams,this.sessionParams)}plain(){return{tag:this.tag,suite:this.suite,keyParams:this.keyParams,sessionParams:this.sessionParams}}getSessionParams(){return this.sessionParams}getKeyParams(){return this.keyParams}getSuite(){return this.suite}getTag(){return this.tag}}wt.expand=function(e){return new wt(e.tag,e.suite,e.keyParams,e.sessionParams)};for(var bt=wt,St=function(e){var t=At(e),r=t[0],n=t[1];return 3*(r+n)/4-n},Ct=function(e){var t,r,n=At(e),i=n[0],s=n[1],o=new Tt(function(e,t,r){return 3*(t+r)/4-r}(0,i,s)),a=0,c=s>0?i-4:i;for(r=0;r<c;r+=4)t=xt[e.charCodeAt(r)]<<18|xt[e.charCodeAt(r+1)]<<12|xt[e.charCodeAt(r+2)]<<6|xt[e.charCodeAt(r+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;2===s&&(t=xt[e.charCodeAt(r)]<<2|xt[e.charCodeAt(r+1)]>>4,o[a++]=255&t);1===s&&(t=xt[e.charCodeAt(r)]<<10|xt[e.charCodeAt(r+1)]<<4|xt[e.charCodeAt(r+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t);return o},Et=function(e){for(var t,r=e.length,n=r%3,i=[],s=16383,o=0,a=r-n;o<a;o+=s)i.push(Ot(e,o,o+s>a?a:o+s));1===n?(t=e[r-1],i.push(kt[t>>2]+kt[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(kt[t>>10]+kt[t>>4&63]+kt[t<<2&63]+"="));return i.join("")},kt=[],xt=[],Tt="undefined"!=typeof Uint8Array?Uint8Array:Array,Rt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",It=0,Pt=Rt.length;It<Pt;++It)kt[It]=Rt[It],xt[Rt.charCodeAt(It)]=It;function At(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function Ot(e,t,r){for(var n,i,s=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(kt[(i=n)>>18&63]+kt[i>>12&63]+kt[i>>6&63]+kt[63&i]);return s.join("")}xt["-".charCodeAt(0)]=62,xt["_".charCodeAt(0)]=63;var Lt={byteLength:St,toByteArray:Ct,fromByteArray:Et},Bt=function(e,t,r,n,i){var s,o,a=8*i-n-1,c=(1<<a)-1,u=c>>1,l=-7,f=r?i-1:0,d=r?-1:1,p=e[t+f];for(f+=d,s=p&(1<<-l)-1,p>>=-l,l+=a;l>0;s=256*s+e[t+f],f+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=n;l>0;o=256*o+e[t+f],f+=d,l-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),s-=u}return(p?-1:1)*o*Math.pow(2,s-n)},Nt=function(e,t,r,n,i,s){var o,a,c,u=8*s-i-1,l=(1<<u)-1,f=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(o++,c/=2),o+f>=l?(a=0,o=l):o+f>=1?(a=(t*c-1)*Math.pow(2,i),o+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[r+p]=255&a,p+=h,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;e[r+p]=255&o,p+=h,o/=256,u-=8);e[r+p-h]|=128*m},Dt=i((function(e,t){const r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(e){+e!=e&&(e=0);return s.alloc(+e)},t.INSPECT_MAX_BYTES=50;const n=2147483647;function i(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return o(e,t,r)}function o(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!s.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|d(e,t);let n=i(r);const o=n.write(e,t);o!==r&&(n=n.slice(0,o));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(H(e,Uint8Array)){const t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(H(e,ArrayBuffer)||e&&H(e.buffer,ArrayBuffer))return l(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(H(e,SharedArrayBuffer)||e&&H(e.buffer,SharedArrayBuffer)))return l(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);const o=function(e){if(s.isBuffer(e)){const t=0|f(e.length),r=i(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||X(e.length)?i(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return a(e),i(e<0?0:0|f(e))}function u(e){const t=e.length<0?0:0|f(e.length),r=i(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function l(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,s.prototype),n}function f(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function d(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||H(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return q(e).length;default:if(i)return n?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return x(this,t,r);case"latin1":case"binary":return T(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function h(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),X(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,i){let s,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(u(e,s)===u(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===c)return n*o}else-1!==n&&(s-=s-n),n=-1}else for(r+c>a&&(r=a-c),s=r;s>=0;s--){let r=!0;for(let n=0;n<c;n++)if(u(e,s+n)!==u(t,n)){r=!1;break}if(r)return s}return-1}function y(e,t,r,n){r=Number(r)||0;const i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;const s=t.length;let o;for(n>s/2&&(n=s/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(X(n))return o;e[r+o]=n}return o}function v(e,t,r,n){return $(G(t,e.length-r),e,r,n)}function w(e,t,r,n){return $(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return $(q(t),e,r,n)}function S(e,t,r,n){return $(function(e,t){let r,n,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,i=r%256,s.push(i),s.push(n);return s}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?Lt.fromByteArray(e):Lt.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);const n=[];let i=t;for(;i<r;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:r=e[i+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(s=c));break;case 3:r=e[i+1],n=e[i+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){const t=e.length;if(t<=k)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=k));return r}(n)}t.kMaxLength=n,s.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,r){return o(e,t,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,r){return function(e,t,r){return a(e),e<=0?i(e):void 0!==t?"string"==typeof r?i(e).fill(t,r):i(e).fill(t):i(e)}(e,t,r)},s.allocUnsafe=function(e){return c(e)},s.allocUnsafeSlow=function(e){return c(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(H(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),H(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=s.allocUnsafe(t);let i=0;for(r=0;r<e.length;++r){let t=e[r];if(H(t,Uint8Array))i+t.length>n.length?(s.isBuffer(t)||(t=s.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else{if(!s.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,i)}i+=t.length}return n},s.byteLength=d,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)h(this,t,t+1);return this},s.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},s.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},s.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):p.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(e,t,r,n,i){if(H(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const c=Math.min(o,a),u=this.slice(n,i),l=e.slice(t,r);for(let e=0;e<c;++e)if(u[e]!==l[e]){o=u[e],a=l[e];break}return o<a?-1:a<o?1:0},s.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return v(this,e,t,r);case"ascii":case"latin1":case"binary":return w(this,e,t,r);case"base64":return b(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function x(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function T(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function R(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=W[e[n]];return i}function I(e,t,r){const n=e.slice(t,r);let i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}function P(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function A(e,t,r,n,i,o){if(!s.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function O(e,t,r,n,i){_(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function L(e,t,r,n,i){_(t,n,i,e,r,7);let s=Number(t&BigInt(4294967295));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function B(e,t,r,n,i,s){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function N(e,t,r,n,i){return t=+t,r>>>=0,i||B(e,0,r,4),Nt(e,t,r,n,23,4),r+4}function D(e,t,r,n,i){return t=+t,r>>>=0,i||B(e,0,r,8),Nt(e,t,r,n,52,8),r+8}s.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUintLE=s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},s.prototype.readUintBE=s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},s.prototype.readUint8=s.prototype.readUInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),this[e]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||P(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readBigUInt64LE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(i)<<BigInt(32))})),s.prototype.readBigUInt64BE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||P(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},s.prototype.readInt8=function(e,t){return e>>>=0,t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||P(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readBigInt64LE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),s.prototype.readBigInt64BE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),s.prototype.readFloatLE=function(e,t){return e>>>=0,t||P(e,4,this.length),Bt(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||P(e,4,this.length),Bt(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||P(e,8,this.length),Bt(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||P(e,8,this.length),Bt(this,e,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){A(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){A(this,e,t,r,Math.pow(2,8*r)-1,0)}let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},s.prototype.writeUint8=s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigUInt64LE=Y((function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=Y((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);A(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);A(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||A(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeBigInt64LE=Y((function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=Y((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(e,t,r){return N(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return N(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{const o=s.isBuffer(e)?e:s.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%a]}return this};const j={};function M(e,t,r){j[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function U(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function _(e,t,r,n,i,s){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new j.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,r){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||V(t,e.length-(r+1))}(n,i,s)}function F(e,t){if("number"!=typeof e)throw new j.ERR_INVALID_ARG_TYPE(t,"number",e)}function V(e,t,r){if(Math.floor(e)!==e)throw F(e,r),new j.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new j.ERR_BUFFER_OUT_OF_BOUNDS;throw new j.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}M("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),M("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),M("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=U(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=U(i)),i+="n"),n+=` It must be ${t}. Received ${i}`,n}),RangeError);const z=/[^+/0-9A-Za-z-_]/g;function G(e,t){let r;t=t||1/0;const n=e.length;let i=null;const s=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function q(e){return Lt.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function H(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function X(e){return e!=e}const W=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function Y(e){return"undefined"==typeof BigInt?J:e}function J(){throw new Error("BigInt not supported")}})),jt=i((function(e,t){var r=Dt.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=Dt:(n(Dt,t),t.Buffer=i),n(r,i),i.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},i.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return Dt.SlowBuffer(e)}})),Mt=i((function(e){var t=65536,r=4294967295;var i=jt.Buffer,s=n.crypto||n.msCrypto;s&&s.getRandomValues?e.exports=function(e,n){if(e>r)throw new RangeError("requested too many random bytes");var o=i.allocUnsafe(e);if(e>0)if(e>t)for(var a=0;a<e;a+=t)s.getRandomValues(o.slice(a,a+t));else s.getRandomValues(o);if("function"==typeof n)return process.nextTick((function(){n(null,o)}));return o}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}));class Ut{constructor(e,t){this.ufrag=e,this.pwd=t,this.lite=!1,this.endOfCandidates=!1}clone(){const e=new Ut(this.ufrag,this.pwd);return e.setLite(this.lite),e.setEndOfCandidates(this.endOfCandidates),e}plain(){const e={ufrag:this.ufrag,pwd:this.pwd};return this.lite&&(e.lite=this.lite),this.endOfCandidates&&(e.endOfCandidates=this.endOfCandidates),e}getUfrag(){return this.ufrag}getPwd(){return this.pwd}isLite(){return this.lite}setLite(e){this.lite=e}isEndOfCandidates(){return this.endOfCandidates}setEndOfCandidates(e){this.endOfCandidates=e}}Ut.generate=function(e){const t=new Ut,r=Mt(8),n=Mt(24);return t.ufrag=r.toString("hex"),t.pwd=n.toString("hex"),t.lite=e,t},Ut.expand=function(e){const t=new Ut(e.ufrag,e.pwd);return t.setLite(e.lite),t.setEndOfCandidates(e.endOfCandidates),t};var _t=Ut;const Ft=ht("SEND","RECV");Ft.byValue=function(e){return Ft[e.toUpperCase()]},Ft.toString=function(e){switch(e){case Ft.SEND:return"send";case Ft.RECV:return"recv"}},Ft.reverse=function(e){switch(e){case Ft.SEND:return Ft.RECV;case Ft.RECV:return Ft.SEND}};var Vt=Ft;class zt{constructor(e,t){this.id=e,this.direction=t,this.formats=[],this.params=new Map}clone(){var e=new zt(this.id,this.direction);return e.setFormats(this.formats),e.setParams(this.params),e}plain(){var e={id:this.id,direction:Vt.toString(this.direction)};for(var[t,r]of(this.formats&&(e.formats=this.formats),this.params.entries()))e.params||(e.params={}),e.params[t]=r;return e}getId(){return this.id}getDirection(){return this.direction}setDirection(e){this.direction=e}getFormats(){return this.formats}setFormats(e){this.formats=[];for(let t=0;t<e.length;++t)this.formats.push(parseInt(e[t]))}getParams(){return this.params}setParams(e){this.params=new Map(e)}addParam(e,t){this.params.set(e,t)}getDirection(){return this.direction}setDirection(e){this.direction=e}}zt.expand=function(e){const t=new zt(e.id,Vt.byValue(e.direction));for(let r in e.params)t.addParam(r,e.params[r]);return e.formats&&t.setFormats(e.formats),t};var Gt=zt;class qt{constructor(e,t){this.paused=t,this.id=e}clone(){return new qt(this.id,this.paused)}plain(){return{id:this.id,paused:this.paused}}isPaused(){return this.paused}getId(){return this.id}}qt.expand=function(e){return new qt(e.id,e.paused)};var $t=qt;class Ht{constructor(){this.send=[],this.recv=[]}clone(){const e=new Ht;for(let t=0;t<this.send.length;++t){let r=[];for(let e=0;t<this.send[e].length;++t)r.push(this.send[t][e].clone());e.addSimulcastAlternativeStreams(Vt.SEND,r)}for(let t=0;t<this.recv.length;++t){let r=[];for(let e=0;t<this.recv[e].length;++t)r.push(this.recv[t][e].clone());e.addSimulcastAlternativeStreams(Vt.RECV,r)}return e}plain(){const e={send:[],recv:[]};for(let t=0;t<this.send.length;++t){let r=[];for(let e=0;e<this.send[t].length;++e)r.push(this.send[t][e].plain());e.send.push(r)}for(let t=0;t<this.recv.length;++t){let r=[];for(let e=0;e<this.recv[t].length;++e)r.push(this.recv[t][e].plain());e.recv.push(r)}return e}addSimulcastAlternativeStreams(e,t){return e===Vt.SEND?this.send.push(t):this.recv.push(t)}addSimulcastStream(e,t){return e===Vt.SEND?this.send.push([t]):this.recv.push([t])}getSimulcastStreams(e){return e===Vt.SEND?this.send:this.recv}}Ht.expand=function(e){const t=new Ht;for(let r=0;r<e.send.length;++r){let n=[];for(let t=0;t<e.send[r].length;++t)n.push($t.expand(e.send[r][t]));t.addSimulcastAlternativeStreams(Vt.SEND,n)}for(let r=0;r<e.recv.length;++r){let n=[];for(let t=0;t<e.recv[r].length;++t)n.push($t.expand(e.recv[r][t]));t.addSimulcastAlternativeStreams(Vt.RECV,n)}return t};var Xt=Ht;const Wt=ht("SENDRECV","SENDONLY","RECVONLY","INACTIVE");Wt.byValue=function(e){return Wt[e.toUpperCase()]},Wt.toString=function(e){switch(e){case Wt.SENDRECV:return"sendrecv";case Wt.SENDONLY:return"sendonly";case Wt.RECVONLY:return"recvonly";case Wt.INACTIVE:return"inactive"}},Wt.reverse=function(e){switch(e){case Wt.SENDRECV:return Wt.SENDRECV;case Wt.SENDONLY:return Wt.RECVONLY;case Wt.RECVONLY:return Wt.SENDONLY;case Wt.INACTIVE:return Wt.INACTIVE}};var Yt=Wt;class Jt{constructor(e,t){this.id=e,this.type=t,this.direction=Yt.SENDRECV,this.extensions=new Map,this.codecs=new Map,this.rids=new Map,this.simulcast=null,this.bitrate=0,this.control=null}clone(){const e=new Jt(this.id,this.type);e.setDirection(this.direction),e.setBitrate(this.bitrate);for(const t of this.codecs.values())e.addCodec(t.clone());for(const[t,r]of this.extensions.entries())e.addExtension(t,r);for(const t of this.rids.values())e.addRID(t.clone());return this.simulcast&&e.setSimulcast(this.simulcast.clone()),this.control&&e.setControl(this.control),e}plain(){const e={id:this.id,type:this.type,direction:Yt.toString(this.direction),codecs:[]};this.bitrate&&(e.bitrate=this.bitrate);for(const t of this.codecs.values())e.codecs.push(t.plain());for(const[t,r]of this.extensions.entries())e.extensions||(e.extensions={}),e.extensions[t]=r;for(const t of this.rids.values())e.rids||(e.rids=[]),e.rids.push(t.plain());return this.simulcast&&(e.simulcast=this.simulcast.plain()),this.control&&(e.control=this.control),e}getType(){return this.type}getId(){return this.id}setId(e){this.id=e}addExtension(e,t){this.extensions.set(e,t)}addRID(e){this.rids.set(e.getId(),e)}addCodec(e){this.codecs.set(e.getType(),e)}setCodecs(e){this.codecs=e}getCodecForType(e){return this.codecs.get(e)}getCodec(e){for(const t of this.codecs.values())if(t.getCodec().toLowerCase()===e.toLowerCase())return t;return null}hasCodec(e){return null!==this.getCodec(e)}getCodecs(){return this.codecs}hasRTX(){for(const e of this.codecs.values())if(e.hasRTX())return!0;return!1}getExtensions(){return this.extensions}getRIDs(){return this.rids}getRID(e){return this.rids.get(e)}getBitrate(){return this.bitrate}setBitrate(e){this.bitrate=e}getDirection(){return this.direction}setDirection(e){this.direction=e}hasControl(){return!!this.control}getControl(){return this.control}setControl(e){this.control=e}answer(e){const t=new Jt(this.id,this.type);if(e){if(t.setDirection(Yt.reverse(this.direction)),e.codecs){let r;r=Array.isArray(e.codecs)?pt.MapFromNames(e.codecs,e.rtx,e.rtcpfbs):e.codecs;for(let e of this.codecs.values())if(r.has(e.getCodec().toLowerCase())){const n=r.get(e.getCodec().toLowerCase());if("h264"===n.getCodec()&&n.hasParam("packetization-mode")&&n.getParam("packetization-mode")!=e.getParam("packetization-mode","0"))continue;if("h264"===n.getCodec()&&n.hasParam("profile-level-id")&&e.hasParam("profile-level-id")&&n.getParam("profile-level-id")!=e.getParam("profile-level-id"))continue;if("multiopus"===n.getCodec()&&n.hasParam("num_streams")&&e.hasParam("num_streams")&&n.getParam("num_streams")!=e.getParam("num_streams"))continue;const i=n.clone();i.setType(e.getType()),i.hasRTX()&&i.setRTX(e.getRTX()),e.hasChannels()&&i.setChannels(e.getChannels()),i.addParams(e.getParams()),t.addCodec(i)}}const n=new Set(e.extensions);for(let[e,r]of this.extensions)n.has(r)&&t.addExtension(e,r);if(e.simulcast&&this.simulcast){const e=new Xt,n=this.simulcast.getSimulcastStreams(Vt.SEND);if(n)for(let t=0;t<n.length;++t){var r=[];for(let e=0;e<n[t].length;++e)r.push(n[t][e].clone());e.addSimulcastAlternativeStreams(Vt.RECV,r)}const i=this.simulcast.getSimulcastStreams(Vt.RECV);if(i)for(let t=0;t<i.length;++t){r=[];for(let e=0;e<i[t].length;++e)r.push(i[t][e].clone());e.addSimulcastAlternativeStreams(Vt.SEND,r)}for(const e of this.rids.values()){const r=e.clone();r.setDirection(Vt.reverse(e.getDirection())),t.addRID(r)}t.setSimulcast(e)}}else t.setDirection(Yt.INACTIVE);return t}getSimulcast(){return this.simulcast}setSimulcast(e){this.simulcast=e}}Jt.create=function(e,t){const r=new Jt(e,e);if(t){if(t.codecs&&(Array.isArray(t.codecs)?r.setCodecs(pt.MapFromNames(t.codecs,t.rtx,t.rtcpfbs)):r.setCodecs(t.codecs)),t.extensions){let e=1;for(let n of t.extensions)15===e&&e++,r.addExtension(e++,n)}}else r.setDirection(Yt.INACTIVE);return r},Jt.expand=function(e){const t=new Jt(e.id,e.type);e.direction&&t.setDirection(Yt.byValue(e.direction)),t.setBitrate(e.bitrate);for(let r in e.extensions)t.addExtension(r,e.extensions[r]);for(let r=0;e.codecs&&r<e.codecs.length;++r){const n=pt.expand(e.codecs[r]);n&&t.addCodec(n)}for(let r=0;e.rids&&r<e.rids.length;++r){const n=Gt.expand(e.rids[r]);t.addRID(n)}return e.simulcast&&t.setSimulcast(Xt.expand(e.simulcast)),e.control&&t.setControl(e.control),t};var Zt=Jt;class Kt{constructor(e,t){this.semantics=e,this.ssrcs=[];for(let e=0;e<t.length;++e)this.ssrcs.push(parseInt(t[e]))}clone(){return new Kt(this.semantics,this.ssrcs)}plain(){const e={semantics:this.semantics,ssrcs:[]};for(let t=0;t<this.ssrcs.length;++t)e.ssrcs.push(this.ssrcs[t]);return e}getSemantics(){return this.semantics}getSSRCs(){return this.ssrcs}}Kt.expand=function(e){return new Kt(e.semantics,e.ssrcs)};var Qt=Kt;class er{constructor(e){this.ssrc=e}clone(){const e=new er(this.ssrc);e.setCName(this.cname),e.setStreamId(this.streamId),e.setTrackId(this.trackId)}plain(){const e={ssrc:this.ssrc};return this.cname&&(e.cname=this.cname),this.streamId&&(e.streamId=this.streamId),this.trackId&&(e.trackid=this.trackId),e}getCName(){return this.cname}setCName(e){this.cname=e}getStreamId(){return this.streamId}setStreamId(e){this.streamId=e}getTrackId(){return this.trackId}setTrackId(e){this.trackId=e}getSSRC(){return this.ssrc}}er.expand=function(e){const t=new er(e.ssrc);return t.setCName(e.cname),t.setStreamId(e.streamId),t.setTrackId(e.trackId),t};var tr=er;class rr{constructor(e,t){this.id=e,this.paused=t,this.codecs=new Map,this.params=new Map}clone(){var e=new rr(this.id,this.paused);for(let t of this.codecs.values())e.addCodec(t.clone());return e.setParams(this.params),e}plain(){var e={id:this.id,paused:this.paused,codecs:{},params:{}};for(var[t,r]of this.codecs.entries())e.codecs[t]=r.plain();for(var[t,n]of this.params.entries())e.params[t]=n;return e}getId(){return this.id}getCodecs(){return this.codecs}addCodec(e){this.codecs.set(e.getType(),e)}getParams(){return this.params}setParams(e){this.params=new Map(e)}addParam(e,t){this.params.set(e,t)}isPaused(){return this.paused}}rr.expand=function(e){const t=new rr(e.id,e.paused);for(let r in e.codecs)t.addCodec(pt.expand(e.codecs[r]));for(let r in e.params)t.addParam(r,e.params[r]);return t};var nr=rr;class ir{constructor(e,t){this.media=e,this.id=t,this.ssrcs=[],this.groups=[],this.encodings=[]}clone(){const e=new ir(this.media,this.id);this.mediaId&&e.setMediaId(this.mediaId);for(let t=0;t<this.ssrcs.length;++t)e.addSSRC(this.ssrcs[t]);for(let t=0;t<this.groups.length;++t)e.addSourceGroup(this.groups[t].clone());for(let t=0;t<this.encodings.length;++t){const r=[];for(let e=0;e<this.encodings[t].length;++e)r.push(this.encodings[t][e].clone());e.addAlternativeEncodings(r)}return e}plain(){const e={media:this.media,id:this.id,ssrcs:[]};this.mediaId&&(e.mediaId=this.mediaId);for(let t=0;t<this.ssrcs.length;++t)e.ssrcs.push(this.ssrcs[t]);for(let t=0;t<this.groups.length;++t)e.groups||(e.groups=[]),e.groups.push(this.groups[t].plain());for(let t=0;t<this.encodings.length;++t){const r=[];for(let e=0;e<this.encodings[t].length;++e)r.push(this.encodings[t][e].plain());r.length&&(e.encodings||(e.encodings=[]),e.encodings.push(r))}return e}getMedia(){return this.media}setMediaId(e){this.mediaId=e}getMediaId(){return this.mediaId}getId(){return this.id}addSSRC(e){this.ssrcs.push(e)}getSSRCs(){return this.ssrcs}addSourceGroup(e){this.groups.push(e)}getSourceGroup(e){for(let t in this.groups){let r=this.groups[t];if(r.getSemantics().toLowerCase()===e.toLowerCase())return r}return null}getSourceGroups(){return this.groups}hasSourceGroup(e){for(let t in this.groups){if(this.groups[t].getSemantics().toLowerCase()===e.toLowerCase())return!0}return!1}getEncodings(){return this.encodings}addEncoding(e){this.encodings.push([e])}addAlternativeEncodings(e){this.encodings.push(e)}setEncodings(e){this.encodings=e}}ir.expand=function(e){const t=new ir(e.media,e.id);e.mediaId&&t.setMediaId(e.mediaId);for(let r=0;e.ssrcs&&r<e.ssrcs.length;++r)t.addSSRC(e.ssrcs[r]);for(let r=0;e.groups&&r<e.groups.length;++r)t.addSourceGroup(Qt.expand(e.groups[r]));for(let r=0;e.encodings&&r<e.encodings.length;++r){const n=[];for(let t=0;t<e.encodings[r].length;++t)n.push(nr.expand(e.encodings[r][t]));t.addAlternativeEncodings(n)}return t};var sr=ir;class or{constructor(e){this.id=e,this.tracks=new Map}clone(){const e=new or(this.id);for(const t of this.tracks.values())e.addTrack(t.clone());return e}plain(){const e={id:this.id,tracks:[]};for(const t of this.tracks.values())e.tracks.push(t.plain());return e}getId(){return this.id}addTrack(e){this.tracks.set(e.getId(),e)}removeTrack(e){return this.tracks.delete(e.getId())}removeTrackById(e){return this.tracks.delete(e)}getFirstTrack(e){for(let t of this.tracks.values())if(t.getMedia().toLowerCase()===e.toLowerCase())return t;return null}getTracks(){return this.tracks}removeAllTracks(){this.tracks.clear()}getTrack(e){return this.tracks.get(e)}}or.expand=function(e){const t=new or(e.id,e.paused);for(let r=0;r<e.tracks.length;++r){const n=sr.expand(e.tracks[r]);n&&t.addTrack(n)}return t};var ar=or;class cr{constructor(e){this.version=e||1,this.streams=new Map,this.medias=new Array,this.candidates=new Array,this.ice=null,this.dtls=null,this.crypto=null}clone(){const e=new cr(this.version);for(let t=0;t<this.medias.length;++t)e.addMedia(this.medias[t].clone());for(const t of this.streams.values())e.addStream(t.clone());for(let t=0;t<this.candidates.length;++t)e.addCandidate(this.candidates[t].clone());return e.setICE(this.ice.clone()),this.dtls&&e.setDTLS(this.dtls.clone()),this.crypto&&e.setCrypto(this.crypto.clone()),e}plain(){const e={version:this.version,streams:[],medias:[],candidates:[]};for(let t=0;t<this.medias.length;++t)e.medias.push(this.medias[t].plain());for(const t of this.streams.values())e.streams.push(t.plain());for(let t=0;t<this.candidates.length;++t)e.candidates.push(this.candidates[t].plain());return this.ice&&(e.ice=this.ice.plain()),this.dtls&&(e.dtls=this.dtls.plain()),this.crypto&&(e.crypto=this.crypto.plain()),e}unify(){const e=new cr(this.version);for(let t=0;t<this.medias.length;++t)e.addMedia(this.medias[t].clone());const t={audio:e.getMediasByType("audio"),video:e.getMediasByType("video")};for(const r of this.streams.values()){const n=r.clone();for(const r of n.getTracks().values()){let n=t[r.getMedia()].pop();if(!n){n=this.getMedia(r.getMedia()).clone(),n.setId(r.getId()),e.addMedia(n)}r.setMediaId(n.getId())}e.addStream(n)}for(let t=0;t<this.candidates.length;++t)e.addCandidate(this.candidates[t].clone());return this.ice&&e.setICE(this.ice.clone()),this.dtls&&e.setDTLS(this.dtls.clone()),this.crypto&&e.setCrypto(this.crypto.clone()),e}setVersion(e){this.version=e}addMedia(e){this.medias.push(e)}getMedia(e){for(let t in this.medias){let r=this.medias[t];if(r.getType().toLowerCase()===e.toLowerCase())return r}return null}getMediasByType(e){var t=[];for(let r in this.medias){let n=this.medias[r];n.getType().toLowerCase()===e.toLowerCase()&&t.push(n)}return t}getMediaById(e){for(let t in this.medias){let r=this.medias[t];if(r.getId().toLowerCase()===e.toLowerCase())return r}return null}replaceMedia(e){for(let t in this.medias)if(this.medias[t].getId()==e.getId())return this.medias[t]=e,!0;return!1}getMedias(){return this.medias}getVersion(){return this.version}getDTLS(){return this.dtls}setDTLS(e){this.dtls=e}hasCrypto(){return!!this.crypto}getCrypto(){return this.crypto}setCrypto(e){this.crypto=e}hasICE(){return!!this.ice}getICE(){return this.ice}setICE(e){this.ice=e}addCandidate(e){for(let t=0;t<this.candidates.length;++t)if(this.candidates[t].equals(e))return;this.candidates.push(e)}addCandidates(e){for(let t=0;t<e.length;++t)this.addCandidate(e[t])}getCandidates(){return this.candidates}getStream(e){return this.streams.get(e)}getStreams(){return this.streams}getFirstStream(){for(let e of this.streams.values())return e;return null}addStream(e){this.streams.set(e.getId(),e)}removeStream(e){return this.streams.delete(e.getId())}removeAllStreams(){this.streams.clear()}getTrackByMediaId(e){for(let t of this.streams.values())for(let[r,n]of t.getTracks())if(n.getMediaId()==e)return n;return null}getStreamByMediaId(e){for(let t of this.streams.values())for(let[r,n]of t.getTracks())if(n.getMediaId()==e)return t;return null}answer(e){const t=new cr;e.ice&&(e.ice instanceof _t?t.setICE(e.ice.clone()):t.setICE(_t.expand(e.ice))),e.dtls&&(e.dtls instanceof vt?t.setDTLS(e.dtls):t.setDTLS(vt.expand(e.dtls))),e.crypto&&(e.crypto instanceof bt?t.setCrypto(e.crypto):t.setCrypto(bt.expand(e.crypto)));for(let r=0;e.candidates&&r<e.candidates.length;++r)e.candidates[r]instanceof ut?t.addCandidate(e.candidates[r].clone()):t.addCandidate(ut.expand(e.candidates[r]));for(let r in this.medias){const n=this.medias[r],i=e&&e.capabilities&&e.capabilities[n.getType()];t.addMedia(n.answer(i))}return t}toString(){let e={version:0,media:[]};e.version=0,e.origin={username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"},e.name="semantic-sdp",e.connection={version:4,ip:"0.0.0.0"},e.timing={start:0,stop:0},this.hasICE()&&this.getICE().isLite()&&(e.icelite="ice-lite"),e.msidSemantic={semantic:"WMS",token:"*"},e.groups=[];let t={type:"BUNDLE",mids:[]};for(let r in this.medias){let n=this.medias[r],i={type:n.getType(),port:9,protocol:"",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};i.direction=Yt.toString(n.getDirection()),i.rtcpMux="rtcp-mux",i.rtcpRsize="rtcp-rsize",i.extmapAllowMixed="extmap-allow-mixed",i.mid=n.getId(),t.mids.push(n.getId()),n.hasControl()&&(i.control=n.getControl()),n.getBitrate()>0&&i.bandwidth.push({type:"AS",limit:n.getBitrate()});let s=this.getCandidates();for(let e=0;e<s.length;++e){let t=s[e];i.candidates.push({foundation:t.getFoundation(),component:t.getComponentId(),transport:t.getTransport(),priority:t.getPriority(),ip:t.getAddress(),port:t.getPort(),type:t.getType(),raddr:t.getRelAddr(),rport:t.getRelPort()})}this.getICE()&&(i.iceUfrag=this.getICE().getUfrag(),i.icePwd=this.getICE().getPwd()),this.getDTLS()?(i.protocol="UDP/TLS/RTP/SAVPF",i.fingerprint={type:this.getDTLS().getHash(),hash:this.getDTLS().getFingerprint()},i.setup=gt.toString(this.getDTLS().getSetup())):this.getCrypto()?(i.protocol="UDP/SAVPF",i.crypto=[{id:this.getCrypto().getTag(),suite:this.getCrypto().getSuite(),config:this.getCrypto().getKeyParams()}]):i.protocol="UDP/AVP";for(let e of n.getCodecs().values()){"video"===n.getType().toLowerCase()?i.rtp.push({payload:e.getType(),codec:e.getCodec().toUpperCase(),rate:9e4}):"opus"===e.getCodec().toLowerCase()||"multiopus"===e.getCodec().toLowerCase()?i.rtp.push({payload:e.getType(),codec:e.getCodec(),rate:48e3,encoding:e.getChannels()}):i.rtp.push({payload:e.getType(),codec:e.getCodec(),rate:8e3});for(const t of e.getRTCPFeedbacks())i.rtcpFb.push({payload:e.getType(),type:t.getId(),subtype:t.getParams().join(" ")});e.hasRTX()&&(i.rtp.push({payload:e.getRTX(),codec:"rtx",rate:9e4}),i.fmtp.push({payload:e.getRTX(),config:"apt="+e.getType()}));const t=e.getParams();if(Object.keys(t).length){const r={payload:e.getType(),config:""};for(const e in t)r.config.length&&(r.config+=";"),t.hasOwnProperty(e)?r.config+=e+"="+t[e]:r.config+=e;i.fmtp.push(r)}}const o=[];for(let e=0;e<i.rtp.length;++e)o.push(i.rtp[e].payload);i.payloads=o.join(" ");for(let[e,t]of n.getExtensions().entries())i.ext.push({value:e,uri:t});for(let e of n.getRIDs().values()){let t={id:e.getId(),direction:Vt.toString(e.getDirection()),params:""};e.getFormats().length&&(t.params="pt="+e.getFormats().join(","));for(let[r,n]of e.getParams().entries())t.params+=(t.params.length?";":"")+r+"="+n;i.rids.push(t)}const a=n.getSimulcast();if(a){let e=1;i.simulcast={};const t=a.getSimulcastStreams(Vt.SEND),r=a.getSimulcastStreams(Vt.RECV);if(t&&t.length){let r="";for(let e=0;e<t.length;++e){let n="";for(let r=0;r<t[e].length;++r)n+=(n.length?",":"")+(t[e][r].isPaused()?"~":"")+t[e][r].getId();r+=(r.length?";":"")+n}i.simulcast["dir"+e]="send",i.simulcast["list"+e]=r,e++}if(r&&r.length){let t=[];for(let e=0;e<r.length;++e){let n="";for(let t=0;t<r[e].length;++t)n+=(n.length?",":"")+(r[e][t].isPaused()?"~":"")+r[e][t].getId();t+=(t.length?";":"")+n}i.simulcast["dir"+e]="recv",i.simulcast["list"+e]=t,e++}}e.media.push(i)}for(let t of this.streams.values())for(let r of t.getTracks().values())for(let n in e.media){let i=e.media[n];if(r.getMediaId()){if(r.getMediaId()==i.mid){let e=r.getSourceGroups();for(let t in e){let r=e[t];i.ssrcGroups.push({semantics:r.getSemantics(),ssrcs:r.getSSRCs().join(" ")})}let n=r.getSSRCs();for(let e in n)i.ssrcs.push({id:n[e],attribute:"cname",value:t.getId()}),i.ssrcs.push({id:n[e],attribute:"msid",value:t.getId()+" "+r.getId()});i.msid=t.getId()+" "+r.getId();break}}else if(i.type.toLowerCase()===r.getMedia().toLowerCase()){let e=r.getSourceGroups();for(let t in e){let r=e[t];i.ssrcGroups.push({semantics:r.getSemantics(),ssrcs:r.getSSRCs().join(" ")})}let n=r.getSSRCs();for(let e in n)i.ssrcs.push({id:n[e],attribute:"cname",value:t.getId()}),i.ssrcs.push({id:n[e],attribute:"msid",value:t.getId()+" "+r.getId()});break}}return t.mids=t.mids.join(" "),e.groups.push(t),at.write(e)}}cr.create=function(e){const t=new cr;e.ice&&(e.ice instanceof _t?t.setICE(e.ice.clone()):t.setICE(_t.expand(e.ice))),e.dtls&&(e.dtls instanceof vt?t.setDTLS(e.dtls):t.setDTLS(vt.expand(e.dtls))),e.crypto&&(e.crypto instanceof bt?t.setCrypto(e.crypto):t.setCrypto(bt.expand(e.crypto)));for(let r=0;e.candidates&&r<e.candidates.length;++r)e.candidates[r]instanceof ut?t.addCandidate(e.candidates[r].clone()):t.addCandidate(ut.expand(e.candidates[r]));let r=96;for(let n in e.capabilities){const i=Zt.create(n,e.capabilities[n]);for(const[e,t]of i.getCodecs())t.getType()>=96&&t.setType(r++),t.getRTX()&&t.setRTX(r++);t.addMedia(i)}return t},cr.expand=function(e){const t=new cr(e.version);for(let r=0;e.medias&&r<e.medias.length;++r){const n=Zt.expand(e.medias[r]);n&&t.addMedia(n)}for(let r=0;e.streams&&r<e.streams.length;++r){const n=ar.expand(e.streams[r]);n&&t.addStream(n)}for(let r=0;e.candidates&&r<e.candidates.length;++r){const n=ut.expand(e.candidates[r]);n&&t.addCandidate(n)}return e.ice&&t.setICE(_t.expand(e.ice)),e.dtls&&t.setDTLS(vt.expand(e.dtls)),e.crypto&&t.setCrypto(vt.expand(e.crypto)),t},cr.process=function(e){return cr.parse(e)},cr.parse=function(e){const t=at.parse(e),r=new cr;r.setVersion(t.version);for(let e in t.media){const n=t.media[e],i=n.type,s=n.mid?n.mid.toString():e,o=new Zt(s,i);if(n.iceUfrag&&n.icePwd){const e=String(n.iceUfrag),t=String(n.icePwd);r.setICE(new _t(e,t))}for(let e=0;n.candidates&&e<n.candidates.length;++e){const t=n.candidates[e],i=new ut(t.foundation,t.component,t.transport,t.priority,t.ip,t.port,t.type,t.raddr,t.rport);r.addCandidate(i)}const a=n.fingerprint||t.fingerprint;if(a){const e=a.type,t=a.hash;let i=gt.ACTPASS;n.setup&&(i=gt.byValue(n.setup)),r.setDTLS(new vt(i,e,t))}if(n.crypto){const e=n.crypto[0];r.setCrypto(new bt(e.id,e.suite,e.config,e.sessionConfig))}let c=Yt.SENDRECV;n.direction&&(c=Yt.byValue(n.direction),o.setDirection(c)),n.control&&o.setControl(n.control);const u=new Map;for(let e in n.rtp){const t=n.rtp[e],r=t.payload,i=t.codec;if("RED"===i.toUpperCase()||"ULPFEC"===i.toUpperCase())continue;let s={};for(let e in n.fmtp){const t=n.fmtp[e];if(t.payload===r){const e=t.config.split(";");for(let t in e){const r=e[t].split("="),n=r[0].trim(),i=r.splice(1).join("=").trim();s[n]=i}}}if("RTX"===i.toUpperCase())u.set(parseInt(s.apt),r);else{const e=new pt(i,r,s);t.encoding>1&&e.setChannels(t.encoding),o.addCodec(e)}}for(let e of u.entries()){const t=o.getCodecForType(e[0]);t&&t.setRTX(e[1])}for(let e=0;n.rtcpFb&&e<n.rtcpFb.length;++e){const t=o.getCodecForType(n.rtcpFb[e].payload);if(t){const r=n.rtcpFb[e].type,i=n.rtcpFb[e].subtype?n.rtcpFb[e].subtype.split(" "):null;t.addRTCPFeedback(new ft(r,i))}}const l=n.ext;for(let e in l){const t=l[e];o.addExtension(t.value,t.uri)}const f=n.rids;for(let e in f){const t=f[e],r=new Gt(t.id,Vt.byValue(t.direction));let n=[];const i=new Map;if(t.params){const e=at.parseParams(t.params);for(let t in e)"pt"===t?n=e[t].split(","):i.set(t,e[t]);r.setFormats(n),r.setParams(i)}o.addRID(r)}const d=[];if(n.simulcast){const e=new Xt;if(n.simulcast.dir1){const t=Vt.byValue(n.simulcast.dir1),r=at.parseSimulcastStreamList(n.simulcast.list1);for(let n=0;n<r.length;++n){const i=[];for(let e=0;e<r[n].length;++e)i.push(new $t(r[n][e].scid,r[n][e].paused));e.addSimulcastAlternativeStreams(t,i)}}if(n.simulcast.dir2){const t=Vt.byValue(n.simulcast.dir2),r=at.parseSimulcastStreamList(n.simulcast.list2);for(let n=0;n<r.length;++n){const i=[];for(let e=0;e<r[n].length;++e)i.push(new $t(r[n][e].scid,r[n][e].paused));e.addSimulcastAlternativeStreams(t,i)}}for(let t of e.getSimulcastStreams(Vt.SEND)){const e=[];for(let r=0;r<t.length;r++){const n=new nr(t[r].getId(),t[r].isPaused()),i=o.getRID(n.getId());if(i){const t=i.getFormats();for(let e=0;t&&e<t.length;++e){const r=o.getCodecForType(t[e]);r&&n.addCodec(r)}n.setParams(i.getParams()),e.push(n)}}e.length&&d.push(e)}o.setSimulcast(e)}const p=new Map;if(n.ssrcs)for(let e in n.ssrcs){let t=n.ssrcs[e],o=t.id,a=t.attribute,c=t.value,u=p.get(o);if(u||(u=new tr(o),p.set(u.getSSRC(),u)),"cname"===a.toLowerCase())u.setCName(c);else if("msid"===a.toLowerCase()){let e=c.split(" "),t=e[0],n=e[1];u.setStreamId(t),u.setTrackId(n);let a=r.getStream(t);a||(a=new ar(t),r.addStream(a));let l=a.getTrack(n);l||(l=new sr(i,n),l.setMediaId(s),l.setEncodings(d),a.addTrack(l)),l.addSSRC(o)}}if(n.msid){let e=n.msid.split(" "),t=e[0],o=e[1],a=r.getStream(t);a||(a=new ar(t),r.addStream(a));let c=a.getTrack(o);c||(c=new sr(i,o),c.setMediaId(s),c.setEncodings(d),a.addTrack(c));for(let[e,r]of p.entries())r.getStreamId()||(r.setStreamId(t),r.setTrackId(o),c.addSSRC(e))}for(let[e,t]of p.entries())if(!t.getStreamId()){let n=t.getCName(),o=s;t.setStreamId(n),t.setTrackId(o);let a=r.getStream(n);a||(a=new ar(n),r.addStream(a));let c=a.getTrack(o);c||(c=new sr(i,o),c.setMediaId(s),c.setEncodings(d),a.addTrack(c)),c.addSSRC(e)}if(n.ssrcGroups)for(let e in n.ssrcGroups){let t=n.ssrcGroups[e],i=t.ssrcs.split(" "),s=new Qt(t.semantics,i),o=p.get(parseInt(i[0]));r.getStream(o.getStreamId()).getTrack(o.getTrackId()).addSourceGroup(s)}r.addMedia(o)}return r};var ur={SDPInfo:cr,CandidateInfo:ut,CodecInfo:pt,DTLSInfo:vt,CryptoInfo:bt,ICEInfo:_t,MediaInfo:Zt,Setup:gt,SourceGroupInfo:Qt,SourceInfo:tr,StreamInfo:ar,TrackInfo:sr,TrackEncodingInfo:nr,Direction:Yt},lr=i((function(e,t){!function(r,n){var i="function",s="object",o="string",a="model",c="name",u="type",l="vendor",f="version",d="architecture",p="console",h="mobile",m="tablet",g="smarttv",y="wearable",v="embedded",w={extend:function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r},has:function(e,t){return typeof e===o&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===o?e.replace(/[^\d\.]/g,"").split(".")[0]:n},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===t?e:e.substring(0,255)}},b={rgx:function(e,t){for(var r,o,a,c,u,l,f=0;f<t.length&&!u;){var d=t[f],p=t[f+1];for(r=o=0;r<d.length&&!u;)if(u=d[r++].exec(e))for(a=0;a<p.length;a++)l=u[++o],typeof(c=p[a])===s&&c.length>0?2==c.length?typeof c[1]==i?this[c[0]]=c[1].call(this,l):this[c[0]]=c[1]:3==c.length?typeof c[1]!==i||c[1].exec&&c[1].test?this[c[0]]=l?l.replace(c[1],c[2]):n:this[c[0]]=l?c[1].call(this,l,c[2]):n:4==c.length&&(this[c[0]]=l?c[3].call(this,l.replace(c[1],c[2])):n):this[c]=l||n;f+=2}},str:function(e,t){for(var r in t)if(typeof t[r]===s&&t[r].length>0){for(var i=0;i<t[r].length;i++)if(w.has(t[r][i],e))return"?"===r?n:r}else if(w.has(t[r],e))return"?"===r?n:r;return e}},S={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},C={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[f,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[f,[c,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[c,f],[/opios[\/\s]+([\w\.]+)/i],[f,[c,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[f,[c,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,f],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[f,[c,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[f,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[f,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[f,[c,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[f,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[f,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],f],[/focus\/([\w\.]+)/i],[f,[c,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[f,[c,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[f,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[f,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[f,[c,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[f,[c,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[f,[c,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],f],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[c,f],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[c],[/;fbav\/([\w\.]+);/i],[f,[c,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[c,f],[/\bgsa\/([\w\.]+)\s.*safari\//i],[f,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[f,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],f],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[f,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,f],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[f,[c,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[f,c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[f,b.str,S.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,f],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],f],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[f,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[d,"amd64"]],[/(ia32(?=;))/i],[[d,w.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[d,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[d,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[d,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[d,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[d,/ower/,"",w.lowerize]],[/(sun4\w)[;\)]/i],[[d,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[d,w.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[a,[l,"Samsung"],[u,m]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[a,[l,"Samsung"],[u,h]],[/\((ip(?:hone|od)[\s\w]*);/i],[a,[l,"Apple"],[u,h]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[l,"Apple"],[u,m]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[a,[l,"Huawei"],[u,m]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[a,[l,"Huawei"],[u,h]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[a,/_/g," "],[l,"Xiaomi"],[u,h]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[a,/_/g," "],[l,"Xiaomi"],[u,m]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[a,[l,"OPPO"],[u,h]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[a,[l,"Vivo"],[u,h]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[a,[l,"Realme"],[u,h]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[a,[l,"Motorola"],[u,h]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[l,"Motorola"],[u,m]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[a,[l,"LG"],[u,m]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[a,[l,"LG"],[u,h]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[a,[l,"Lenovo"],[u,m]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[a,/_/g," "],[l,"Nokia"],[u,h]],[/droid.+;\s(pixel\sc)[\s)]/i],[a,[l,"Google"],[u,m]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[a,[l,"Google"],[u,h]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[l,"Sony"],[u,h]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[a,"Xperia Tablet"],[l,"Sony"],[u,m]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[a,[l,"OnePlus"],[u,h]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[a,[l,"Amazon"],[u,m]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[a,"Fire Phone"],[l,"Amazon"],[u,h]],[/\((playbook);[\w\s\),;-]+(rim)/i],[a,l,[u,m]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[a,[l,"BlackBerry"],[u,h]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[a,[l,"ASUS"],[u,m]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[a,[l,"ASUS"],[u,h]],[/(nexus\s9)/i],[a,[l,"HTC"],[u,m]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[a,/_/g," "],[u,h]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[a,[l,"Acer"],[u,m]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[a,[l,"Meizu"],[u,h]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,a,[u,h]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[l,a,[u,m]],[/\s(surface\sduo)\s/i],[a,[l,"Microsoft"],[u,m]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[a,[l,"Fairphone"],[u,h]],[/\s(u304aa)\sbuild/i],[a,[l,"AT&T"],[u,h]],[/sie-(\w*)/i],[a,[l,"Siemens"],[u,h]],[/[;\/]\s?(rct\w+)\sbuild/i],[a,[l,"RCA"],[u,m]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[a,[l,"Dell"],[u,m]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[a,[l,"Verizon"],[u,m]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[a,[l,"Barnes & Noble"],[u,m]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[a,[l,"NuVision"],[u,m]],[/;\s(k88)\sbuild/i],[a,[l,"ZTE"],[u,m]],[/;\s(nx\d{3}j)\sbuild/i],[a,[l,"ZTE"],[u,h]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[a,[l,"Swiss"],[u,h]],[/[;\/]\s?(zur\d{3})\sbuild/i],[a,[l,"Swiss"],[u,m]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[a,[l,"Zeki"],[u,m]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[l,"Dragon Touch"],a,[u,m]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[a,[l,"Insignia"],[u,m]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[a,[l,"NextBook"],[u,m]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[l,"Voice"],a,[u,h]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[l,"LvTel"],a,[u,h]],[/;\s(ph-1)\s/i],[a,[l,"Essential"],[u,h]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[a,[l,"Envizen"],[u,m]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[a,[l,"MachSpeed"],[u,m]],[/[;\/]\s?tu_(1491)\sbuild/i],[a,[l,"Rotor"],[u,m]],[/(shield[\w\s]+)\sbuild/i],[a,[l,"Nvidia"],[u,m]],[/(sprint)\s(\w+)/i],[l,a,[u,h]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[l,"Microsoft"],[u,h]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[l,"Zebra"],[u,m]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[l,"Zebra"],[u,h]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[l,a,[u,p]],[/droid.+;\s(shield)\sbuild/i],[a,[l,"Nvidia"],[u,p]],[/(playstation\s[345portablevi]+)/i],[a,[l,"Sony"],[u,p]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[a,[l,"Microsoft"],[u,p]],[/smart-tv.+(samsung)/i],[l,[u,g]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[l,"Samsung"],[u,g]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[l,"LG"],[u,g]],[/(apple)\s?tv/i],[l,[a,"Apple TV"],[u,g]],[/crkey/i],[[a,"Chromecast"],[l,"Google"],[u,g]],[/droid.+aft([\w])(\sbuild\/|\))/i],[a,[l,"Amazon"],[u,g]],[/\(dtv[\);].+(aquos)/i],[a,[l,"Sharp"],[u,g]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,w.trim],[a,w.trim],[u,g]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[u,g]],[/((pebble))app\/[\d\.]+\s/i],[l,a,[u,y]],[/droid.+;\s(glass)\s\d/i],[a,[l,"Google"],[u,y]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[a,[l,"Zebra"],[u,y]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[l,[u,v]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[a,[u,h]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[a,[u,m]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,w.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[a,[l,"Generic"]],[/(phone)/i],[[u,h]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[f,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[f,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,f],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[f,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,f],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[c,[f,b.str,S.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[f,b.str,S.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[f,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[c,"Mac OS"],[f,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[c,f],[/\(bb(10);/i],[f,[c,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[f,[c,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[f,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[f,[c,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],f],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[c,f],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],f],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,f]]},E=function(e,t){if("object"==typeof e&&(t=e,e=n),!(this instanceof E))return new E(e,t).getResult();var i=e||(void 0!==r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),s=t?w.extend(C,t):C;return this.getBrowser=function(){var e={name:n,version:n};return b.rgx.call(e,i,s.browser),e.major=w.major(e.version),e},this.getCPU=function(){var e={architecture:n};return b.rgx.call(e,i,s.cpu),e},this.getDevice=function(){var e={vendor:n,model:n,type:n};return b.rgx.call(e,i,s.device),e},this.getEngine=function(){var e={name:n,version:n};return b.rgx.call(e,i,s.engine),e},this.getOS=function(){var e={name:n,version:n};return b.rgx.call(e,i,s.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=typeof e===o&&e.length>255?w.trim(e,255):e,this},this.setUA(i),this};E.VERSION="0.7.28",E.BROWSER={NAME:c,MAJOR:"major",VERSION:f},E.CPU={ARCHITECTURE:d},E.DEVICE={MODEL:a,VENDOR:l,TYPE:u,CONSOLE:p,MOBILE:h,SMARTTV:g,TABLET:m,WEARABLE:y,EMBEDDED:v},E.ENGINE={NAME:c,VERSION:f},E.OS={NAME:c,VERSION:f},e.exports&&(t=e.exports=E),t.UAParser=E;var k=void 0!==r&&(r.jQuery||r.Zepto);if(k&&!k.ua){var x=new E;k.ua=x.getResult(),k.ua.get=function(){return x.getUA()},k.ua.set=function(e){x.setUA(e);var t=x.getResult();for(var r in t)k.ua[r]=t[r]}}}("object"==typeof window?window:n)}));function fr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}var dr=["iOS"],pr=function(e){R(r,e);var t=fr(r);function r(){return E(this,r),t.call(this,window.navigator.userAgent)}return x(r,[{key:"isChrome",value:function(){var e,t=this.getBrowser(),r=this.getOS();return e=!new RegExp(dr.join("|"),"i").test(r.name),t.name.match(/Chrome/i)&&e}},{key:"isFirefox",value:function(){return this.getBrowser().name.match(/Firefox/i)}}]),r}(lr);function hr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return mr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gr=v.get("SdpParser"),yr=Array.from({length:31},(function(e,t){return t+35})),vr=Array.from({length:32},(function(e,t){return t+96})),wr=function(){function e(){E(this,e)}return x(e,null,[{key:"setSimulcast",value:function(e,t){if(gr.info("Setting simulcast. Codec: ",t),!(new pr).isChrome())return gr.warn("Simulcast is only available in Google Chrome browser"),e;if("h264"!==t&&"vp8"!==t)return gr.warn("Simulcast is only available in h264 and vp8 codecs"),e;try{for(var r=/m=video[\s\S]*?a=ssrc:([0-9]*) cname:([\s\S]+?)\r\n/.exec(e),n=r[1],i=r[2],s=/m=video[\s\S]*?a=ssrc:([0-9]*) mslabel:([\s\S]+?)\r\n/.exec(e)[2],o=/m=video[\s\S]*?a=ssrc:([0-9]*) msid:([\s\S]+?)\r\n/.exec(e)[2],a=/m=video[\s\S]*?a=ssrc:([0-9]*) label:([\s\S]+?)\r\n/.exec(e)[2],c=[n],u=0;u<2;++u){var l=100+2*u,f=l+1;c.push(l),e+="a=ssrc-group:FID "+l+" "+f+"\r\na=ssrc:"+l+" cname:"+i+"\r\na=ssrc:"+l+" msid:"+o+"\r\na=ssrc:"+l+" mslabel:"+s+"\r\na=ssrc:"+l+" label:"+a+"\r\na=ssrc:"+f+" cname:"+i+"\r\na=ssrc:"+f+" msid:"+o+"\r\na=ssrc:"+f+" mslabel:"+s+"\r\na=ssrc:"+f+" label:"+a+"\r\n"}return e+="a=x-google-flag:conference\r\n",e+="a=ssrc-group:SIM "+c.join(" ")+"\r\n",gr.info("Simulcast setted"),gr.debug("Simulcast SDP: ",e),e}catch(e){throw gr.error("Error setting SDP for simulcast: ",e),e}}},{key:"setStereo",value:function(e){return gr.info("Replacing SDP response for support stereo"),e=e.replace(/useinbandfec=1/g,"useinbandfec=1; stereo=1"),gr.info("Replaced SDP response for support stereo"),gr.debug("New SDP value: ",e),e}},{key:"setDTX",value:function(e){return gr.info("Replacing SDP response for support dtx"),e=e.replace("useinbandfec=1","useinbandfec=1; usedtx=1"),gr.info("Replaced SDP response for support dtx"),gr.debug("New SDP value: ",e),e}},{key:"setVideoBitrate",value:function(e,t){if(t<1)gr.info("Remove bitrate restrictions"),e=e.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"");else{var r=new pr,n=ur.SDPInfo.parse(e),i=n.getMedia("video");gr.info("Setting video bitrate"),i.setBitrate(t),(e=n.toString()).indexOf("b=AS:")>-1&&r.isFirefox()&&(gr.info("Updating SDP for firefox browser"),e=e.replace("b=AS:","b=TIAS:"),gr.debug("SDP updated for firefox: ",e))}return e}},{key:"removeSdpLine",value:function(e,t){return gr.debug("SDP before trimming: ",e),e=e.split("\n").filter((function(e){return e.trim()!==t})).join("\n"),gr.debug("SDP trimmed result: ",e),e}},{key:"adaptCodecName",value:function(e,t,r){if(!e)return e;var n=new RegExp("".concat(t),"i");return e.replace(n,r)}},{key:"setMultiopus",value:function(t,r){if((new pr).isChrome()&&(!r||br(r)))if(t.includes("multiopus/48000/6"))gr.info("Multiopus already setted");else{gr.info("Setting multiopus");var n=/m=audio 9 UDP\/TLS\/RTP\/SAVPF (.*)\r\n/.exec(t)[0],i=e.getAvailablePayloadTypeRange(t)[0],s=n.replace("\r\n"," ")+i+"\r\na=rtpmap:"+i+" multiopus/48000/6\r\na=fmtp:"+i+" channel_mapping=0,4,1,2,3,5;coupled_streams=2;minptime=10;num_streams=4;useinbandfec=1\r\n";t=t.replace(n,s),gr.info("Multiopus offer created"),gr.debug("SDP parsed for multioups: ",t)}return t}},{key:"getAvailablePayloadTypeRange",value:function(e){var t,r=e.matchAll(/m=(?:.*) (?:.*) UDP\/TLS\/RTP\/SAVPF (.*)\r\n/gm),n=vr.concat(yr),i=hr(r);try{var s=function(){var e=t.value[1].split(" ").map((function(e){return parseInt(e)}));n=n.filter((function(t){return!e.includes(t)}))};for(i.s();!(t=i.n()).done;)s()}catch(e){i.e(e)}finally{i.f()}return n}}]),e}(),br=function(e){return e.getAudioTracks().some((function(e){return e.getSettings().channelCount>2}))};class Sr extends Ce{constructor(e,t){super(),this.namespace=e,this.tm=t}cmd(e,t){return this.tm.cmd(e,t,this.namespace)}event(e,t){return this.tm.event(e,t,this.namespace)}close(){return this.tm.namespaces.delete(this.namespace)}}var Cr=class extends Ce{constructor(e){super(),this.maxId=0,this.namespaces=new Map,this.transactions=new Map,this.transport=e,this.listener=t=>{let r;try{r=JSON.parse(t.utf8Data||t.data)}catch(e){return}switch(r.type){case"cmd":const t={name:r.name,data:r.data,namespace:r.namespace,accept:t=>{e.send(JSON.stringify({type:"response",transId:r.transId,data:t}))},reject:t=>{e.send(JSON.stringify({type:"error",transId:r.transId,data:t}))}};if(t.namespace){const e=this.namespaces.get(t.namespace);e?e.emit("cmd",t):this.emit("cmd",t)}else this.emit("cmd",t);break;case"response":{const e=this.transactions.get(r.transId);if(!e)return;this.transactions.delete(r.transId),e.resolve(r.data);break}case"error":{const e=this.transactions.get(r.transId);if(!e)return;this.transactions.delete(r.transId),e.reject(r.data);break}case"event":const i={name:r.name,data:r.data,namespace:r.namespace};if(i.namespace){var n=this.namespaces.get(i.namespace);n?n.emit("event",i):this.emit("event",i)}else this.emit("event",i)}},this.transport.addListener?this.transport.addListener("message",this.listener):this.transport.addEventListener("message",this.listener)}cmd(e,t,r){return new Promise(((n,i)=>{if(!e||0===e.length)throw new Error("Bad command name");const s={type:"cmd",transId:this.maxId++,name:e,data:t};r&&(s.namespace=r);const o=JSON.stringify(s);s.resolve=n,s.reject=i,this.transactions.set(s.transId,s);try{this.transport.send(o)}catch(e){throw this.transactions.delete(s.transId),e}}))}event(e,t,r){if(!e||0===e.length)throw new Error("Bad event name");const n={type:"event",name:e,data:t};r&&(n.namespace=r);const i=JSON.stringify(n);this.transport.send(i)}namespace(e){let t=this.namespaces.get(e);return t||(t=new Sr(e,this),this.namespaces.set(e,t),t)}close(){for(const e of this.namespaces.values())e.close();this.transport.removeListener?this.transport.removeListener("message",this.listener):this.transport.removeEventListener("message",this.listener)}};function Er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}var kr=v.get("Signaling"),xr="wsConnectionSuccess",Tr="wsConnectionError",Rr="wsConnectionClose",Ir="broadcastEvent",Pr={VP8:"vp8",VP9:"vp9",H264:"h264",AV1:"av1"},Ar={OPUS:"opus",MULTIOPUS:"multiopus"},Or=function(e){R(s,e);var t,r,n,i=Er(s);function s(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{streamName:null,url:"ws://localhost:8080/"};return E(this,s),(e=i.call(this)).streamName=t.streamName,e.wsUrl=t.url,e.webSocket=null,e.transactionManager=null,e}return x(s,[{key:"connect",value:(n=C(A.mark((function e(){var t,r=this;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(kr.info("Connecting to Signaling Server"),!this.transactionManager||(null===(t=this.webSocket)||void 0===t?void 0:t.readyState)!==WebSocket.OPEN){e.next=6;break}return kr.info("Connected to server: ",this.webSocket.url),kr.debug("WebSocket value: ",{url:this.webSocket.url,protocol:this.webSocket.protocol,readyState:this.webSocket.readyState,binaryType:this.webSocket.binaryType,extensions:this.webSocket.extensions}),this.emit(xr,{ws:this.webSocket,tm:this.transactionManager}),e.abrupt("return",this.webSocket);case 6:return e.abrupt("return",new Promise((function(e,t){r.webSocket=new WebSocket(r.wsUrl),r.transactionManager=new Cr(r.webSocket),r.webSocket.onopen=function(){kr.info("WebSocket opened"),r.transactionManager.on("event",(function(e){r.emit(Ir,e)})),kr.info("Connected to server: ",r.webSocket.url),kr.debug("WebSocket value: ",{url:r.webSocket.url,protocol:r.webSocket.protocol,readyState:r.webSocket.readyState,binaryType:r.webSocket.binaryType,extensions:r.webSocket.extensions}),r.emit(xr,{ws:r.webSocket,tm:r.transactionManager}),e(r.webSocket)},r.webSocket.onerror=function(){kr.error("WebSocket not connected: ",r.webSocket.url),r.emit(Tr,r.webSocket.url),t(r.webSocket.url)},r.webSocket.onclose=function(){r.webSocket=null,r.transactionManager=null,kr.info("Connection closed with Signaling Server."),r.emit(Rr)}})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"close",value:function(){var e;kr.info("Closing connection with Signaling Server."),null===(e=this.webSocket)||void 0===e||e.close()}},{key:"subscribe",value:(r=C(A.mark((function e(t){var r,n,i,s,o,a=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:0,n=a.length>2&&void 0!==a[2]?a[2]:null,i=a.length>3&&void 0!==a[3]?a[3]:null,kr.info("Starting subscription to streamName: ",this.streamName),kr.debug("Subcription local description: ",t),t=wr.adaptCodecName(t,"AV1X",Pr.AV1),s={sdp:t,streamId:this.streamName,pinnedSourceId:n,excludedSourceIds:i},r&&(s.vad=!0),e.prev=8,e.next=11,this.connect();case 11:return kr.info("Sending view command"),e.next=14,this.transactionManager.cmd("view",s);case 14:return(o=e.sent).sdp=wr.adaptCodecName(o.sdp,Pr.AV1,"AV1X"),kr.info("Command sent, subscriberId: ",o.subscriberId),kr.debug("Command result: ",o),e.abrupt("return",o.sdp);case 21:throw e.prev=21,e.t0=e.catch(8),kr.error("Error sending view command, error: ",e.t0),e.t0;case 25:case"end":return e.stop()}}),e,this,[[8,21]])}))),function(e){return r.apply(this,arguments)})},{key:"publish",value:(t=C(A.mark((function e(t){var r,n,i,s,o,a,c,u=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>1&&void 0!==u[1]?u[1]:Pr.H264,n=u.length>2&&void 0!==u[2]?u[2]:null,i=u.length>3&&void 0!==u[3]?u[3]:null,kr.info("Starting publishing to streamName: ".concat(this.streamName,", codec: ").concat(r)),kr.debug("Publishing local description: ",t),-1!==(s=Object.values(Pr)).indexOf(r)){e.next=9;break}throw kr.error("Invalid codec. Possible values are: ",s),new Error("Invalid codec. Possible values are: ".concat(s));case 9:return r===Pr.AV1&&(t=wr.adaptCodecName(t,"AV1X",Pr.AV1)),o={name:this.streamName,sdp:t,codec:r,sourceId:i},null!==n&&(o.record=n),e.prev=12,e.next=15,this.connect();case 15:return kr.info("Sending publish command"),e.next=18,this.transactionManager.cmd("publish",o);case 18:return c=e.sent,r===Pr.AV1&&(c.sdp=wr.adaptCodecName(c.sdp,Pr.AV1,"AV1X")),-1!==(null===(a=c.sdp)||void 0===a?void 0:a.indexOf("\na=extmap-allow-mixed"))&&(c.sdp=wr.removeSdpLine(c.sdp,"a=extmap-allow-mixed")),kr.info("Command sent, publisherId: ",c.publisherId),kr.debug("Command result: ",c),e.abrupt("return",c.sdp);case 26:throw e.prev=26,e.t0=e.catch(12),kr.error("Error sending publish command, error: ",e.t0),e.t0;case 30:case"end":return e.stop()}}),e,this,[[12,26]])}))),function(e){return t.apply(this,arguments)})}]),s}(Ce);function Lr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Br(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?Lr(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Dr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function Dr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function jr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}var Mr,Ur=v.get("PeerConnection"),_r={track:"track",connectionStateChange:"connectionStateChange"},Fr="https://turn1.wowza.com/webrtc/_turn",Vr={stereo:!1,mediaStream:null,codec:"h264",simulcast:!1,scalabilityMode:null,disableAudio:!1,disableVideo:!1,setSDPToPeer:!0},zr=function(e){R(u,e);var t,r,n,i,s,o,a,c=jr(u);function u(){var e;return E(this,u),(e=c.call(this)).sessionDescription=null,e.peer=null,e.peerConnectionStats=null,e}return x(u,[{key:"createRTCPeer",value:(a=C(A.mark((function e(){var t,r=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:null,Ur.info("Creating new RTCPeerConnection"),Ur.debug("RTC configuration provided by user: ",t),e.next=5,this.getRTCConfiguration(t);case 5:t=e.sent,this.peer=$r(this,t);case 7:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"getRTCPeer",value:function(){if(Ur.info("Getting RTC Peer"),this.peer){var e=Yr(this.peer),t=this.peer,r=t.currentLocalDescription,n=t.currentRemoteDescription;Ur.debug("getRTCPeer return: ",{connectionState:e,currentLocalDescription:r,currentRemoteDescription:n})}return this.peer}},{key:"closeRTCPeer",value:(o=C(A.mark((function e(){var t;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ur.info("Closing RTCPeerConnection"),null===(t=this.peer)||void 0===t||t.close(),this.peer=null,this.stopStats(),this.emit(_r.connectionStateChange,"closed");case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"getRTCConfiguration",value:(s=C(A.mark((function e(t){var r,n;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ur.info("Getting RTC configuration"),null===(r=(n=null!=t?t:{}).iceServers)||void 0===r){e.next=6;break}e.t0=r,e.next=9;break;case 6:return e.next=8,this.getRTCIceServers();case 8:e.t0=e.sent;case 9:return n.iceServers=e.t0,e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"getRTCIceServers",value:(i=C(A.mark((function e(t){var r,n,i,s,o,a,c,u;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=null!==(r=t)&&void 0!==r?r:Fr,Ur.info("Getting RTC ICE servers"),Ur.debug("RTC ICE servers request location: ",t),n=[],e.prev=4,e.next=7,ye.put(t);case 7:if(i=e.sent,s=i.data,Ur.debug("RTC ICE servers response: ",s),"ok"===s.s){o=Nr(s.v.iceServers);try{for(o.s();!(a=o.n()).done;)c=a.value,(u=c.url)&&(c.urls=u,delete c.url),n.push(c)}catch(e){o.e(e)}finally{o.f()}Ur.info("RTC ICE servers successfully obtained.")}e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),Ur.error("Error while getting RTC ICE servers: ",e.t0.response.data);case 16:return e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,null,[[4,13]])}))),function(e){return i.apply(this,arguments)})},{key:"setRTCRemoteSDP",value:(n=C(A.mark((function e(t){var r;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ur.info("Setting RTC Remote SDP"),r={type:"answer",sdp:t},e.prev=2,e.next=5,this.peer.setRemoteDescription(r);case 5:Ur.info("RTC Remote SDP was set successfully."),Ur.debug("RTC Remote SDP new value: ",t),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(2),Ur.error("Error while setting RTC Remote SDP: ",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[2,9]])}))),function(e){return n.apply(this,arguments)})},{key:"getRTCLocalSDP",value:(r=C(A.mark((function e(){var t,r,n,i=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:Vr,Ur.info("Getting RTC Local SDP"),t=Br(Br({},Vr),t),Ur.debug("Options: ",t),(r=qr(t.mediaStream))?Xr(this.peer,r,t):Wr(this.peer,t),Ur.info("Creating peer offer"),e.next=9,this.peer.createOffer();case 9:if(n=e.sent,Ur.info("Peer offer created"),Ur.debug("Peer offer response: ",n.sdp),this.sessionDescription=n,t.disableAudio||(t.stereo&&(this.sessionDescription.sdp=wr.setStereo(this.sessionDescription.sdp)),t.dtx&&(this.sessionDescription.sdp=wr.setDTX(this.sessionDescription.sdp)),this.sessionDescription.sdp=wr.setMultiopus(this.sessionDescription.sdp,r)),!t.disableVideo&&t.simulcast&&(this.sessionDescription.sdp=wr.setSimulcast(this.sessionDescription.sdp,t.codec)),!t.setSDPToPeer){e.next=19;break}return e.next=18,this.peer.setLocalDescription(this.sessionDescription);case 18:Ur.info("Peer local description set");case 19:return e.abrupt("return",this.sessionDescription.sdp);case 20:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"updateBandwidthRestriction",value:function(e,t){return Ur.info("Updating bandwidth restriction, bitrate value: ",t),Ur.debug("SDP value: ",e),wr.setVideoBitrate(e,t)}},{key:"updateBitrate",value:(t=C(A.mark((function e(){var t,r,n=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.length>0&&void 0!==n[0]?n[0]:0,this.peer){e.next=4;break}throw Ur.error("Cannot update bitrate. No peer found."),new Error("Cannot update bitrate. No peer found.");case 4:return Ur.info("Updating bitrate to value: ",t),e.next=7,this.peer.createOffer();case 7:return this.sessionDescription=e.sent,e.next=10,this.peer.setLocalDescription(this.sessionDescription);case 10:return r=this.updateBandwidthRestriction(this.peer.remoteDescription.sdp,t),e.next=13,this.setRTCRemoteSDP(r);case 13:Ur.info("Bitrate restirctions updated: ","".concat(t>0?t:"unlimited"," kbps"));case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getRTCPeerStatus",value:function(){if(Ur.info("Getting RTC peer status"),!this.peer)return null;var e=Yr(this.peer);return Ur.info("RTC peer status getted, value: ",e),e}},{key:"replaceTrack",value:function(e){if(this.peer){var t=this.peer.getSenders().find((function(t){return t.track.kind===e.kind}));t?t.replaceTrack(e):Ur.error("There is no ".concat(e.kind," track in active broadcast."))}else Ur.error("Could not change track if there is not an active connection.")}},{key:"getTracks",value:function(){var e,t;return null===(e=this.peer)||void 0===e||null===(t=e.getSenders())||void 0===t?void 0:t.map((function(e){return e.track}))}},{key:"initStats",value:function(){this.peerConnectionStats?Ur.warn("Cannot init peer stats: Already initialized"):this.peer?(this.peerConnectionStats=new $e(this.peer),this.peerConnectionStats.init(),Ne(this.peerConnectionStats,this,[qe])):Ur.warn("Cannot init peer stats: RTCPeerConnection not initialized")}},{key:"stopStats",value:function(){var e;null===(e=this.peerConnectionStats)||void 0===e||e.stop(),this.peerConnectionStats=null}}],[{key:"setTurnServerLocation",value:function(e){Fr=e}},{key:"getTurnServerLocation",value:function(){return Fr}},{key:"getCapabilities",value:function(e){var t=new pr;if(t.isFirefox())return function(e){return"video"===e?{codecs:[{codec:"vp8",mimeType:"video/VP8"},{codec:"vp9",mimeType:"video/VP9"},{codec:"h264",mimeType:"video/H264"}],headerExtensions:[]}:"audio"===e?{codecs:[{codec:"opus",mimeType:"audio/opus",channels:2}],headerExtensions:[]}:null}(e);var r=RTCRtpSender.getCapabilities(e);if(r){var n={},i=new RegExp("^video/(".concat(Object.values(Pr).join("|"),")x?$"),"i");"audio"===e&&(i=new RegExp("^audio/(".concat(Object.values(Ar).join("|"),")$"),"i"),t.isChrome()&&(n.multiopus={mimeType:"audio/multiopus",channels:6}));var s,o=Nr(r.codecs);try{for(o.s();!(s=o.n()).done;){var a=s.value,c=a.mimeType.match(i);if(c){var u=c[1].toLowerCase();if(n[u]=Br(Br({},n[u]),{},{mimeType:a.mimeType}),a.scalabilityModes){var l=n[u].scalabilityModes||[];l=[].concat(b(l),b(a.scalabilityModes)),n[u].scalabilityModes=b(new Set(l))}a.channels&&(n[u].channels=a.channels)}}}catch(e){o.e(e)}finally{o.f()}r.codecs=Object.keys(n).map((function(e){return Br({codec:e},n[e])}))}return r}}]),u}(Ce),Gr=function(e){return(null==e?void 0:e.getAudioTracks().length)<=1&&(null==e?void 0:e.getVideoTracks().length)<=1},qr=function(e){if(!e)return null;if(e instanceof MediaStream&&Gr(e))return e;if(!(e instanceof MediaStream)){Ur.info("Creating MediaStream to add received tracks.");var t,r=new MediaStream,n=Nr(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.addTrack(i)}}catch(e){n.e(e)}finally{n.f()}if(Gr(r))return r}throw Ur.error("MediaStream must have 1 audio track and 1 video track, or at least one of them."),new Error("MediaStream must have 1 audio track and 1 video track, or at least one of them.")},$r=function(e,t){var r=new RTCPeerConnection(t);return Hr(e,r),r},Hr=function(e,t){t.ontrack=function(t){Ur.info("New track from peer."),Ur.debug("Track event value: ",t),e.emit(_r.track,t)},t.connectionState?t.onconnectionstatechange=function(r){Ur.info("Peer connection state change: ",t.connectionState),e.emit(_r.connectionStateChange,t.connectionState)}:t.oniceconnectionstatechange=function(r){Ur.info("Peer ICE connection state change: ",t.iceConnectionState),e.emit(_r.connectionStateChange,t.iceConnectionState)}},Xr=function(e,t,r){Ur.info("Adding mediaStream tracks to RTCPeerConnection");var n,i=Nr(t.getTracks());try{for(i.s();!(n=i.n()).done;){var s=n.value,o={streams:[t]};"audio"===s.kind&&(o.direction=r.disableAudio?"inactive":"sendonly"),"video"===s.kind&&(o.direction=r.disableVideo?"inactive":"sendonly",r.scalabilityMode&&(new pr).isChrome()?(Ur.debug("Video track with scalability mode: ".concat(r.scalabilityMode,".")),o.sendEncodings=[{scalabilityMode:r.scalabilityMode}]):r.scalabilityMode&&Ur.warn("SVC is only supported in Google Chrome")),e.addTransceiver(s,o),Ur.info("Track '".concat(s.label,"' added: "),"id: ".concat(s.id),"kind: ".concat(s.kind))}}catch(e){i.e(e)}finally{i.f()}},Wr=function(e,t){t.disableVideo||e.addTransceiver("video",{direction:"recvonly"}),t.disableAudio||e.addTransceiver("audio",{direction:"recvonly"});for(var r=0;r<t.multiplexedAudioTracks;r++)e.addTransceiver("audio",{direction:"recvonly"})},Yr=function(e){var t,r=null!==(t=e.connectionState)&&void 0!==t?t:e.iceConnectionState;switch(r){case"checking":return"connecting";case"completed":return"connected";default:return r}},Jr=v.get("Director"),Zr="WebRtc",Kr="bUEzT6",Qr="",en="https://realtime1.wowza.com",tn=function(){function e(){E(this,e)}var t,r;return x(e,null,[{key:"setEndpoint",value:function(e){en=e.replace(/\/$/,"")}},{key:"getEndpoint",value:function(){return en}},{key:"setLiveDomain",value:function(e){Qr=e.replace(/\/$/,"")}},{key:"getLiveDomain",value:function(){return Qr}},{key:"getPublisher",value:(r=C(A.mark((function e(t){var r,n,i,s,o,a,c,u,l,f=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>1&&void 0!==f[1]?f[1]:null,n=f.length>2&&void 0!==f[2]?f[2]:Zr,i=rn(t,r,n),Jr.info("Getting publisher connection path for stream name: ",i.streamName),s={streamName:i.streamName,streamType:i.streamType},o={Authorization:"Bearer ".concat(i.token)},a="".concat(this.getEndpoint(),"/api/director/publish"),e.prev=7,e.next=10,ye.post(a,s,{headers:o});case 10:return c=e.sent,u=c.data,u=sn(u),Jr.debug("Getting publisher response: ",u),e.abrupt("return",u.data);case 17:throw e.prev=17,e.t0=e.catch(7),Jr.error("Error while getting publisher connection path: ",null===(l=e.t0.response)||void 0===l?void 0:l.data),e.t0;case 21:case"end":return e.stop()}}),e,this,[[7,17]])}))),function(e){return r.apply(this,arguments)})},{key:"getSubscriber",value:(t=C(A.mark((function e(t){var r,n,i,s,o,a,c,u,l=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>1&&void 0!==l[1]?l[1]:null,n=nn(t,r),Jr.info("Getting subscriber connection data for stream name: ".concat(n.streamName," and account id: ").concat(n.streamAccountId)),i={streamAccountId:Kr,streamName:n.streamName},s={},n.subscriberToken&&(s={Authorization:"Bearer ".concat(n.subscriberToken)}),o="".concat(this.getEndpoint(),"/api/director/subscribe"),e.prev=7,e.next=10,ye.post(o,i,{headers:s});case 10:return a=e.sent,c=a.data,c=sn(c),Jr.debug("Getting subscriber response: ",c),e.abrupt("return",c.data);case 17:throw e.prev=17,e.t0=e.catch(7),Jr.error("Error while getting subscriber connection path: ",null===(u=e.t0.response)||void 0===u?void 0:u.data),e.t0;case 21:case"end":return e.stop()}}),e,this,[[7,17]])}))),function(e){return t.apply(this,arguments)})}]),e}(),rn=function(e,t,n){var i="object"===r(e)?e:{};return 0===Object.keys(i).length&&(i={token:e,streamName:t,streamType:n}),i},nn=function(e,t){var n="object"===r(e)?e:{};return 0===Object.keys(n).length&&(n={streamName:e,subscriberToken:t}),n},sn=function(e){if(tn.getLiveDomain()){var t=/\/\/(.*?)\//,r=e.data.urls.map((function(e){var r=t.exec(e);return e.replace(r[1],tn.getLiveDomain())}));e.data.urls=r}return e};function on(e,t,r){return(on="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function an(e){this.message=e}function cn(e){this.message=e}function un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}an.prototype=new Error,an.prototype.name="InvalidCharacterError","undefined"!=typeof window&&window.atob&&window.atob.bind(window),cn.prototype=new Error,cn.prototype.name="InvalidTokenError";var ln=function(e){R(n,e);var t,r=un(n);function n(e,t,i,s){var o;if(E(this,n),o=r.call(this),Mr=i,!e)throw Mr.error("Stream Name is required to construct this module."),new Error("Stream Name is required to construct this module.");if(!t)throw Mr.error("Token generator is required to construct this module."),new Error("Token generator is required to construct this module.");return o.webRTCPeer=new zr,o.signaling=null,o.streamName=e,o.autoReconnect=s,o.reconnectionInterval=1e3,o.alreadyDisconnected=!1,o.firstReconnection=!0,o.tokenGenerator=t,o.options=null,o}return x(n,[{key:"getRTCPeerConnection",value:function(){return this.webRTCPeer?this.webRTCPeer.getRTCPeer():null}},{key:"stop",value:function(){var e;Mr.info("Stopping"),this.webRTCPeer.closeRTCPeer(),null===(e=this.signaling)||void 0===e||e.close(),this.signaling=null,this.webRTCPeer=new zr}},{key:"isActive",value:function(){var e=this.webRTCPeer.getRTCPeerStatus();return Mr.info("Broadcast status: ",e||"not_established"),"connected"===e}},{key:"setReconnect",value:function(){var e=this;this.autoReconnect&&(this.signaling.on(Tr,(function(){!e.firstReconnection&&e.alreadyDisconnected||(e.firstReconnection=!1,e.reconnect())})),this.webRTCPeer.on(_r.connectionStateChange,(function(t){("failed"===t||"disconnected"===t&&e.alreadyDisconnected)&&e.firstReconnection?(e.firstReconnection=!1,e.reconnect()):"disconnected"===t?(e.alreadyDisconnected=!0,setTimeout((function(){return e.reconnect()}),1500)):e.alreadyDisconnected=!1})))}},{key:"reconnect",value:(t=C(A.mark((function e(){var t=this;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.isActive()){e.next=8;break}return this.stop(),e.next=5,this.connect(this.options);case 5:this.alreadyDisconnected=!1,this.reconnectionInterval=1e3,this.firstReconnection=!0;case 8:e.next=16;break;case 10:e.prev=10,e.t0=e.catch(0),this.reconnectionInterval=fn(this.reconnectionInterval),Mr.error("Reconnection failed, retrying in ".concat(this.reconnectionInterval,"ms. Error was: "),e.t0),this.emit("reconnect",{timeout:this.reconnectionInterval,error:e.t0}),setTimeout((function(){return t.reconnect()}),this.reconnectionInterval);case 16:case"end":return e.stop()}}),e,this,[[0,10]])}))),function(){return t.apply(this,arguments)})}]),n}(Ce),fn=function(e){return e<32e3?2*e:e};function dn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pn(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?dn(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}var mn=v.get("Publish"),gn={mediaStream:null,bandwidth:0,disableVideo:!1,disableAudio:!1,codec:Pr.H264,simulcast:!1,scalabilityMode:null,peerConfig:null},yn=function(e){R(n,e);var t,r=hn(n);function n(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return E(this,n),r.call(this,e,t,mn,i)}return x(n,[{key:"connect",value:(t=C(A.mark((function e(){var t,r,n,i,s,o,a,c,u,l,f=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:gn,mn.debug("Broadcast option values: ",t),this.options=pn(pn(pn({},gn),t),{},{setSDPToPeer:!1}),this.options.mediaStream){e.next=6;break}throw mn.error("Error while broadcasting. MediaStream required"),new Error("MediaStream required");case 6:if(!this.isActive()){e.next=9;break}throw mn.warn("Broadcast currently working"),new Error("Broadcast currently working");case 9:return e.prev=9,e.next=12,this.tokenGenerator();case 12:n=e.sent,e.next=19;break;case 15:throw e.prev=15,e.t0=e.catch(9),mn.error("Error generating token."),e.t0;case 19:if(n){e.next=22;break}throw mn.error("Error while broadcasting. Publisher data required"),new Error("Publisher data required");case 22:if(i=!1,!this.options.record||i){e.next=26;break}throw mn.error("Error while broadcasting. Record option detected but recording is not available"),new Error("Record option detected but recording is not available");case 26:return this.signaling=new Or({streamName:this.streamName,url:"".concat(n.urls[0],"?token=").concat(n.jwt)}),e.next=29,this.webRTCPeer.createRTCPeer(this.options.peerConfig);case 29:return Ne(this.webRTCPeer,this,[_r.connectionStateChange]),s=this.webRTCPeer.getRTCLocalSDP(this.options),o=this.signaling.connect(),e.next=34,Promise.all([s,o]);case 34:return r=e.sent,a=r[0],c=this.signaling.publish(a,this.options.codec,this.options.record,this.options.sourceId),u=this.webRTCPeer.peer.setLocalDescription(this.webRTCPeer.sessionDescription),e.next=40,Promise.all([c,u]);case 40:return r=e.sent,l=r[0],!this.options.disableVideo&&this.options.bandwidth>0&&(l=this.webRTCPeer.updateBandwidthRestriction(l,this.options.bandwidth)),e.next=45,this.webRTCPeer.setRTCRemoteSDP(l);case 45:this.setReconnect(),mn.info("Broadcasting to streamName: ",this.streamName);case 47:case"end":return e.stop()}}),e,this,[[9,15]])}))),function(){return t.apply(this,arguments)})},{key:"reconnect",value:function(){var e,t;this.options.mediaStream=null!==(e=null===(t=this.webRTCPeer)||void 0===t?void 0:t.getTracks())&&void 0!==e?e:this.options.mediaStream,on(P(n.prototype),"reconnect",this).call(this)}}]),n}(ln);function vn(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wn(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?vn(Object(n),!0).forEach((function(r){t(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}var Sn=v.get("View"),Cn={disableVideo:!1,disableAudio:!1,peerConfig:null},En=function(e){R(n,e);var t,r=bn(n);function n(e,t){var i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return E(this,n),i=r.call(this,e,t,Sn,o),s&&i.on(_r.track,(function(e){s.srcObject=e.streams[0]})),i}return x(n,[{key:"connect",value:(t=C(A.mark((function e(){var t,r,n,i,s,o,a,c,u,l=arguments;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:Cn,Sn.debug("Viewer connect options values: ",t),this.options=wn(wn(wn({},Cn),t),{},{setSDPToPeer:!1}),!this.isActive()){e.next=6;break}throw Sn.warn("Viewer currently subscribed"),new Error("Viewer currently subscribed");case 6:return e.prev=6,e.next=9,this.tokenGenerator();case 9:n=e.sent,e.next=16;break;case 12:throw e.prev=12,e.t0=e.catch(6),Sn.error("Error generating token."),e.t0;case 16:if(n){e.next=19;break}throw Sn.error("Error while subscribing. Subscriber data required"),new Error("Subscriber data required");case 19:return this.signaling=new Or({streamName:this.streamName,url:"".concat(n.urls[0],"?token=").concat(n.jwt)}),e.next=22,this.webRTCPeer.createRTCPeer(this.options.peerConfig);case 22:return Ne(this.webRTCPeer,this,Object.values(_r)),i=this.webRTCPeer.getRTCLocalSDP(wn(wn({},this.options),{},{stereo:!0})),s=this.signaling.connect(),e.next=27,Promise.all([i,s]);case 27:return r=e.sent,o=r[0],a=this.signaling.subscribe(o,this.options.multiplexedAudioTracks>0,this.options.pinnedSourceId,this.options.excludedSourceIds),c=this.webRTCPeer.peer.setLocalDescription(this.webRTCPeer.sessionDescription),e.next=33,Promise.all([a,c]);case 33:return r=e.sent,u=r[0],Ne(this.signaling,this,[Ir]),e.next=38,this.webRTCPeer.setRTCRemoteSDP(u);case 38:this.setReconnect(),Sn.info("Connected to streamName: ",this.streamName);case 40:case"end":return e.stop()}}),e,this,[[6,12]])}))),function(){return t.apply(this,arguments)})}]),n}(ln);function kn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return xn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return xn(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function xn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=P(e);if(t){var i=P(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return I(this,r)}}var Rn=v.get("EventSubscriber"),In="",Pn=function(e){R(n,e);var t,r=Tn(n);function n(e){var t;return E(this,n),(t=r.call(this)).webSocket=null,t.eventsLocation=e,t}return x(n,[{key:"subscribe",value:function(e){var t=this;Rn.info("Subscribing to event topic"),Rn.debug("Topic request value: ",e),e=JSON.stringify(e)+In,this.webSocket.onmessage=function(e){var r,n,i=kn(null===(r=e.data)||void 0===r?void 0:r.split(In));try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s){var o=t.parseSignalRMessage(s);t.emit("message",o)}}}catch(e){i.e(e)}finally{i.f()}},this.webSocket.send(e)}},{key:"initializeHandshake",value:(t=C(A.mark((function e(){var t,r,n=this;return A.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null===(t=this.webSocket)||void 0===t?void 0:t.readyState)===WebSocket.CONNECTING||(null===(r=this.webSocket)||void 0===r?void 0:r.readyState)===WebSocket.OPEN){e.next=2;break}return e.abrupt("return",new Promise((function(e,t){Rn.info("Starting events WebSocket handshake."),n.webSocket=new WebSocket(n.eventsLocation),n.webSocket.onopen=function(){Rn.info("Connection established with events WebSocket."),n.webSocket.send(JSON.stringify({protocol:"json",version:1})+In)},n.webSocket.onmessage=function(r){try{var i=n.handleHandshakeResponse(r.data);Rn.info("Successful handshake with events WebSocket. Waiting for subscriptions..."),Rn.debug("WebSocket handshake message: ",i),e()}catch(e){n.close(),t(e)}}})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"handleHandshakeResponse",value:function(e){var t=this.parseSignalRMessage(e);if(t.error)throw Rn.error("There was an error with events WebSocket handshake: ",t.error),new Error(t.error);return t}},{key:"parseSignalRMessage",value:function(e){return e=e.endsWith(In)?e.slice(0,-1):e,JSON.parse(e)}},{key:"close",value:function(){var e=this;this.webSocket&&(this.webSocket.close(),this.webSocket.onclose=function(){Rn.info("Events WebSocket closed"),e.webSocket=null})}}]),n}(Ce);function An(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return On(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return On(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function On(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ln=v.get("StreamEvents"),Bn=1,Nn=3,Dn=0,jn="wss://realtime-viewcount1.wowza.com/ws",Mn="You need to initialize stream event with StreamEvents.init()",Un=function(){function e(){E(this,e),this.eventSubscriber=null}var t;return x(e,[{key:"onUserCount",value:function(e,t,r){if(!this.eventSubscriber)throw Ln.error(Mn),new Error(Mn);Ln.info("Starting user count. AccountId: ".concat(e,", streamName: ").concat(t));var n="".concat(e,"/").concat(t),i=Dn++,s={arguments:[[n]],invocationId:i.toString(),streamIds:[],target:"SubscribeViewerCount",type:1};this.eventSubscriber.subscribe(s),this.eventSubscriber.on("message",(function(e){_n(n,i,e,r)}))}},{key:"stop",value:function(){this.eventSubscriber.close()}}],[{key:"init",value:(t=C(A.mark((function t(){var r;return A.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(r=new e).eventSubscriber=new Pn(this.getEventsLocation()),t.next=4,r.eventSubscriber.initializeHandshake();case 4:return t.abrupt("return",r);case 5:case"end":return t.stop()}}),t,this)}))),function(){return t.apply(this,arguments)})},{key:"setEventsLocation",value:function(e){jn=e}},{key:"getEventsLocation",value:function(){return jn}}]),e}(),_n=function(e,t,r,n){switch(r.type){case Bn:if("SubscribeViewerCountResponse"===r.target){var i,s=An(r.arguments);try{for(s.s();!(i=s.n()).done;){var o=i.value,a=o.streamId,c=o.count;if(a===e){var u={streamId:a,count:c};Ln.debug("User count changed: ",u),n(u)}}}catch(e){s.e(e)}finally{s.f()}}break;case Nn:if(r.error&&r.invocationId===t){var l={error:r.error,streamId:e};Ln.error("User count error: ",r.error),n(l)}}};e.Director=tn,e.Logger=v,e.PeerConnection=zr,e.Publish=yn,e.Signaling=Or,e.StreamEvents=Un,e.View=En,Object.defineProperty(e,"__esModule",{value:!0})}));
