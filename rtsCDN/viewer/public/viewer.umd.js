!function(e){"function"==typeof define&&define.amd?define(e):e()}((function(){"use strict";function e(e,t,r,n,s,i,o){try{var a=e[i](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,s)}!function(){const e={MILLICAST_STREAM_NAME:"kql9tbmi",MILLICAST_ACCOUNT_ID:"tWBXmA",MILLICAST_PUBLISH_TOKEN:"90280df4073c97b4674b85e6ce6a38c229e1df93bbc05309848a11154eb66368"};try{if(process)return process.env=Object.assign({},process.env),void Object.assign(process.env,e)}catch(e){}globalThis.process={env:e}}();var t,r=(function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function u(e,t,r,n){var s=t&&t.prototype instanceof g?t:g,i=Object.create(s.prototype),o=new k(n||[]);return i._invoke=function(e,t,r){var n=d;return function(s,i){if(n===p)throw new Error("Generator is already running");if(n===h){if("throw"===s)throw i;return P()}for(r.method=s,r.arg=i;;){var o=r.delegate;if(o){var a=I(o,r);if(a){if(a===m)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var c=l(e,t,r);if("normal"===c.type){if(n=r.done?h:f,c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=h,r.method="throw",r.arg=c.arg)}}}(e,r,o),i}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",h="completed",m={};function g(){}function y(){}function w(){}var v={};v[i]=function(){return this};var b=Object.getPrototypeOf,S=b&&b(b(A([])));S&&S!==r&&n.call(S,i)&&(v=S);var C=w.prototype=g.prototype=Object.create(v);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function r(s,i,o,a){var c=l(e[s],e,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,o,a)}),(function(e){r("throw",e,o,a)})):t.resolve(d).then((function(e){u.value=e,o(u)}),(function(e){return r("throw",e,o,a)}))}a(c.arg)}var s;this._invoke=function(e,n){function i(){return new t((function(t,s){r(e,n,t,s)}))}return s=s?s.then(i,i):i()}}function I(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,I(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var s=l(n,e.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,m;var i=s.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function A(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:P}}function P(){return{value:t,done:!0}}return y.prototype=C.constructor=w,w.constructor=y,y.displayName=c(w,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,c(e,a,"GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},E(T.prototype),T.prototype[o]=function(){return this},e.AsyncIterator=T,e.async=function(t,r,n,s,i){void 0===i&&(i=Promise);var o=new T(u(t,r,n,s),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(C),c(C,a,"Generator"),C[i]=function(){return this},C.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=A,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(R),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var c=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var i=s;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var s=n.arg;R(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(t={exports:{}},t.exports),t.exports);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t,r,n,s,i,o){try{var a=e[i](o),c=a.value}catch(e){return void r(e)}a.done?t(c):Promise.resolve(c).then(n,s)}function o(e){return function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function a(e){i(o,n,s,a,c,"next",e)}function c(e){i(o,n,s,a,c,"throw",e)}a(void 0)}))}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(e){var t={exports:{}};return e(t,t.exports),t.exports}var f=d((function(e){!function(t){var r,n={};n.VERSION="1.6.1";var s={},i=function(e,t){return function(){return t.apply(e,arguments)}},o=function(){var e,t,r=arguments,n=r[0];for(t=1;t<r.length;t++)for(e in r[t])!(e in n)&&r[t].hasOwnProperty(e)&&(n[e]=r[t][e]);return n},a=function(e,t){return{value:e,name:t}};n.TRACE=a(1,"TRACE"),n.DEBUG=a(2,"DEBUG"),n.INFO=a(3,"INFO"),n.TIME=a(4,"TIME"),n.WARN=a(5,"WARN"),n.ERROR=a(8,"ERROR"),n.OFF=a(99,"OFF");var c=function(e){this.context=e,this.setLevel(e.filterLevel),this.log=this.info};c.prototype={setLevel:function(e){e&&"value"in e&&(this.context.filterLevel=e)},getLevel:function(){return this.context.filterLevel},enabledFor:function(e){var t=this.context.filterLevel;return e.value>=t.value},trace:function(){this.invoke(n.TRACE,arguments)},debug:function(){this.invoke(n.DEBUG,arguments)},info:function(){this.invoke(n.INFO,arguments)},warn:function(){this.invoke(n.WARN,arguments)},error:function(){this.invoke(n.ERROR,arguments)},time:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"start"])},timeEnd:function(e){"string"==typeof e&&e.length>0&&this.invoke(n.TIME,[e,"end"])},invoke:function(e,t){r&&this.enabledFor(e)&&r(t,o({level:e},this.context))}};var u,l=new c({filterLevel:n.OFF});(u=n).enabledFor=i(l,l.enabledFor),u.trace=i(l,l.trace),u.debug=i(l,l.debug),u.time=i(l,l.time),u.timeEnd=i(l,l.timeEnd),u.info=i(l,l.info),u.warn=i(l,l.warn),u.error=i(l,l.error),u.log=u.info,n.setHandler=function(e){r=e},n.setLevel=function(e){for(var t in l.setLevel(e),s)s.hasOwnProperty(t)&&s[t].setLevel(e)},n.getLevel=function(){return l.getLevel()},n.get=function(e){return s[e]||(s[e]=new c(o({name:e},l.context)))},n.createDefaultHandler=function(e){(e=e||{}).formatter=e.formatter||function(e,t){t.name&&e.unshift("["+t.name+"]")};var t={},r=function(e,t){Function.prototype.apply.call(e,console,t)};return"undefined"==typeof console?function(){}:function(s,i){s=Array.prototype.slice.call(s);var o,a=console.log;i.level===n.TIME?(o=(i.name?"["+i.name+"] ":"")+s[0],"start"===s[1]?console.time?console.time(o):t[o]=(new Date).getTime():console.timeEnd?console.timeEnd(o):r(a,[o+": "+((new Date).getTime()-t[o])+"ms"])):(i.level===n.WARN&&console.warn?a=console.warn:i.level===n.ERROR&&console.error?a=console.error:i.level===n.INFO&&console.info?a=console.info:i.level===n.DEBUG&&console.debug?a=console.debug:i.level===n.TRACE&&console.trace&&(a=console.trace),e.formatter(s,i),r(a,s))}},n.useDefaults=function(e){n.setLevel(e&&e.defaultLevel||n.DEBUG),n.setHandler(n.createDefaultHandler(e))},n.setDefaults=n.useDefaults,e.exports?e.exports=n:(n._prevLogger=t.Logger,n.noConflict=function(){return t.Logger=n._prevLogger,n},t.Logger=n)}(l)}));f.useDefaults({defaultLevel:f.TRACE});const p=(e,t)=>{e.unshift(`[${t.name||"Global"}] ${(new Date).toISOString()} - ${t.level.name} -`)},h=(e,t)=>t?e.value>=v[t].value:e.value>=w.value,m=f.createDefaultHandler({formatter:p});f.setHandler(((e,t)=>{((e,t)=>{e=(e=Array.prototype.slice.call(e)).map((e=>"object"==typeof e?JSON.stringify(e):e)),p(e,t),0!==g?(y.push(e.join(" ")),y.length>=g&&(y=y.slice(-g))):y=[]})(e,t),h(t.level,t.name)&&m(e,t);var r,n=u(b);try{for(n.s();!(r=n.n()).done;){const n=r.value,s=n.handler,i=n.level;t.level.value>=i.value&&s(e,t)}}catch(e){n.e(e)}finally{n.f()}}));let g=1e4,y=[],w=f.OFF;const v={},b=[],S=s(s({},f),{},{enabledFor:h,getHistory:()=>y,getHistoryMaxSize:()=>g,setHistoryMaxSize:e=>{g=e},setLevel:e=>{w=e;for(const t in v)v[t]=e},getLevel:()=>w,get:e=>{v[e]||(v[e]=w);const t=f.get(e);return t.setLevel=t=>{v[e]=t},t.getLevel=()=>v[e],t},setHandler:(e,t)=>{b.push({handler:e,level:t})}});var C=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},E=Object.prototype.toString;function T(e){return"[object Array]"===E.call(e)}function I(e){return void 0===e}function x(e){return null!==e&&"object"==typeof e}function R(e){if("[object Object]"!==E.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function k(e){return"[object Function]"===E.call(e)}function A(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),T(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}var P={isArray:T,isArrayBuffer:function(e){return"[object ArrayBuffer]"===E.call(e)},isBuffer:function(e){return null!==e&&!I(e)&&null!==e.constructor&&!I(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:x,isPlainObject:R,isUndefined:I,isDate:function(e){return"[object Date]"===E.call(e)},isFile:function(e){return"[object File]"===E.call(e)},isBlob:function(e){return"[object Blob]"===E.call(e)},isFunction:k,isStream:function(e){return x(e)&&k(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:A,merge:function e(){var t={};function r(r,n){R(t[n])&&R(r)?t[n]=e(t[n],r):R(r)?t[n]=e({},r):T(r)?t[n]=r.slice():t[n]=r}for(var n=0,s=arguments.length;n<s;n++)A(arguments[n],r);return t},extend:function(e,t,r){return A(t,(function(t,n){e[n]=r&&"function"==typeof t?C(t,r):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}};function L(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var O=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(P.isURLSearchParams(t))n=t.toString();else{var s=[];P.forEach(t,(function(e,t){null!=e&&(P.isArray(e)?t+="[]":e=[e],P.forEach(e,(function(e){P.isDate(e)?e=e.toISOString():P.isObject(e)&&(e=JSON.stringify(e)),s.push(L(t)+"="+L(e))})))})),n=s.join("&")}if(n){var i=e.indexOf("#");-1!==i&&(e=e.slice(0,i)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e};function N(){this.handlers=[]}N.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},N.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},N.prototype.forEach=function(e){P.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var B=N,D=function(e,t,r){return P.forEach(r,(function(r){e=r(e,t)})),e},M=function(e){return!(!e||!e.__CANCEL__)},U=function(e,t){P.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))},_=function(e,t,r,n,s){return function(e,t,r,n,s){return e.config=t,r&&(e.code=r),e.request=n,e.response=s,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(new Error(e),t,r,n,s)},j=P.isStandardBrowserEnv()?{write:function(e,t,r,n,s,i){var o=[];o.push(e+"="+encodeURIComponent(t)),P.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),P.isString(n)&&o.push("path="+n),P.isString(s)&&o.push("domain="+s),!0===i&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},F=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],V=P.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=P.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},$=function(e){return new Promise((function(t,r){var n=e.data,s=e.headers;P.isFormData(n)&&delete s["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var o=e.auth.username||"",a=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";s.Authorization="Basic "+btoa(o+":"+a)}var c,u,l=(c=e.baseURL,u=e.url,c&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(u)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(c,u):u);if(i.open(e.method.toUpperCase(),O(l,e.params,e.paramsSerializer),!0),i.timeout=e.timeout,i.onreadystatechange=function(){if(i&&4===i.readyState&&(0!==i.status||i.responseURL&&0===i.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in i?function(e){var t,r,n,s={};return e?(P.forEach(e.split("\n"),(function(e){if(n=e.indexOf(":"),t=P.trim(e.substr(0,n)).toLowerCase(),r=P.trim(e.substr(n+1)),t){if(s[t]&&F.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}})),s):s}(i.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?i.response:i.responseText,status:i.status,statusText:i.statusText,headers:n,config:e,request:i};!function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(_("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}(t,r,s),i=null}},i.onabort=function(){i&&(r(_("Request aborted",e,"ECONNABORTED",i)),i=null)},i.onerror=function(){r(_("Network Error",e,null,i)),i=null},i.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(_(t,e,"ECONNABORTED",i)),i=null},P.isStandardBrowserEnv()){var d=(e.withCredentials||V(l))&&e.xsrfCookieName?j.read(e.xsrfCookieName):void 0;d&&(s[e.xsrfHeaderName]=d)}if("setRequestHeader"in i&&P.forEach(s,(function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete s[t]:i.setRequestHeader(t,e)})),P.isUndefined(e.withCredentials)||(i.withCredentials=!!e.withCredentials),e.responseType)try{i.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&i.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){i&&(i.abort(),r(e),i=null)})),n||(n=null),i.send(n)}))},z={"Content-Type":"application/x-www-form-urlencoded"};function G(e,t){!P.isUndefined(e)&&P.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var q,X={adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(q=$),q),transformRequest:[function(e,t){return U(t,"Accept"),U(t,"Content-Type"),P.isFormData(e)||P.isArrayBuffer(e)||P.isBuffer(e)||P.isStream(e)||P.isFile(e)||P.isBlob(e)?e:P.isArrayBufferView(e)?e.buffer:P.isURLSearchParams(e)?(G(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):P.isObject(e)?(G(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};X.headers={common:{Accept:"application/json, text/plain, */*"}},P.forEach(["delete","get","head"],(function(e){X.headers[e]={}})),P.forEach(["post","put","patch"],(function(e){X.headers[e]=P.merge(z)}));var H=X;function W(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var Y=function(e){return W(e),e.headers=e.headers||{},e.data=D(e.data,e.headers,e.transformRequest),e.headers=P.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),P.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||H.adapter)(e).then((function(t){return W(e),t.data=D(t.data,t.headers,e.transformResponse),t}),(function(t){return M(t)||(W(e),t&&t.response&&(t.response.data=D(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},J=function(e,t){t=t||{};var r={},n=["url","method","data"],s=["headers","auth","proxy","params"],i=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function a(e,t){return P.isPlainObject(e)&&P.isPlainObject(t)?P.merge(e,t):P.isPlainObject(t)?P.merge({},t):P.isArray(t)?t.slice():t}function c(n){P.isUndefined(t[n])?P.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(e[n],t[n])}P.forEach(n,(function(e){P.isUndefined(t[e])||(r[e]=a(void 0,t[e]))})),P.forEach(s,c),P.forEach(i,(function(n){P.isUndefined(t[n])?P.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(void 0,t[n])})),P.forEach(o,(function(n){n in t?r[n]=a(e[n],t[n]):n in e&&(r[n]=a(void 0,e[n]))}));var u=n.concat(s).concat(i).concat(o),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===u.indexOf(e)}));return P.forEach(l,c),r};function Z(e){this.defaults=e,this.interceptors={request:new B,response:new B}}Z.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=J(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[Y,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},Z.prototype.getUri=function(e){return e=J(this.defaults,e),O(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},P.forEach(["delete","get","head","options"],(function(e){Z.prototype[e]=function(t,r){return this.request(J(r||{},{method:e,url:t,data:(r||{}).data}))}})),P.forEach(["post","put","patch"],(function(e){Z.prototype[e]=function(t,r,n){return this.request(J(n||{},{method:e,url:t,data:r}))}}));var K=Z;function Q(e){this.message=e}Q.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Q.prototype.__CANCEL__=!0;var ee=Q;function te(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new ee(e),t(r.reason))}))}te.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},te.source=function(){var e;return{token:new te((function(t){e=t})),cancel:e}};var re=te;function ne(e){var t=new K(e),r=C(K.prototype.request,t);return P.extend(r,K.prototype,t),P.extend(r,t),r}var se=ne(H);se.Axios=K,se.create=function(e){return ne(J(se.defaults,e))},se.Cancel=ee,se.CancelToken=re,se.isCancel=M,se.all=function(e){return Promise.all(e)},se.spread=function(e){return function(t){return e.apply(null,t)}},se.isAxiosError=function(e){return"object"==typeof e&&!0===e.isAxiosError};var ie=se,oe=se;ie.default=oe;var ae,ce=ie,ue="object"==typeof Reflect?Reflect:null,le=ue&&"function"==typeof ue.apply?ue.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};ae=ue&&"function"==typeof ue.ownKeys?ue.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var de=Number.isNaN||function(e){return e!=e};function fe(){fe.init.call(this)}var pe=fe,he=function(e,t){return new Promise((function(r,n){function s(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",s),r([].slice.call(arguments))}Te(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&Te(e,"error",t,r)}(e,s,{once:!0})}))};fe.EventEmitter=fe,fe.prototype._events=void 0,fe.prototype._eventsCount=0,fe.prototype._maxListeners=void 0;var me=10;function ge(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function ye(e){return void 0===e._maxListeners?fe.defaultMaxListeners:e._maxListeners}function we(e,t,r,n){var s,i,o,a;if(ge(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]),void 0===o)o=i[t]=r,++e._eventsCount;else if("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),(s=ye(e))>0&&o.length>s&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,a=c,console&&console.warn&&console.warn(a)}return e}function ve(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function be(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=ve.bind(n);return s.listener=r,n.wrapFn=s,s}function Se(e,t,r){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):Ee(s,s.length)}function Ce(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Ee(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Te(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function s(i){n.once&&e.removeEventListener(t,s),r(i)}))}}Object.defineProperty(fe,"defaultMaxListeners",{enumerable:!0,get:function(){return me},set:function(e){if("number"!=typeof e||e<0||de(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");me=e}}),fe.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},fe.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||de(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},fe.prototype.getMaxListeners=function(){return ye(this)},fe.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var o=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw o.context=i,o}var a=s[e];if(void 0===a)return!1;if("function"==typeof a)le(a,this,t);else{var c=a.length,u=Ee(a,c);for(r=0;r<c;++r)le(u[r],this,t)}return!0},fe.prototype.addListener=function(e,t){return we(this,e,t,!1)},fe.prototype.on=fe.prototype.addListener,fe.prototype.prependListener=function(e,t){return we(this,e,t,!0)},fe.prototype.once=function(e,t){return ge(t),this.on(e,be(this,e,t)),this},fe.prototype.prependOnceListener=function(e,t){return ge(t),this.prependListener(e,be(this,e,t)),this},fe.prototype.removeListener=function(e,t){var r,n,s,i,o;if(ge(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,s=i;break}if(s<0)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},fe.prototype.off=fe.prototype.removeListener,fe.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var s,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(s=i[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},fe.prototype.listeners=function(e){return Se(this,e,!0)},fe.prototype.rawListeners=function(e){return Se(this,e,!1)},fe.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Ce.call(e,t)},fe.prototype.listenerCount=Ce,fe.prototype.eventNames=function(){return this._eventsCount>0?ae(this._events):[]},pe.once=he;var Ie=ke,xe=function(e,t){var r=new Re;return ke(e,r,t),r},Re=pe.EventEmitter;function ke(e,t,r){Array.isArray(r)||(r=[r]);var n=[];return r.forEach((function(r){var s=function(){var e=[].slice.call(arguments);e.unshift(r),t.emit.apply(t,e)};n.push(s),e.on(r,s)})),function(){r.forEach((function(t,r){e.removeListener(t,n[r])}))}}Ie.filter=xe;const Ae=S.get("PeerConnectionStats"),Pe="stats";class Le extends pe{constructor(e){super(),this.peer=e,this.stats=null,this.emitInterval=null,this.previousStats=null}init(){var e=this;Ae.info("Initializing peer connection stats"),this.emitInterval=setInterval(o((function*(){Ae.debug("New interval executed");const t=yield e.peer.getStats();e.parseStats(t),Ae.debug("Emitting stats"),e.emit(Pe,e.stats)})),1e3)}parseStats(e){Ae.debug("Parsing raw stats"),this.previousStats=this.stats;const t={audio:{inbounds:[],outbounds:[]},video:{inbounds:[],outbounds:[]},raw:e};var r,n=u(e.values());try{for(n.s();!(r=n.n()).done;){const e=r.value;switch(e.type){case"outbound-rtp":Oe(e,this.previousStats,t);break;case"inbound-rtp":Ne(e,this.previousStats,t);break;case"candidate-pair":e.nominated&&Be(e,t)}}}catch(e){n.e(e)}finally{n.f()}this.stats=t}stop(){Ae.info("Stopping peer connection stats"),clearInterval(this.emitInterval)}}const Oe=(e,t,r)=>{var n,i;Ae.debug("Parsing outbound-rtp report");const o=De(e),a=Me(e.codecId,r.raw),c=Ue(e,o);c.totalBytesSent=e.bytesSent,c.id=e.id;const u=t?null!==(n=null===(i=t[o].outbounds.find((e=>e.id===c.id)))||void 0===i?void 0:i.totalBytesSent)&&void 0!==n?n:0:null;c.bitrate=u?8*(e.bytesSent-u):0,"video"===o&&(c.qualityLimitationReason=e.qualityLimitationReason),r[o].outbounds.push(s(s({},a),c))},Ne=(e,t,r)=>{Ae.debug("Parsing inbound-rtp report");let n=De(e);const i=Me(e.codecId,r.raw);["audio","video"].includes(n)||(n=e.id.includes("Video")?"video":"audio");const o=Ue(e,n);if(o.totalBytesReceived=e.bytesReceived,o.totalPacketsReceived=e.packetsReceived,o.totalPacketsLost=e.packetsLost,o.jitter=e.jitter,o.id=e.id,o.bitrate=0,o.packetsLostRatioPerSecond=0,o.packetsLostDeltaPerSecond=0,t){const r=t[n].inbounds.find((e=>e.id===o.id));if(r){const t=r.totalBytesReceived;o.bitrate=8*(e.bytesReceived-t),o.packetsLostRatioPerSecond=_e(o,r),o.packetsLostDeltaPerSecond=je(o,r)}}r[n].inbounds.push(s(s({},i),o))},Be=(e,t)=>{Ae.debug("Parsing candidate-pair report"),t.totalRoundTripTime=e.totalRoundTripTime,t.currentRoundTripTime=e.currentRoundTripTime,t.availableOutgoingBitrate=e.availableOutgoingBitrate,t.candidateType=t.raw.get(e.localCandidateId).candidateType},De=e=>e.mediaType||e.kind,Me=(e,t)=>{var r;return{mimeType:(e&&null!==(r=t.get(e))&&void 0!==r?r:{}).mimeType}},Ue=(e,t)=>{const r={};return"video"===t&&(r.framesPerSecond=e.framesPerSecond,r.frameHeight=e.frameHeight,r.frameWidth=e.frameWidth),r.timestamp=e.timestamp,r},_e=(e,t)=>je(e,t)/(e.totalPacketsReceived-t.totalPacketsReceived),je=(e,t)=>e.totalPacketsLost-t.totalPacketsLost;var Fe=d((function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))})),Ve=d((function(e,t){var r=function(e){return String(Number(e))===e?Number(e):e},n=function(e,t,n){var s=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:s&&!t[e.name]&&(t[e.name]={});var i=e.push?{}:s?t[e.name]:t;!function(e,t,n,s){if(s&&!n)t[s]=r(e[1]);else for(var i=0;i<n.length;i+=1)null!=e[i+1]&&(t[n[i]]=r(e[i+1]))}(n.match(e.reg),i,e.names,e.name),e.push&&t[e.push].push(i)},s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},r=[],i=t;return e.split(/(\r\n|\r|\n)/).filter(s).forEach((function(e){var t=e[0],s=e.slice(2);"m"===t&&(r.push({rtp:[],fmtp:[]}),i=r[r.length-1]);for(var o=0;o<(Fe[t]||[]).length;o+=1){var a=Fe[t][o];if(a.reg.test(s))return n(a,i,s)}})),t.media=r,t};var i=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(i,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),s=0;s<n.length;s+=3)t.push({component:n[s],ip:n[s+1],port:n[s+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(i,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}})),$e=/%[sdv%]/g,ze=function(e){var t=1,r=arguments,n=r.length;return e.replace($e,(function(e){if(t>=n)return e;var s=r[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}}))},Ge=function(e,t,r){var n=[e+"="+(t.format instanceof Function?t.format(t.push?r:r[t.name]):t.format)];if(t.names)for(var s=0;s<t.names.length;s+=1){var i=t.names[s];t.name?n.push(r[t.name][i]):n.push(r[t.names[s]])}else n.push(r[t.name]);return ze.apply(null,n)},qe=["v","o","s","i","u","e","p","c","b","t","r","z","a"],Xe=["i","c","b","a"],He={write:function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var r=t.outerOrder||qe,n=t.innerOrder||Xe,s=[];return r.forEach((function(t){Fe[t].forEach((function(r){r.name in e&&null!=e[r.name]?s.push(Ge(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){s.push(Ge(t,r,e))}))}))})),e.media.forEach((function(e){s.push(Ge("m",Fe.m[0],e)),n.forEach((function(t){Fe[t].forEach((function(r){r.name in e&&null!=e[r.name]?s.push(Ge(t,r,e)):r.push in e&&null!=e[r.push]&&e[r.push].forEach((function(e){s.push(Ge(t,r,e))}))}))}))})),s.join("\r\n")+"\r\n"},parse:Ve.parse,parseParams:Ve.parseParams,parseFmtpConfig:Ve.parseFmtpConfig,parsePayloads:Ve.parsePayloads,parseRemoteCandidates:Ve.parseRemoteCandidates,parseImageAttributes:Ve.parseImageAttributes,parseSimulcastStreamList:Ve.parseSimulcastStreamList};class We{constructor(e,t,r,n,s,i,o,a,c){this.foundation=e,this.componentId=t,this.transport=r,this.priority=n,this.address=s,this.port=i,this.type=o,this.relAddr=a,this.relPort=c}equals(e){return e.foundation===this.foundation&&e.componentId===this.componentId&&e.transport===this.transport&&e.priority===this.priority&&e.address===this.address&&e.port===this.port&&e.type===this.type&&e.relAddr===this.relAddr&&e.relPort===this.relPort}clone(){return new We(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.relAddr,this.relPort)}plain(){const e={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type};return this.relAddr&&(e.relAddr=this.relAddr),this.relPort&&(e.relPort=this.relPort),e}getFoundation(){return this.foundation}getComponentId(){return this.componentId}getTransport(){return this.transport}getPriority(){return this.priority}getAddress(){return this.address}getPort(){return this.port}getType(){return this.type}getRelAddr(){return this.relAddr}getRelPort(){return this.relPort}}We.expand=function(e){return new We(e.foundation,e.componentId,e.transport,e.priority,e.address,e.port,e.type,e.relAddr,e.relPort)};var Ye=We;class Je{constructor(e,t){this.id=e,this.params=t||[]}clone(){return new Je(this.id,this.params)}plain(){return this.params.length?{id:this.id,params:this.params}:{id:this.id}}getId(){return this.id}getParams(){return this.params}}Je.expand=function(e){return new Je(e.id,e.params)};var Ze=Je;class Ke{constructor(e,t,r){this.codec=e,this.type=t,this.params={},this.rtcpfbs=new Set,r&&this.addParams(r)}clone(){const e=new Ke(this.codec,this.type,this.params);this.hasRTX()&&e.setRTX(this.getRTX());for(const t of this.rtcpfbs)e.addRTCPFeedback(t.clone());return this.hasChannels()&&e.setChannels(this.getChannels()),e}plain(){const e={codec:this.codec,type:this.type};this.rtx&&(e.rtx=this.rtx),this.channels&&(e.channels=this.channels),Object.keys(this.params).length&&(e.params=this.params);for(const t of this.rtcpfbs)e.rtcpfbs||(e.rtcpfbs=[]),e.rtcpfbs.push(t.plain());return e}setRTX(e){this.rtx=e}getType(){return this.type}setType(e){this.type=e}getCodec(){return this.codec}getParams(){return this.params}addParams(e){for(const t in e)this.params[t]=e[t]}addParam(e,t){this.params[e]=t}hasParam(e){return this.params.hasOwnProperty(e)}getParam(e,t){return this.hasParam(e)?this.params[e]:""+t}hasRTX(){return this.rtx}getRTX(){return this.rtx}hasChannels(){return this.channels}getChannels(){return this.channels}setChannels(e){this.channels=e}addRTCPFeedback(e){this.rtcpfbs.add(e)}getRTCPFeedbacks(){return this.rtcpfbs}}Ke.expand=function(e){const t=new Ke(e.codec,e.type,e.params);e.rtx&&t.setRTX(e.rtx),e.channels&&t.setChannels(e.channels);for(let r=0;e.rtcpfbs&&r<e.rtcpfbs.length;++r){const n=Ze.expand(e.rtcpfbs[r]);t.addRTCPFeedback(n)}return t},Ke.MapFromNames=function(e,t,r){const n=new Map;let s=96;for(let i=0;i<e.length;++i){let o;const a=e[i].split(";"),c=a[0].toLowerCase().trim();o="pcmu"===c?0:"pcma"===c?8:++s;const u=new Ke(c,o);"opus"===c?u.setChannels(2):"multiopus"===c&&u.setChannels(6),t&&"ulpfec"!==c&&"flexfec-03"!==c&&"red"!==c&&u.setRTX(++s);for(let e=0;r&&e<r.length;++e)u.addRTCPFeedback(new Ze(r[e].id,r[e].params));for(let e=1;e<a.length;++e){let t=a[e].split("=");u.addParam(t[0].trim(),t[1].trim())}n.set(u.getCodec().toLowerCase(),u)}return n};var Qe=Ke;var et=function e(){var t=this;if(!(this instanceof e))return new(Function.prototype.bind.apply(e,[null].concat(Array.prototype.slice.call(arguments))));Array.from(arguments).forEach((function(e){t[e]=Symbol.for("MEDOOZE_SEMANTIC_SDP_"+e)}))};const tt=et("ACTIVE","PASSIVE","ACTPASS","INACTIVE");tt.byValue=function(e){switch(e){case tt.ACTIVE:case tt.PASSIVE:case tt.ACTPASS:case tt.INACTIVE:return e}return tt[e.toUpperCase()]},tt.toString=function(e){switch(e){case tt.ACTIVE:return"active";case tt.PASSIVE:return"passive";case tt.ACTPASS:return"actpass";case tt.INACTIVE:return"inactive"}},tt.reverse=function(e){switch(e){case tt.ACTIVE:return tt.PASSIVE;case tt.PASSIVE:return tt.ACTIVE;case tt.ACTPASS:return tt.PASSIVE;case tt.INACTIVE:return tt.INACTIVE}};var rt=tt;class nt{constructor(e,t,r){this.setup=e,this.hash=t,this.fingerprint=r}clone(){return new nt(this.setup,this.hash,this.fingerprint)}plain(){return{setup:rt.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}}getFingerprint(){return this.fingerprint}getHash(){return this.hash}getSetup(){return this.setup}setSetup(e){this.setup=e}}nt.expand=function(e){return new nt(e.setup?rt.byValue(e.setup):rt.ACTPASS,e.hash,e.fingerprint)};var st=nt;class it{constructor(e,t,r,n){this.tag=e,this.suite=t,this.keyParams=r,this.sessionParams=n}clone(){return new it(this.tag,this.suite,this.keyParams,this.sessionParams)}plain(){return{tag:this.tag,suite:this.suite,keyParams:this.keyParams,sessionParams:this.sessionParams}}getSessionParams(){return this.sessionParams}getKeyParams(){return this.keyParams}getSuite(){return this.suite}getTag(){return this.tag}}it.expand=function(e){return new it(e.tag,e.suite,e.keyParams,e.sessionParams)};for(var ot=it,at=function(e){var t=gt(e),r=t[0],n=t[1];return 3*(r+n)/4-n},ct=function(e){var t,r,n=gt(e),s=n[0],i=n[1],o=new ft(function(e,t,r){return 3*(t+r)/4-r}(0,s,i)),a=0,c=i>0?s-4:s;for(r=0;r<c;r+=4)t=dt[e.charCodeAt(r)]<<18|dt[e.charCodeAt(r+1)]<<12|dt[e.charCodeAt(r+2)]<<6|dt[e.charCodeAt(r+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;2===i&&(t=dt[e.charCodeAt(r)]<<2|dt[e.charCodeAt(r+1)]>>4,o[a++]=255&t);1===i&&(t=dt[e.charCodeAt(r)]<<10|dt[e.charCodeAt(r+1)]<<4|dt[e.charCodeAt(r+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t);return o},ut=function(e){for(var t,r=e.length,n=r%3,s=[],i=16383,o=0,a=r-n;o<a;o+=i)s.push(yt(e,o,o+i>a?a:o+i));1===n?(t=e[r-1],s.push(lt[t>>2]+lt[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],s.push(lt[t>>10]+lt[t>>4&63]+lt[t<<2&63]+"="));return s.join("")},lt=[],dt=[],ft="undefined"!=typeof Uint8Array?Uint8Array:Array,pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ht=0,mt=pt.length;ht<mt;++ht)lt[ht]=pt[ht],dt[pt.charCodeAt(ht)]=ht;function gt(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function yt(e,t,r){for(var n,s,i=[],o=t;o<r;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(lt[(s=n)>>18&63]+lt[s>>12&63]+lt[s>>6&63]+lt[63&s]);return i.join("")}dt["-".charCodeAt(0)]=62,dt["_".charCodeAt(0)]=63;var wt={byteLength:at,toByteArray:ct,fromByteArray:ut},vt=function(e,t,r,n,s){var i,o,a=8*s-n-1,c=(1<<a)-1,u=c>>1,l=-7,d=r?s-1:0,f=r?-1:1,p=e[t+d];for(d+=f,i=p&(1<<-l)-1,p>>=-l,l+=a;l>0;i=256*i+e[t+d],d+=f,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=n;l>0;o=256*o+e[t+d],d+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),i-=u}return(p?-1:1)*o*Math.pow(2,i-n)},bt=function(e,t,r,n,s,i){var o,a,c,u=8*i-s-1,l=(1<<u)-1,d=l>>1,f=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+d>=1?f/c:f*Math.pow(2,1-d))*c>=2&&(o++,c/=2),o+d>=l?(a=0,o=l):o+d>=1?(a=(t*c-1)*Math.pow(2,s),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,s),o=0));s>=8;e[r+p]=255&a,p+=h,a/=256,s-=8);for(o=o<<s|a,u+=s;u>0;e[r+p]=255&o,p+=h,o/=256,u-=8);e[r+p-h]|=128*m},St=d((function(e,t){const r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=i,t.SlowBuffer=function(e){+e!=e&&(e=0);return i.alloc(+e)},t.INSPECT_MAX_BYTES=50;const n=2147483647;function s(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,i.prototype),t}function i(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return o(e,t,r)}function o(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!i.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const r=0|f(e,t);let n=s(r);const o=n.write(e,t);o!==r&&(n=n.slice(0,o));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(X(e,Uint8Array)){const t=new Uint8Array(e);return l(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return l(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return l(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return i.from(n,t,r);const o=function(e){if(i.isBuffer(e)){const t=0|d(e.length),r=s(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||H(e.length)?s(0):u(e);if("Buffer"===e.type&&Array.isArray(e.data))return u(e.data)}(e);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return i.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return a(e),s(e<0?0:0|d(e))}function u(e){const t=e.length<0?0:0|d(e.length),r=s(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function l(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,i.prototype),n}function d(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function f(e,t){if(i.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let s=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return G(e).length;default:if(s)return n?-1:z(e).length;t=(""+t).toLowerCase(),s=!0}}function p(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return E(this,t,r);case"ascii":return I(this,t,r);case"latin1":case"binary":return x(this,t,r);case"base64":return C(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function h(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,s){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),H(r=+r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=i.from(t,n)),i.isBuffer(t))return 0===t.length?-1:g(e,t,r,n,s);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):g(e,[t],r,n,s);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,s){let i,o=1,a=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,r/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){let n=-1;for(i=r;i<a;i++)if(u(e,i)===u(t,-1===n?0:i-n)){if(-1===n&&(n=i),i-n+1===c)return n*o}else-1!==n&&(i-=i-n),n=-1}else for(r+c>a&&(r=a-c),i=r;i>=0;i--){let r=!0;for(let n=0;n<c;n++)if(u(e,i+n)!==u(t,n)){r=!1;break}if(r)return i}return-1}function y(e,t,r,n){r=Number(r)||0;const s=e.length-r;n?(n=Number(n))>s&&(n=s):n=s;const i=t.length;let o;for(n>i/2&&(n=i/2),o=0;o<n;++o){const n=parseInt(t.substr(2*o,2),16);if(H(n))return o;e[r+o]=n}return o}function w(e,t,r,n){return q(z(t,e.length-r),e,r,n)}function v(e,t,r,n){return q(function(e){const t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return q(G(t),e,r,n)}function S(e,t,r,n){return q(function(e,t){let r,n,s;const i=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)r=e.charCodeAt(o),n=r>>8,s=r%256,i.push(s),i.push(n);return i}(t,e.length-r),e,r,n)}function C(e,t,r){return 0===t&&r===e.length?wt.fromByteArray(e):wt.fromByteArray(e.slice(t,r))}function E(e,t,r){r=Math.min(e.length,r);const n=[];let s=t;for(;s<r;){const t=e[s];let i=null,o=t>239?4:t>223?3:t>191?2:1;if(s+o<=r){let r,n,a,c;switch(o){case 1:t<128&&(i=t);break;case 2:r=e[s+1],128==(192&r)&&(c=(31&t)<<6|63&r,c>127&&(i=c));break;case 3:r=e[s+1],n=e[s+2],128==(192&r)&&128==(192&n)&&(c=(15&t)<<12|(63&r)<<6|63&n,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:r=e[s+1],n=e[s+2],a=e[s+3],128==(192&r)&&128==(192&n)&&128==(192&a)&&(c=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|1023&i),n.push(i),s+=o}return function(e){const t=e.length;if(t<=T)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=T));return r}(n)}t.kMaxLength=n,i.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(e,t,r){return o(e,t,r)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(e,t,r){return function(e,t,r){return a(e),e<=0?s(e):void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)}(e,t,r)},i.allocUnsafe=function(e){return c(e)},i.allocUnsafeSlow=function(e){return c(e)},i.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==i.prototype},i.compare=function(e,t){if(X(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let s=0,i=Math.min(r,n);s<i;++s)if(e[s]!==t[s]){r=e[s],n=t[s];break}return r<n?-1:n<r?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);let r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;const n=i.allocUnsafe(t);let s=0;for(r=0;r<e.length;++r){let t=e[r];if(X(t,Uint8Array))s+t.length>n.length?(i.isBuffer(t)||(t=i.from(t)),t.copy(n,s)):Uint8Array.prototype.set.call(n,t,s);else{if(!i.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(n,s)}s+=t.length}return n},i.byteLength=f,i.prototype._isBuffer=!0,i.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)h(this,t,t+1);return this},i.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},i.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},i.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){let e="";const r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(i.prototype[r]=i.prototype.inspect),i.prototype.compare=function(e,t,r,n,s){if(X(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===s&&(s=this.length),t<0||r>e.length||n<0||s>this.length)throw new RangeError("out of range index");if(n>=s&&t>=r)return 0;if(n>=s)return-1;if(t>=r)return 1;if(this===e)return 0;let o=(s>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0);const c=Math.min(o,a),u=this.slice(n,s),l=e.slice(t,r);for(let e=0;e<c;++e)if(u[e]!==l[e]){o=u[e],a=l[e];break}return o<a?-1:a<o?1:0},i.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},i.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},i.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},i.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}const s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let i=!1;for(;;)switch(n){case"hex":return y(this,e,t,r);case"utf8":case"utf-8":return w(this,e,t,r);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return b(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const T=4096;function I(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(127&e[s]);return n}function x(e,t,r){let n="";r=Math.min(e.length,r);for(let s=t;s<r;++s)n+=String.fromCharCode(e[s]);return n}function R(e,t,r){const n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let s="";for(let n=t;n<r;++n)s+=W[e[n]];return s}function k(e,t,r){const n=e.slice(t,r);let s="";for(let e=0;e<n.length-1;e+=2)s+=String.fromCharCode(n[e]+256*n[e+1]);return s}function A(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function P(e,t,r,n,s,o){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function L(e,t,r,n,s){j(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i,i>>=8,e[r++]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function O(e,t,r,n,s){j(t,n,s,e,r,7);let i=Number(t&BigInt(4294967295));e[r+7]=i,i>>=8,e[r+6]=i,i>>=8,e[r+5]=i,i>>=8,e[r+4]=i;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function N(e,t,r,n,s,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function B(e,t,r,n,s){return t=+t,r>>>=0,s||N(e,0,r,4),bt(e,t,r,n,23,4),r+4}function D(e,t,r,n,s){return t=+t,r>>>=0,s||N(e,0,r,8),bt(e,t,r,n,52,8),r+8}i.prototype.slice=function(e,t){const r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);const n=this.subarray(e,t);return Object.setPrototypeOf(n,i.prototype),n},i.prototype.readUintLE=i.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return n},i.prototype.readUintBE=i.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);let n=this[e+--t],s=1;for(;t>0&&(s*=256);)n+=this[e+--t]*s;return n},i.prototype.readUint8=i.prototype.readUInt8=function(e,t){return e>>>=0,t||A(e,1,this.length),this[e]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(e,t){return e>>>=0,t||A(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(e,t){return e>>>=0,t||A(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(e,t){return e>>>=0,t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(e,t){return e>>>=0,t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readBigUInt64LE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,s=this[++e]+256*this[++e]+65536*this[++e]+r*2**24;return BigInt(n)+(BigInt(s)<<BigInt(32))})),i.prototype.readBigUInt64BE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=t*2**24+65536*this[++e]+256*this[++e]+this[++e],s=this[++e]*2**24+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(s)})),i.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);let n=this[e],s=1,i=0;for(;++i<t&&(s*=256);)n+=this[e+i]*s;return s*=128,n>=s&&(n-=Math.pow(2,8*t)),n},i.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);let n=t,s=1,i=this[e+--n];for(;n>0&&(s*=256);)i+=this[e+--n]*s;return s*=128,i>=s&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return e>>>=0,t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){e>>>=0,t||A(e,2,this.length);const r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(e,t){e>>>=0,t||A(e,2,this.length);const r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(e,t){return e>>>=0,t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return e>>>=0,t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readBigInt64LE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),i.prototype.readBigInt64BE=Y((function(e){F(e>>>=0,"offset");const t=this[e],r=this[e+7];void 0!==t&&void 0!==r||V(e,this.length-8);const n=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+r)})),i.prototype.readFloatLE=function(e,t){return e>>>=0,t||A(e,4,this.length),vt(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return e>>>=0,t||A(e,4,this.length),vt(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return e>>>=0,t||A(e,8,this.length),vt(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return e>>>=0,t||A(e,8,this.length),vt(this,e,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=1,i=0;for(this[t]=255&e;++i<r&&(s*=256);)this[t+i]=e/s&255;return t+r},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){P(this,e,t,r,Math.pow(2,8*r)-1,0)}let s=r-1,i=1;for(this[t+s]=255&e;--s>=0&&(i*=256);)this[t+s]=e/i&255;return t+r},i.prototype.writeUint8=i.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,255,0),this[t]=255&e,t+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeBigUInt64LE=Y((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),i.prototype.writeBigUInt64BE=Y((function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),i.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let s=0,i=1,o=0;for(this[t]=255&e;++s<r&&(i*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},i.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){const n=Math.pow(2,8*r-1);P(this,e,t,r,n-1,-n)}let s=r-1,i=1,o=0;for(this[t+s]=255&e;--s>=0&&(i*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/i>>0)-o&255;return t+r},i.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},i.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},i.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||P(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeBigInt64LE=Y((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),i.prototype.writeBigInt64BE=Y((function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),i.prototype.writeFloatLE=function(e,t,r){return B(this,e,t,!0,r)},i.prototype.writeFloatBE=function(e,t,r){return B(this,e,t,!1,r)},i.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},i.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},i.prototype.copy=function(e,t,r,n){if(!i.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);const s=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),s},i.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){const t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;let s;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{const o=i.isBuffer(e)?e:i.from(e,n),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=o[s%a]}return this};const M={};function U(e,t,r){M[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function _(e){let t="",r=e.length;const n="-"===e[0]?1:0;for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function j(e,t,r,n,s,i){if(e>r||e<t){const n="bigint"==typeof t?"n":"";let s;throw s=i>3?0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(i+1)}${n}`:`>= -(2${n} ** ${8*(i+1)-1}${n}) and < 2 ** ${8*(i+1)-1}${n}`:`>= ${t}${n} and <= ${r}${n}`,new M.ERR_OUT_OF_RANGE("value",s,e)}!function(e,t,r){F(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||V(t,e.length-(r+1))}(n,s,i)}function F(e,t){if("number"!=typeof e)throw new M.ERR_INVALID_ARG_TYPE(t,"number",e)}function V(e,t,r){if(Math.floor(e)!==e)throw F(e,r),new M.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new M.ERR_BUFFER_OUT_OF_BOUNDS;throw new M.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${t}`,e)}U("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),U("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),U("ERR_OUT_OF_RANGE",(function(e,t,r){let n=`The value of "${e}" is out of range.`,s=r;return Number.isInteger(r)&&Math.abs(r)>2**32?s=_(String(r)):"bigint"==typeof r&&(s=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(s=_(s)),s+="n"),n+=` It must be ${t}. Received ${s}`,n}),RangeError);const $=/[^+/0-9A-Za-z-_]/g;function z(e,t){let r;t=t||1/0;const n=e.length;let s=null;const i=[];for(let o=0;o<n;++o){if(r=e.charCodeAt(o),r>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&i.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function G(e){return wt.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace($,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function q(e,t,r,n){let s;for(s=0;s<n&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function H(e){return e!=e}const W=function(){const e="0123456789abcdef",t=new Array(256);for(let r=0;r<16;++r){const n=16*r;for(let s=0;s<16;++s)t[n+s]=e[r]+e[s]}return t}();function Y(e){return"undefined"==typeof BigInt?J:e}function J(){throw new Error("BigInt not supported")}})),Ct=d((function(e,t){var r=St.Buffer;function n(e,t){for(var r in e)t[r]=e[r]}function s(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=St:(n(St,t),t.Buffer=s),n(r,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var s=r(e);return void 0!==t?"string"==typeof n?s.fill(t,n):s.fill(t):s.fill(0),s},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return St.SlowBuffer(e)}})),Et=d((function(e){var t=65536,r=4294967295;var n=Ct.Buffer,s=l.crypto||l.msCrypto;s&&s.getRandomValues?e.exports=function(e,i){if(e>r)throw new RangeError("requested too many random bytes");var o=n.allocUnsafe(e);if(e>0)if(e>t)for(var a=0;a<e;a+=t)s.getRandomValues(o.slice(a,a+t));else s.getRandomValues(o);if("function"==typeof i)return process.nextTick((function(){i(null,o)}));return o}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}}));class Tt{constructor(e,t){this.ufrag=e,this.pwd=t,this.lite=!1,this.endOfCandidates=!1}clone(){const e=new Tt(this.ufrag,this.pwd);return e.setLite(this.lite),e.setEndOfCandidates(this.endOfCandidates),e}plain(){const e={ufrag:this.ufrag,pwd:this.pwd};return this.lite&&(e.lite=this.lite),this.endOfCandidates&&(e.endOfCandidates=this.endOfCandidates),e}getUfrag(){return this.ufrag}getPwd(){return this.pwd}isLite(){return this.lite}setLite(e){this.lite=e}isEndOfCandidates(){return this.endOfCandidates}setEndOfCandidates(e){this.endOfCandidates=e}}Tt.generate=function(e){const t=new Tt,r=Et(8),n=Et(24);return t.ufrag=r.toString("hex"),t.pwd=n.toString("hex"),t.lite=e,t},Tt.expand=function(e){const t=new Tt(e.ufrag,e.pwd);return t.setLite(e.lite),t.setEndOfCandidates(e.endOfCandidates),t};var It=Tt;const xt=et("SEND","RECV");xt.byValue=function(e){return xt[e.toUpperCase()]},xt.toString=function(e){switch(e){case xt.SEND:return"send";case xt.RECV:return"recv"}},xt.reverse=function(e){switch(e){case xt.SEND:return xt.RECV;case xt.RECV:return xt.SEND}};var Rt=xt;class kt{constructor(e,t){this.id=e,this.direction=t,this.formats=[],this.params=new Map}clone(){var e=new kt(this.id,this.direction);return e.setFormats(this.formats),e.setParams(this.params),e}plain(){var e={id:this.id,direction:Rt.toString(this.direction)};for(var[t,r]of(this.formats&&(e.formats=this.formats),this.params.entries()))e.params||(e.params={}),e.params[t]=r;return e}getId(){return this.id}getDirection(){return this.direction}setDirection(e){this.direction=e}getFormats(){return this.formats}setFormats(e){this.formats=[];for(let t=0;t<e.length;++t)this.formats.push(parseInt(e[t]))}getParams(){return this.params}setParams(e){this.params=new Map(e)}addParam(e,t){this.params.set(e,t)}getDirection(){return this.direction}setDirection(e){this.direction=e}}kt.expand=function(e){const t=new kt(e.id,Rt.byValue(e.direction));for(let r in e.params)t.addParam(r,e.params[r]);return e.formats&&t.setFormats(e.formats),t};var At=kt;class Pt{constructor(e,t){this.paused=t,this.id=e}clone(){return new Pt(this.id,this.paused)}plain(){return{id:this.id,paused:this.paused}}isPaused(){return this.paused}getId(){return this.id}}Pt.expand=function(e){return new Pt(e.id,e.paused)};var Lt=Pt;class Ot{constructor(){this.send=[],this.recv=[]}clone(){const e=new Ot;for(let t=0;t<this.send.length;++t){let r=[];for(let e=0;t<this.send[e].length;++t)r.push(this.send[t][e].clone());e.addSimulcastAlternativeStreams(Rt.SEND,r)}for(let t=0;t<this.recv.length;++t){let r=[];for(let e=0;t<this.recv[e].length;++t)r.push(this.recv[t][e].clone());e.addSimulcastAlternativeStreams(Rt.RECV,r)}return e}plain(){const e={send:[],recv:[]};for(let t=0;t<this.send.length;++t){let r=[];for(let e=0;e<this.send[t].length;++e)r.push(this.send[t][e].plain());e.send.push(r)}for(let t=0;t<this.recv.length;++t){let r=[];for(let e=0;e<this.recv[t].length;++e)r.push(this.recv[t][e].plain());e.recv.push(r)}return e}addSimulcastAlternativeStreams(e,t){return e===Rt.SEND?this.send.push(t):this.recv.push(t)}addSimulcastStream(e,t){return e===Rt.SEND?this.send.push([t]):this.recv.push([t])}getSimulcastStreams(e){return e===Rt.SEND?this.send:this.recv}}Ot.expand=function(e){const t=new Ot;for(let r=0;r<e.send.length;++r){let n=[];for(let t=0;t<e.send[r].length;++t)n.push(Lt.expand(e.send[r][t]));t.addSimulcastAlternativeStreams(Rt.SEND,n)}for(let r=0;r<e.recv.length;++r){let n=[];for(let t=0;t<e.recv[r].length;++t)n.push(Lt.expand(e.recv[r][t]));t.addSimulcastAlternativeStreams(Rt.RECV,n)}return t};var Nt=Ot;const Bt=et("SENDRECV","SENDONLY","RECVONLY","INACTIVE");Bt.byValue=function(e){return Bt[e.toUpperCase()]},Bt.toString=function(e){switch(e){case Bt.SENDRECV:return"sendrecv";case Bt.SENDONLY:return"sendonly";case Bt.RECVONLY:return"recvonly";case Bt.INACTIVE:return"inactive"}},Bt.reverse=function(e){switch(e){case Bt.SENDRECV:return Bt.SENDRECV;case Bt.SENDONLY:return Bt.RECVONLY;case Bt.RECVONLY:return Bt.SENDONLY;case Bt.INACTIVE:return Bt.INACTIVE}};var Dt=Bt;class Mt{constructor(e,t){this.id=e,this.type=t,this.direction=Dt.SENDRECV,this.extensions=new Map,this.codecs=new Map,this.rids=new Map,this.simulcast=null,this.bitrate=0,this.control=null}clone(){const e=new Mt(this.id,this.type);e.setDirection(this.direction),e.setBitrate(this.bitrate);for(const t of this.codecs.values())e.addCodec(t.clone());for(const[t,r]of this.extensions.entries())e.addExtension(t,r);for(const t of this.rids.values())e.addRID(t.clone());return this.simulcast&&e.setSimulcast(this.simulcast.clone()),this.control&&e.setControl(this.control),e}plain(){const e={id:this.id,type:this.type,direction:Dt.toString(this.direction),codecs:[]};this.bitrate&&(e.bitrate=this.bitrate);for(const t of this.codecs.values())e.codecs.push(t.plain());for(const[t,r]of this.extensions.entries())e.extensions||(e.extensions={}),e.extensions[t]=r;for(const t of this.rids.values())e.rids||(e.rids=[]),e.rids.push(t.plain());return this.simulcast&&(e.simulcast=this.simulcast.plain()),this.control&&(e.control=this.control),e}getType(){return this.type}getId(){return this.id}setId(e){this.id=e}addExtension(e,t){this.extensions.set(e,t)}addRID(e){this.rids.set(e.getId(),e)}addCodec(e){this.codecs.set(e.getType(),e)}setCodecs(e){this.codecs=e}getCodecForType(e){return this.codecs.get(e)}getCodec(e){for(const t of this.codecs.values())if(t.getCodec().toLowerCase()===e.toLowerCase())return t;return null}hasCodec(e){return null!==this.getCodec(e)}getCodecs(){return this.codecs}hasRTX(){for(const e of this.codecs.values())if(e.hasRTX())return!0;return!1}getExtensions(){return this.extensions}getRIDs(){return this.rids}getRID(e){return this.rids.get(e)}getBitrate(){return this.bitrate}setBitrate(e){this.bitrate=e}getDirection(){return this.direction}setDirection(e){this.direction=e}hasControl(){return!!this.control}getControl(){return this.control}setControl(e){this.control=e}answer(e){const t=new Mt(this.id,this.type);if(e){if(t.setDirection(Dt.reverse(this.direction)),e.codecs){let r;r=Array.isArray(e.codecs)?Qe.MapFromNames(e.codecs,e.rtx,e.rtcpfbs):e.codecs;for(let e of this.codecs.values())if(r.has(e.getCodec().toLowerCase())){const n=r.get(e.getCodec().toLowerCase());if("h264"===n.getCodec()&&n.hasParam("packetization-mode")&&n.getParam("packetization-mode")!=e.getParam("packetization-mode","0"))continue;if("h264"===n.getCodec()&&n.hasParam("profile-level-id")&&e.hasParam("profile-level-id")&&n.getParam("profile-level-id")!=e.getParam("profile-level-id"))continue;if("multiopus"===n.getCodec()&&n.hasParam("num_streams")&&e.hasParam("num_streams")&&n.getParam("num_streams")!=e.getParam("num_streams"))continue;const s=n.clone();s.setType(e.getType()),s.hasRTX()&&s.setRTX(e.getRTX()),e.hasChannels()&&s.setChannels(e.getChannels()),s.addParams(e.getParams()),t.addCodec(s)}}const n=new Set(e.extensions);for(let[e,r]of this.extensions)n.has(r)&&t.addExtension(e,r);if(e.simulcast&&this.simulcast){const e=new Nt,n=this.simulcast.getSimulcastStreams(Rt.SEND);if(n)for(let t=0;t<n.length;++t){var r=[];for(let e=0;e<n[t].length;++e)r.push(n[t][e].clone());e.addSimulcastAlternativeStreams(Rt.RECV,r)}const s=this.simulcast.getSimulcastStreams(Rt.RECV);if(s)for(let t=0;t<s.length;++t){r=[];for(let e=0;e<s[t].length;++e)r.push(s[t][e].clone());e.addSimulcastAlternativeStreams(Rt.SEND,r)}for(const e of this.rids.values()){const r=e.clone();r.setDirection(Rt.reverse(e.getDirection())),t.addRID(r)}t.setSimulcast(e)}}else t.setDirection(Dt.INACTIVE);return t}getSimulcast(){return this.simulcast}setSimulcast(e){this.simulcast=e}}Mt.create=function(e,t){const r=new Mt(e,e);if(t){if(t.codecs&&(Array.isArray(t.codecs)?r.setCodecs(Qe.MapFromNames(t.codecs,t.rtx,t.rtcpfbs)):r.setCodecs(t.codecs)),t.extensions){let e=1;for(let n of t.extensions)15===e&&e++,r.addExtension(e++,n)}}else r.setDirection(Dt.INACTIVE);return r},Mt.expand=function(e){const t=new Mt(e.id,e.type);e.direction&&t.setDirection(Dt.byValue(e.direction)),t.setBitrate(e.bitrate);for(let r in e.extensions)t.addExtension(r,e.extensions[r]);for(let r=0;e.codecs&&r<e.codecs.length;++r){const n=Qe.expand(e.codecs[r]);n&&t.addCodec(n)}for(let r=0;e.rids&&r<e.rids.length;++r){const n=At.expand(e.rids[r]);t.addRID(n)}return e.simulcast&&t.setSimulcast(Nt.expand(e.simulcast)),e.control&&t.setControl(e.control),t};var Ut=Mt;class _t{constructor(e,t){this.semantics=e,this.ssrcs=[];for(let e=0;e<t.length;++e)this.ssrcs.push(parseInt(t[e]))}clone(){return new _t(this.semantics,this.ssrcs)}plain(){const e={semantics:this.semantics,ssrcs:[]};for(let t=0;t<this.ssrcs.length;++t)e.ssrcs.push(this.ssrcs[t]);return e}getSemantics(){return this.semantics}getSSRCs(){return this.ssrcs}}_t.expand=function(e){return new _t(e.semantics,e.ssrcs)};var jt=_t;class Ft{constructor(e){this.ssrc=e}clone(){const e=new Ft(this.ssrc);e.setCName(this.cname),e.setStreamId(this.streamId),e.setTrackId(this.trackId)}plain(){const e={ssrc:this.ssrc};return this.cname&&(e.cname=this.cname),this.streamId&&(e.streamId=this.streamId),this.trackId&&(e.trackid=this.trackId),e}getCName(){return this.cname}setCName(e){this.cname=e}getStreamId(){return this.streamId}setStreamId(e){this.streamId=e}getTrackId(){return this.trackId}setTrackId(e){this.trackId=e}getSSRC(){return this.ssrc}}Ft.expand=function(e){const t=new Ft(e.ssrc);return t.setCName(e.cname),t.setStreamId(e.streamId),t.setTrackId(e.trackId),t};var Vt=Ft;class $t{constructor(e,t){this.id=e,this.paused=t,this.codecs=new Map,this.params=new Map}clone(){var e=new $t(this.id,this.paused);for(let t of this.codecs.values())e.addCodec(t.clone());return e.setParams(this.params),e}plain(){var e={id:this.id,paused:this.paused,codecs:{},params:{}};for(var[t,r]of this.codecs.entries())e.codecs[t]=r.plain();for(var[t,n]of this.params.entries())e.params[t]=n;return e}getId(){return this.id}getCodecs(){return this.codecs}addCodec(e){this.codecs.set(e.getType(),e)}getParams(){return this.params}setParams(e){this.params=new Map(e)}addParam(e,t){this.params.set(e,t)}isPaused(){return this.paused}}$t.expand=function(e){const t=new $t(e.id,e.paused);for(let r in e.codecs)t.addCodec(Qe.expand(e.codecs[r]));for(let r in e.params)t.addParam(r,e.params[r]);return t};var zt=$t;class Gt{constructor(e,t){this.media=e,this.id=t,this.ssrcs=[],this.groups=[],this.encodings=[]}clone(){const e=new Gt(this.media,this.id);this.mediaId&&e.setMediaId(this.mediaId);for(let t=0;t<this.ssrcs.length;++t)e.addSSRC(this.ssrcs[t]);for(let t=0;t<this.groups.length;++t)e.addSourceGroup(this.groups[t].clone());for(let t=0;t<this.encodings.length;++t){const r=[];for(let e=0;e<this.encodings[t].length;++e)r.push(this.encodings[t][e].clone());e.addAlternativeEncodings(r)}return e}plain(){const e={media:this.media,id:this.id,ssrcs:[]};this.mediaId&&(e.mediaId=this.mediaId);for(let t=0;t<this.ssrcs.length;++t)e.ssrcs.push(this.ssrcs[t]);for(let t=0;t<this.groups.length;++t)e.groups||(e.groups=[]),e.groups.push(this.groups[t].plain());for(let t=0;t<this.encodings.length;++t){const r=[];for(let e=0;e<this.encodings[t].length;++e)r.push(this.encodings[t][e].plain());r.length&&(e.encodings||(e.encodings=[]),e.encodings.push(r))}return e}getMedia(){return this.media}setMediaId(e){this.mediaId=e}getMediaId(){return this.mediaId}getId(){return this.id}addSSRC(e){this.ssrcs.push(e)}getSSRCs(){return this.ssrcs}addSourceGroup(e){this.groups.push(e)}getSourceGroup(e){for(let t in this.groups){let r=this.groups[t];if(r.getSemantics().toLowerCase()===e.toLowerCase())return r}return null}getSourceGroups(){return this.groups}hasSourceGroup(e){for(let t in this.groups){if(this.groups[t].getSemantics().toLowerCase()===e.toLowerCase())return!0}return!1}getEncodings(){return this.encodings}addEncoding(e){this.encodings.push([e])}addAlternativeEncodings(e){this.encodings.push(e)}setEncodings(e){this.encodings=e}}Gt.expand=function(e){const t=new Gt(e.media,e.id);e.mediaId&&t.setMediaId(e.mediaId);for(let r=0;e.ssrcs&&r<e.ssrcs.length;++r)t.addSSRC(e.ssrcs[r]);for(let r=0;e.groups&&r<e.groups.length;++r)t.addSourceGroup(jt.expand(e.groups[r]));for(let r=0;e.encodings&&r<e.encodings.length;++r){const n=[];for(let t=0;t<e.encodings[r].length;++t)n.push(zt.expand(e.encodings[r][t]));t.addAlternativeEncodings(n)}return t};var qt=Gt;class Xt{constructor(e){this.id=e,this.tracks=new Map}clone(){const e=new Xt(this.id);for(const t of this.tracks.values())e.addTrack(t.clone());return e}plain(){const e={id:this.id,tracks:[]};for(const t of this.tracks.values())e.tracks.push(t.plain());return e}getId(){return this.id}addTrack(e){this.tracks.set(e.getId(),e)}removeTrack(e){return this.tracks.delete(e.getId())}removeTrackById(e){return this.tracks.delete(e)}getFirstTrack(e){for(let t of this.tracks.values())if(t.getMedia().toLowerCase()===e.toLowerCase())return t;return null}getTracks(){return this.tracks}removeAllTracks(){this.tracks.clear()}getTrack(e){return this.tracks.get(e)}}Xt.expand=function(e){const t=new Xt(e.id,e.paused);for(let r=0;r<e.tracks.length;++r){const n=qt.expand(e.tracks[r]);n&&t.addTrack(n)}return t};var Ht=Xt;class Wt{constructor(e){this.version=e||1,this.streams=new Map,this.medias=new Array,this.candidates=new Array,this.ice=null,this.dtls=null,this.crypto=null}clone(){const e=new Wt(this.version);for(let t=0;t<this.medias.length;++t)e.addMedia(this.medias[t].clone());for(const t of this.streams.values())e.addStream(t.clone());for(let t=0;t<this.candidates.length;++t)e.addCandidate(this.candidates[t].clone());return e.setICE(this.ice.clone()),this.dtls&&e.setDTLS(this.dtls.clone()),this.crypto&&e.setCrypto(this.crypto.clone()),e}plain(){const e={version:this.version,streams:[],medias:[],candidates:[]};for(let t=0;t<this.medias.length;++t)e.medias.push(this.medias[t].plain());for(const t of this.streams.values())e.streams.push(t.plain());for(let t=0;t<this.candidates.length;++t)e.candidates.push(this.candidates[t].plain());return this.ice&&(e.ice=this.ice.plain()),this.dtls&&(e.dtls=this.dtls.plain()),this.crypto&&(e.crypto=this.crypto.plain()),e}unify(){const e=new Wt(this.version);for(let t=0;t<this.medias.length;++t)e.addMedia(this.medias[t].clone());const t={audio:e.getMediasByType("audio"),video:e.getMediasByType("video")};for(const r of this.streams.values()){const n=r.clone();for(const r of n.getTracks().values()){let n=t[r.getMedia()].pop();if(!n){n=this.getMedia(r.getMedia()).clone(),n.setId(r.getId()),e.addMedia(n)}r.setMediaId(n.getId())}e.addStream(n)}for(let t=0;t<this.candidates.length;++t)e.addCandidate(this.candidates[t].clone());return this.ice&&e.setICE(this.ice.clone()),this.dtls&&e.setDTLS(this.dtls.clone()),this.crypto&&e.setCrypto(this.crypto.clone()),e}setVersion(e){this.version=e}addMedia(e){this.medias.push(e)}getMedia(e){for(let t in this.medias){let r=this.medias[t];if(r.getType().toLowerCase()===e.toLowerCase())return r}return null}getMediasByType(e){var t=[];for(let r in this.medias){let n=this.medias[r];n.getType().toLowerCase()===e.toLowerCase()&&t.push(n)}return t}getMediaById(e){for(let t in this.medias){let r=this.medias[t];if(r.getId().toLowerCase()===e.toLowerCase())return r}return null}replaceMedia(e){for(let t in this.medias)if(this.medias[t].getId()==e.getId())return this.medias[t]=e,!0;return!1}getMedias(){return this.medias}getVersion(){return this.version}getDTLS(){return this.dtls}setDTLS(e){this.dtls=e}hasCrypto(){return!!this.crypto}getCrypto(){return this.crypto}setCrypto(e){this.crypto=e}hasICE(){return!!this.ice}getICE(){return this.ice}setICE(e){this.ice=e}addCandidate(e){for(let t=0;t<this.candidates.length;++t)if(this.candidates[t].equals(e))return;this.candidates.push(e)}addCandidates(e){for(let t=0;t<e.length;++t)this.addCandidate(e[t])}getCandidates(){return this.candidates}getStream(e){return this.streams.get(e)}getStreams(){return this.streams}getFirstStream(){for(let e of this.streams.values())return e;return null}addStream(e){this.streams.set(e.getId(),e)}removeStream(e){return this.streams.delete(e.getId())}removeAllStreams(){this.streams.clear()}getTrackByMediaId(e){for(let t of this.streams.values())for(let[r,n]of t.getTracks())if(n.getMediaId()==e)return n;return null}getStreamByMediaId(e){for(let t of this.streams.values())for(let[r,n]of t.getTracks())if(n.getMediaId()==e)return t;return null}answer(e){const t=new Wt;e.ice&&(e.ice instanceof It?t.setICE(e.ice.clone()):t.setICE(It.expand(e.ice))),e.dtls&&(e.dtls instanceof st?t.setDTLS(e.dtls):t.setDTLS(st.expand(e.dtls))),e.crypto&&(e.crypto instanceof ot?t.setCrypto(e.crypto):t.setCrypto(ot.expand(e.crypto)));for(let r=0;e.candidates&&r<e.candidates.length;++r)e.candidates[r]instanceof Ye?t.addCandidate(e.candidates[r].clone()):t.addCandidate(Ye.expand(e.candidates[r]));for(let r in this.medias){const n=this.medias[r],s=e&&e.capabilities&&e.capabilities[n.getType()];t.addMedia(n.answer(s))}return t}toString(){let e={version:0,media:[]};e.version=0,e.origin={username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"},e.name="semantic-sdp",e.connection={version:4,ip:"0.0.0.0"},e.timing={start:0,stop:0},this.hasICE()&&this.getICE().isLite()&&(e.icelite="ice-lite"),e.msidSemantic={semantic:"WMS",token:"*"},e.groups=[];let t={type:"BUNDLE",mids:[]};for(let r in this.medias){let n=this.medias[r],s={type:n.getType(),port:9,protocol:"",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};s.direction=Dt.toString(n.getDirection()),s.rtcpMux="rtcp-mux",s.rtcpRsize="rtcp-rsize",s.extmapAllowMixed="extmap-allow-mixed",s.mid=n.getId(),t.mids.push(n.getId()),n.hasControl()&&(s.control=n.getControl()),n.getBitrate()>0&&s.bandwidth.push({type:"AS",limit:n.getBitrate()});let i=this.getCandidates();for(let e=0;e<i.length;++e){let t=i[e];s.candidates.push({foundation:t.getFoundation(),component:t.getComponentId(),transport:t.getTransport(),priority:t.getPriority(),ip:t.getAddress(),port:t.getPort(),type:t.getType(),raddr:t.getRelAddr(),rport:t.getRelPort()})}this.getICE()&&(s.iceUfrag=this.getICE().getUfrag(),s.icePwd=this.getICE().getPwd()),this.getDTLS()?(s.protocol="UDP/TLS/RTP/SAVPF",s.fingerprint={type:this.getDTLS().getHash(),hash:this.getDTLS().getFingerprint()},s.setup=rt.toString(this.getDTLS().getSetup())):this.getCrypto()?(s.protocol="UDP/SAVPF",s.crypto=[{id:this.getCrypto().getTag(),suite:this.getCrypto().getSuite(),config:this.getCrypto().getKeyParams()}]):s.protocol="UDP/AVP";for(let e of n.getCodecs().values()){"video"===n.getType().toLowerCase()?s.rtp.push({payload:e.getType(),codec:e.getCodec().toUpperCase(),rate:9e4}):"opus"===e.getCodec().toLowerCase()||"multiopus"===e.getCodec().toLowerCase()?s.rtp.push({payload:e.getType(),codec:e.getCodec(),rate:48e3,encoding:e.getChannels()}):s.rtp.push({payload:e.getType(),codec:e.getCodec(),rate:8e3});for(const t of e.getRTCPFeedbacks())s.rtcpFb.push({payload:e.getType(),type:t.getId(),subtype:t.getParams().join(" ")});e.hasRTX()&&(s.rtp.push({payload:e.getRTX(),codec:"rtx",rate:9e4}),s.fmtp.push({payload:e.getRTX(),config:"apt="+e.getType()}));const t=e.getParams();if(Object.keys(t).length){const r={payload:e.getType(),config:""};for(const e in t)r.config.length&&(r.config+=";"),t.hasOwnProperty(e)?r.config+=e+"="+t[e]:r.config+=e;s.fmtp.push(r)}}const o=[];for(let e=0;e<s.rtp.length;++e)o.push(s.rtp[e].payload);s.payloads=o.join(" ");for(let[e,t]of n.getExtensions().entries())s.ext.push({value:e,uri:t});for(let e of n.getRIDs().values()){let t={id:e.getId(),direction:Rt.toString(e.getDirection()),params:""};e.getFormats().length&&(t.params="pt="+e.getFormats().join(","));for(let[r,n]of e.getParams().entries())t.params+=(t.params.length?";":"")+r+"="+n;s.rids.push(t)}const a=n.getSimulcast();if(a){let e=1;s.simulcast={};const t=a.getSimulcastStreams(Rt.SEND),r=a.getSimulcastStreams(Rt.RECV);if(t&&t.length){let r="";for(let e=0;e<t.length;++e){let n="";for(let r=0;r<t[e].length;++r)n+=(n.length?",":"")+(t[e][r].isPaused()?"~":"")+t[e][r].getId();r+=(r.length?";":"")+n}s.simulcast["dir"+e]="send",s.simulcast["list"+e]=r,e++}if(r&&r.length){let t=[];for(let e=0;e<r.length;++e){let n="";for(let t=0;t<r[e].length;++t)n+=(n.length?",":"")+(r[e][t].isPaused()?"~":"")+r[e][t].getId();t+=(t.length?";":"")+n}s.simulcast["dir"+e]="recv",s.simulcast["list"+e]=t,e++}}e.media.push(s)}for(let t of this.streams.values())for(let r of t.getTracks().values())for(let n in e.media){let s=e.media[n];if(r.getMediaId()){if(r.getMediaId()==s.mid){let e=r.getSourceGroups();for(let t in e){let r=e[t];s.ssrcGroups.push({semantics:r.getSemantics(),ssrcs:r.getSSRCs().join(" ")})}let n=r.getSSRCs();for(let e in n)s.ssrcs.push({id:n[e],attribute:"cname",value:t.getId()}),s.ssrcs.push({id:n[e],attribute:"msid",value:t.getId()+" "+r.getId()});s.msid=t.getId()+" "+r.getId();break}}else if(s.type.toLowerCase()===r.getMedia().toLowerCase()){let e=r.getSourceGroups();for(let t in e){let r=e[t];s.ssrcGroups.push({semantics:r.getSemantics(),ssrcs:r.getSSRCs().join(" ")})}let n=r.getSSRCs();for(let e in n)s.ssrcs.push({id:n[e],attribute:"cname",value:t.getId()}),s.ssrcs.push({id:n[e],attribute:"msid",value:t.getId()+" "+r.getId()});break}}return t.mids=t.mids.join(" "),e.groups.push(t),He.write(e)}}Wt.create=function(e){const t=new Wt;e.ice&&(e.ice instanceof It?t.setICE(e.ice.clone()):t.setICE(It.expand(e.ice))),e.dtls&&(e.dtls instanceof st?t.setDTLS(e.dtls):t.setDTLS(st.expand(e.dtls))),e.crypto&&(e.crypto instanceof ot?t.setCrypto(e.crypto):t.setCrypto(ot.expand(e.crypto)));for(let r=0;e.candidates&&r<e.candidates.length;++r)e.candidates[r]instanceof Ye?t.addCandidate(e.candidates[r].clone()):t.addCandidate(Ye.expand(e.candidates[r]));let r=96;for(let n in e.capabilities){const s=Ut.create(n,e.capabilities[n]);for(const[e,t]of s.getCodecs())t.getType()>=96&&t.setType(r++),t.getRTX()&&t.setRTX(r++);t.addMedia(s)}return t},Wt.expand=function(e){const t=new Wt(e.version);for(let r=0;e.medias&&r<e.medias.length;++r){const n=Ut.expand(e.medias[r]);n&&t.addMedia(n)}for(let r=0;e.streams&&r<e.streams.length;++r){const n=Ht.expand(e.streams[r]);n&&t.addStream(n)}for(let r=0;e.candidates&&r<e.candidates.length;++r){const n=Ye.expand(e.candidates[r]);n&&t.addCandidate(n)}return e.ice&&t.setICE(It.expand(e.ice)),e.dtls&&t.setDTLS(st.expand(e.dtls)),e.crypto&&t.setCrypto(st.expand(e.crypto)),t},Wt.process=function(e){return Wt.parse(e)},Wt.parse=function(e){const t=He.parse(e),r=new Wt;r.setVersion(t.version);for(let e in t.media){const n=t.media[e],s=n.type,i=n.mid?n.mid.toString():e,o=new Ut(i,s);if(n.iceUfrag&&n.icePwd){const e=String(n.iceUfrag),t=String(n.icePwd);r.setICE(new It(e,t))}for(let e=0;n.candidates&&e<n.candidates.length;++e){const t=n.candidates[e],s=new Ye(t.foundation,t.component,t.transport,t.priority,t.ip,t.port,t.type,t.raddr,t.rport);r.addCandidate(s)}const a=n.fingerprint||t.fingerprint;if(a){const e=a.type,t=a.hash;let s=rt.ACTPASS;n.setup&&(s=rt.byValue(n.setup)),r.setDTLS(new st(s,e,t))}if(n.crypto){const e=n.crypto[0];r.setCrypto(new ot(e.id,e.suite,e.config,e.sessionConfig))}let c=Dt.SENDRECV;n.direction&&(c=Dt.byValue(n.direction),o.setDirection(c)),n.control&&o.setControl(n.control);const u=new Map;for(let e in n.rtp){const t=n.rtp[e],r=t.payload,s=t.codec;if("RED"===s.toUpperCase()||"ULPFEC"===s.toUpperCase())continue;let i={};for(let e in n.fmtp){const t=n.fmtp[e];if(t.payload===r){const e=t.config.split(";");for(let t in e){const r=e[t].split("="),n=r[0].trim(),s=r.splice(1).join("=").trim();i[n]=s}}}if("RTX"===s.toUpperCase())u.set(parseInt(i.apt),r);else{const e=new Qe(s,r,i);t.encoding>1&&e.setChannels(t.encoding),o.addCodec(e)}}for(let e of u.entries()){const t=o.getCodecForType(e[0]);t&&t.setRTX(e[1])}for(let e=0;n.rtcpFb&&e<n.rtcpFb.length;++e){const t=o.getCodecForType(n.rtcpFb[e].payload);if(t){const r=n.rtcpFb[e].type,s=n.rtcpFb[e].subtype?n.rtcpFb[e].subtype.split(" "):null;t.addRTCPFeedback(new Ze(r,s))}}const l=n.ext;for(let e in l){const t=l[e];o.addExtension(t.value,t.uri)}const d=n.rids;for(let e in d){const t=d[e],r=new At(t.id,Rt.byValue(t.direction));let n=[];const s=new Map;if(t.params){const e=He.parseParams(t.params);for(let t in e)"pt"===t?n=e[t].split(","):s.set(t,e[t]);r.setFormats(n),r.setParams(s)}o.addRID(r)}const f=[];if(n.simulcast){const e=new Nt;if(n.simulcast.dir1){const t=Rt.byValue(n.simulcast.dir1),r=He.parseSimulcastStreamList(n.simulcast.list1);for(let n=0;n<r.length;++n){const s=[];for(let e=0;e<r[n].length;++e)s.push(new Lt(r[n][e].scid,r[n][e].paused));e.addSimulcastAlternativeStreams(t,s)}}if(n.simulcast.dir2){const t=Rt.byValue(n.simulcast.dir2),r=He.parseSimulcastStreamList(n.simulcast.list2);for(let n=0;n<r.length;++n){const s=[];for(let e=0;e<r[n].length;++e)s.push(new Lt(r[n][e].scid,r[n][e].paused));e.addSimulcastAlternativeStreams(t,s)}}for(let t of e.getSimulcastStreams(Rt.SEND)){const e=[];for(let r=0;r<t.length;r++){const n=new zt(t[r].getId(),t[r].isPaused()),s=o.getRID(n.getId());if(s){const t=s.getFormats();for(let e=0;t&&e<t.length;++e){const r=o.getCodecForType(t[e]);r&&n.addCodec(r)}n.setParams(s.getParams()),e.push(n)}}e.length&&f.push(e)}o.setSimulcast(e)}const p=new Map;if(n.ssrcs)for(let e in n.ssrcs){let t=n.ssrcs[e],o=t.id,a=t.attribute,c=t.value,u=p.get(o);if(u||(u=new Vt(o),p.set(u.getSSRC(),u)),"cname"===a.toLowerCase())u.setCName(c);else if("msid"===a.toLowerCase()){let e=c.split(" "),t=e[0],n=e[1];u.setStreamId(t),u.setTrackId(n);let a=r.getStream(t);a||(a=new Ht(t),r.addStream(a));let l=a.getTrack(n);l||(l=new qt(s,n),l.setMediaId(i),l.setEncodings(f),a.addTrack(l)),l.addSSRC(o)}}if(n.msid){let e=n.msid.split(" "),t=e[0],o=e[1],a=r.getStream(t);a||(a=new Ht(t),r.addStream(a));let c=a.getTrack(o);c||(c=new qt(s,o),c.setMediaId(i),c.setEncodings(f),a.addTrack(c));for(let[e,r]of p.entries())r.getStreamId()||(r.setStreamId(t),r.setTrackId(o),c.addSSRC(e))}for(let[e,t]of p.entries())if(!t.getStreamId()){let n=t.getCName(),o=i;t.setStreamId(n),t.setTrackId(o);let a=r.getStream(n);a||(a=new Ht(n),r.addStream(a));let c=a.getTrack(o);c||(c=new qt(s,o),c.setMediaId(i),c.setEncodings(f),a.addTrack(c)),c.addSSRC(e)}if(n.ssrcGroups)for(let e in n.ssrcGroups){let t=n.ssrcGroups[e],s=t.ssrcs.split(" "),i=new jt(t.semantics,s),o=p.get(parseInt(s[0]));r.getStream(o.getStreamId()).getTrack(o.getTrackId()).addSourceGroup(i)}r.addMedia(o)}return r};var Yt={SDPInfo:Wt,CandidateInfo:Ye,CodecInfo:Qe,DTLSInfo:st,CryptoInfo:ot,ICEInfo:It,MediaInfo:Ut,Setup:rt,SourceGroupInfo:jt,SourceInfo:Vt,StreamInfo:Ht,TrackInfo:qt,TrackEncodingInfo:zt,Direction:Dt},Jt=d((function(e,t){!function(r,n){var s="function",i="object",o="string",a="model",c="name",u="type",l="vendor",d="version",f="architecture",p="console",h="mobile",m="tablet",g="smarttv",y="wearable",w="embedded",v={extend:function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2==0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r},has:function(e,t){return typeof e===o&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return typeof e===o?e.replace(/[^\d\.]/g,"").split(".")[0]:n},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===t?e:e.substring(0,255)}},b={rgx:function(e,t){for(var r,o,a,c,u,l,d=0;d<t.length&&!u;){var f=t[d],p=t[d+1];for(r=o=0;r<f.length&&!u;)if(u=f[r++].exec(e))for(a=0;a<p.length;a++)l=u[++o],typeof(c=p[a])===i&&c.length>0?2==c.length?typeof c[1]==s?this[c[0]]=c[1].call(this,l):this[c[0]]=c[1]:3==c.length?typeof c[1]!==s||c[1].exec&&c[1].test?this[c[0]]=l?l.replace(c[1],c[2]):n:this[c[0]]=l?c[1].call(this,l,c[2]):n:4==c.length&&(this[c[0]]=l?c[3].call(this,l.replace(c[1],c[2])):n):this[c]=l||n;d+=2}},str:function(e,t){for(var r in t)if(typeof t[r]===i&&t[r].length>0){for(var s=0;s<t[r].length;s++)if(v.has(t[r][s],e))return"?"===r?n:r}else if(v.has(t[r],e))return"?"===r?n:r;return e}},S={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},C={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[c,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[c,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[c,d],[/opios[\/\s]+([\w\.]+)/i],[d,[c,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[d,[c,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[c,d],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[d,[c,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[d,[c,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[c,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[c,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[d,[c,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[c,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[c,/(.+)/,"$1 Secure Browser"],d],[/focus\/([\w\.]+)/i],[d,[c,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[d,[c,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[d,[c,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[c,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[c,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[c,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[d,[c,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[c,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],d],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[c,d],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[c],[/;fbav\/([\w\.]+);/i],[d,[c,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[c,d],[/\bgsa\/([\w\.]+)\s.*safari\//i],[d,[c,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,"Chrome WebView"],d],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[d,[c,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,d],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[d,[c,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[d,c],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[d,b.str,S.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],d],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[d,[c,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[f,"amd64"]],[/(ia32(?=;))/i],[[f,v.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[f,"ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[[f,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[f,"armhf"]],[/windows\s(ce|mobile);\sppc;/i],[[f,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[f,/ower/,"",v.lowerize]],[/(sun4\w)[;\)]/i],[[f,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[f,v.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[a,[l,"Samsung"],[u,m]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[a,[l,"Samsung"],[u,h]],[/\((ip(?:hone|od)[\s\w]*);/i],[a,[l,"Apple"],[u,h]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[a,[l,"Apple"],[u,m]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[a,[l,"Huawei"],[u,m]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[a,[l,"Huawei"],[u,h]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[a,/_/g," "],[l,"Xiaomi"],[u,h]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[a,/_/g," "],[l,"Xiaomi"],[u,m]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[a,[l,"OPPO"],[u,h]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[a,[l,"Vivo"],[u,h]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[a,[l,"Realme"],[u,h]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[a,[l,"Motorola"],[u,h]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[a,[l,"Motorola"],[u,m]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[a,[l,"LG"],[u,m]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[a,[l,"LG"],[u,h]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[a,[l,"Lenovo"],[u,m]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[a,/_/g," "],[l,"Nokia"],[u,h]],[/droid.+;\s(pixel\sc)[\s)]/i],[a,[l,"Google"],[u,m]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[a,[l,"Google"],[u,h]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[a,[l,"Sony"],[u,h]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[a,"Xperia Tablet"],[l,"Sony"],[u,m]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[a,[l,"OnePlus"],[u,h]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[a,[l,"Amazon"],[u,m]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[a,"Fire Phone"],[l,"Amazon"],[u,h]],[/\((playbook);[\w\s\),;-]+(rim)/i],[a,l,[u,m]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[a,[l,"BlackBerry"],[u,h]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[a,[l,"ASUS"],[u,m]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[a,[l,"ASUS"],[u,h]],[/(nexus\s9)/i],[a,[l,"HTC"],[u,m]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[a,/_/g," "],[u,h]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[a,[l,"Acer"],[u,m]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[a,[l,"Meizu"],[u,h]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,a,[u,h]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[l,a,[u,m]],[/\s(surface\sduo)\s/i],[a,[l,"Microsoft"],[u,m]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[a,[l,"Fairphone"],[u,h]],[/\s(u304aa)\sbuild/i],[a,[l,"AT&T"],[u,h]],[/sie-(\w*)/i],[a,[l,"Siemens"],[u,h]],[/[;\/]\s?(rct\w+)\sbuild/i],[a,[l,"RCA"],[u,m]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[a,[l,"Dell"],[u,m]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[a,[l,"Verizon"],[u,m]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[a,[l,"Barnes & Noble"],[u,m]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[a,[l,"NuVision"],[u,m]],[/;\s(k88)\sbuild/i],[a,[l,"ZTE"],[u,m]],[/;\s(nx\d{3}j)\sbuild/i],[a,[l,"ZTE"],[u,h]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[a,[l,"Swiss"],[u,h]],[/[;\/]\s?(zur\d{3})\sbuild/i],[a,[l,"Swiss"],[u,m]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[a,[l,"Zeki"],[u,m]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[l,"Dragon Touch"],a,[u,m]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[a,[l,"Insignia"],[u,m]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[a,[l,"NextBook"],[u,m]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[l,"Voice"],a,[u,h]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[l,"LvTel"],a,[u,h]],[/;\s(ph-1)\s/i],[a,[l,"Essential"],[u,h]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[a,[l,"Envizen"],[u,m]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[a,[l,"MachSpeed"],[u,m]],[/[;\/]\s?tu_(1491)\sbuild/i],[a,[l,"Rotor"],[u,m]],[/(shield[\w\s]+)\sbuild/i],[a,[l,"Nvidia"],[u,m]],[/(sprint)\s(\w+)/i],[l,a,[u,h]],[/(kin\.[onetw]{3})/i],[[a,/\./g," "],[l,"Microsoft"],[u,h]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[a,[l,"Zebra"],[u,m]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[a,[l,"Zebra"],[u,h]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[l,a,[u,p]],[/droid.+;\s(shield)\sbuild/i],[a,[l,"Nvidia"],[u,p]],[/(playstation\s[345portablevi]+)/i],[a,[l,"Sony"],[u,p]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[a,[l,"Microsoft"],[u,p]],[/smart-tv.+(samsung)/i],[l,[u,g]],[/hbbtv.+maple;(\d+)/i],[[a,/^/,"SmartTV"],[l,"Samsung"],[u,g]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[l,"LG"],[u,g]],[/(apple)\s?tv/i],[l,[a,"Apple TV"],[u,g]],[/crkey/i],[[a,"Chromecast"],[l,"Google"],[u,g]],[/droid.+aft([\w])(\sbuild\/|\))/i],[a,[l,"Amazon"],[u,g]],[/\(dtv[\);].+(aquos)/i],[a,[l,"Sharp"],[u,g]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,v.trim],[a,v.trim],[u,g]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[u,g]],[/((pebble))app\/[\d\.]+\s/i],[l,a,[u,y]],[/droid.+;\s(glass)\s\d/i],[a,[l,"Google"],[u,y]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[a,[l,"Zebra"],[u,y]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[l,[u,w]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[a,[u,h]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[a,[u,m]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,v.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[a,[l,"Generic"]],[/(phone)/i],[[u,h]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[c,[d,b.str,S.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[d,b.str,S.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[c,"Mac OS"],[d,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[c,d],[/\(bb(10);/i],[d,[c,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[d,[c,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[c,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[c,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],d],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[c,d],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],d],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,d]]},E=function(e,t){if("object"==typeof e&&(t=e,e=n),!(this instanceof E))return new E(e,t).getResult();var s=e||(void 0!==r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),i=t?v.extend(C,t):C;return this.getBrowser=function(){var e={name:n,version:n};return b.rgx.call(e,s,i.browser),e.major=v.major(e.version),e},this.getCPU=function(){var e={architecture:n};return b.rgx.call(e,s,i.cpu),e},this.getDevice=function(){var e={vendor:n,model:n,type:n};return b.rgx.call(e,s,i.device),e},this.getEngine=function(){var e={name:n,version:n};return b.rgx.call(e,s,i.engine),e},this.getOS=function(){var e={name:n,version:n};return b.rgx.call(e,s,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return s},this.setUA=function(e){return s=typeof e===o&&e.length>255?v.trim(e,255):e,this},this.setUA(s),this};E.VERSION="0.7.28",E.BROWSER={NAME:c,MAJOR:"major",VERSION:d},E.CPU={ARCHITECTURE:f},E.DEVICE={MODEL:a,VENDOR:l,TYPE:u,CONSOLE:p,MOBILE:h,SMARTTV:g,TABLET:m,WEARABLE:y,EMBEDDED:w},E.ENGINE={NAME:c,VERSION:d},E.OS={NAME:c,VERSION:d},e.exports&&(t=e.exports=E),t.UAParser=E;var T=void 0!==r&&(r.jQuery||r.Zepto);if(T&&!T.ua){var I=new E;T.ua=I.getResult(),T.ua.get=function(){return I.getUA()},T.ua.set=function(e){I.setUA(e);var t=I.getResult();for(var r in t)T.ua[r]=t[r]}}}("object"==typeof window?window:l)}));const Zt=["iOS"];class Kt extends Jt{constructor(){super(window.navigator.userAgent)}isChrome(){const e=this.getBrowser(),t=this.getOS();let r=!0;return r=!new RegExp(Zt.join("|"),"i").test(t.name),e.name.match(/Chrome/i)&&r}isFirefox(){return this.getBrowser().name.match(/Firefox/i)}}const Qt=S.get("SdpParser"),er=Array.from({length:31},((e,t)=>t+35)),tr=Array.from({length:32},((e,t)=>t+96));class rr{static setSimulcast(e,t){Qt.info("Setting simulcast. Codec: ",t);if(!(new Kt).isChrome())return Qt.warn("Simulcast is only available in Google Chrome browser"),e;if("h264"!==t&&"vp8"!==t)return Qt.warn("Simulcast is only available in h264 and vp8 codecs"),e;try{const t=/m=video[\s\S]*?a=ssrc:([0-9]*) mslabel:([\s\S]+?)\r\n/,r=/m=video[\s\S]*?a=ssrc:([0-9]*) msid:([\s\S]+?)\r\n/,n=/m=video[\s\S]*?a=ssrc:([0-9]*) label:([\s\S]+?)\r\n/,s=/m=video[\s\S]*?a=ssrc:([0-9]*) cname:([\s\S]+?)\r\n/.exec(e),i=s[1],o=s[2],a=t.exec(e)[2],c=r.exec(e)[2],u=n.exec(e)[2],l=2,d=[i];for(let t=0;t<l;++t){const r=100+2*t,n=r+1;d.push(r),e+="a=ssrc-group:FID "+r+" "+n+"\r\na=ssrc:"+r+" cname:"+o+"\r\na=ssrc:"+r+" msid:"+c+"\r\na=ssrc:"+r+" mslabel:"+a+"\r\na=ssrc:"+r+" label:"+u+"\r\na=ssrc:"+n+" cname:"+o+"\r\na=ssrc:"+n+" msid:"+c+"\r\na=ssrc:"+n+" mslabel:"+a+"\r\na=ssrc:"+n+" label:"+u+"\r\n"}return e+="a=x-google-flag:conference\r\n",e+="a=ssrc-group:SIM "+d.join(" ")+"\r\n",Qt.info("Simulcast setted"),Qt.debug("Simulcast SDP: ",e),e}catch(e){throw Qt.error("Error setting SDP for simulcast: ",e),e}}static setStereo(e){return Qt.info("Replacing SDP response for support stereo"),e=e.replace("useinbandfec=1","useinbandfec=1; stereo=1"),Qt.info("Replaced SDP response for support stereo"),Qt.debug("New SDP value: ",e),e}static setVideoBitrate(e,t){if(t<1)Qt.info("Remove bitrate restrictions"),e=e.replace(/b=AS:.*\r\n/,"").replace(/b=TIAS:.*\r\n/,"");else{const r=new Kt,n=Yt.SDPInfo.parse(e),s=n.getMedia("video");Qt.info("Setting video bitrate"),s.setBitrate(t),(e=n.toString()).indexOf("b=AS:")>-1&&r.isFirefox()&&(Qt.info("Updating SDP for firefox browser"),e=e.replace("b=AS:","b=TIAS:"),Qt.debug("SDP updated for firefox: ",e))}return e}static removeSdpLine(e,t){return Qt.debug("SDP before trimming: ",e),e=e.split("\n").filter((e=>e.trim()!==t)).join("\n"),Qt.debug("SDP trimmed result: ",e),e}static adaptCodecName(e,t,r){if(!e)return e;const n=new RegExp(`${t}`,"i");return e.replace(n,r)}static setMultiopus(e,t){if((new Kt).isChrome()&&(!t||nr(t)))if(e.includes("multiopus/48000/6"))Qt.info("Multiopus already setted");else{Qt.info("Setting multiopus");const t=/m=audio 9 UDP\/TLS\/RTP\/SAVPF (.*)\r\n/.exec(e)[0],r=rr.getAvailablePayloadTypeRange(e)[0],n=t.replace("\r\n"," ")+r+"\r\na=rtpmap:"+r+" multiopus/48000/6\r\na=fmtp:"+r+" channel_mapping=0,4,1,2,3,5;coupled_streams=2;minptime=10;num_streams=4;useinbandfec=1\r\n";e=e.replace(t,n),Qt.info("Multiopus offer created"),Qt.debug("SDP parsed for multioups: ",e)}return e}static getAvailablePayloadTypeRange(e){const t=e.matchAll(/m=(?:.*) (?:.*) UDP\/TLS\/RTP\/SAVPF (.*)\r\n/gm);let r=tr.concat(er);var n,s=u(t);try{for(s.s();!(n=s.n()).done;){const e=n.value[1].split(" ").map((e=>parseInt(e)));r=r.filter((t=>!e.includes(t)))}}catch(e){s.e(e)}finally{s.f()}return r}}const nr=e=>e.getAudioTracks().some((e=>e.getSettings().channelCount>2));class sr extends pe{constructor(e,t){super(),this.namespace=e,this.tm=t}cmd(e,t){return this.tm.cmd(e,t,this.namespace)}event(e,t){return this.tm.event(e,t,this.namespace)}close(){return this.tm.namespaces.delete(this.namespace)}}var ir=class extends pe{constructor(e){super(),this.maxId=0,this.namespaces=new Map,this.transactions=new Map,this.transport=e,this.listener=t=>{let r;try{r=JSON.parse(t.utf8Data||t.data)}catch(e){return}switch(r.type){case"cmd":const t={name:r.name,data:r.data,namespace:r.namespace,accept:t=>{e.send(JSON.stringify({type:"response",transId:r.transId,data:t}))},reject:t=>{e.send(JSON.stringify({type:"error",transId:r.transId,data:t}))}};if(t.namespace){const e=this.namespaces.get(t.namespace);e?e.emit("cmd",t):this.emit("cmd",t)}else this.emit("cmd",t);break;case"response":{const e=this.transactions.get(r.transId);if(!e)return;this.transactions.delete(r.transId),e.resolve(r.data);break}case"error":{const e=this.transactions.get(r.transId);if(!e)return;this.transactions.delete(r.transId),e.reject(r.data);break}case"event":const s={name:r.name,data:r.data,namespace:r.namespace};if(s.namespace){var n=this.namespaces.get(s.namespace);n?n.emit("event",s):this.emit("event",s)}else this.emit("event",s)}},this.transport.addListener?this.transport.addListener("message",this.listener):this.transport.addEventListener("message",this.listener)}cmd(e,t,r){return new Promise(((n,s)=>{if(!e||0===e.length)throw new Error("Bad command name");const i={type:"cmd",transId:this.maxId++,name:e,data:t};r&&(i.namespace=r);const o=JSON.stringify(i);i.resolve=n,i.reject=s,this.transactions.set(i.transId,i);try{this.transport.send(o)}catch(e){throw this.transactions.delete(i.transId),e}}))}event(e,t,r){if(!e||0===e.length)throw new Error("Bad event name");const n={type:"event",name:e,data:t};r&&(n.namespace=r);const s=JSON.stringify(n);this.transport.send(s)}namespace(e){let t=this.namespaces.get(e);return t||(t=new sr(e,this),this.namespaces.set(e,t),t)}close(){for(const e of this.namespaces.values())e.close();this.transport.removeListener?this.transport.removeListener("message",this.listener):this.transport.removeEventListener("message",this.listener)}};const or=S.get("Signaling"),ar="wsConnectionSuccess",cr="wsConnectionError",ur="wsConnectionClose",lr="broadcastEvent",dr={VP8:"vp8",VP9:"vp9",H264:"h264",AV1:"av1"},fr={OPUS:"opus",MULTIOPUS:"multiopus"};class pr extends pe{constructor(e={streamName:null,url:"ws://localhost:8080/"}){super(),this.streamName=e.streamName,this.wsUrl=e.url,this.webSocket=null,this.transactionManager=null}connect(){var e=this;return o((function*(){var t;return or.info("Connecting to Signaling Server"),e.transactionManager&&(null===(t=e.webSocket)||void 0===t?void 0:t.readyState)===WebSocket.OPEN?(or.info("Connected to server: ",e.webSocket.url),or.debug("WebSocket value: ",{url:e.webSocket.url,protocol:e.webSocket.protocol,readyState:e.webSocket.readyState,binaryType:e.webSocket.binaryType,extensions:e.webSocket.extensions}),e.emit(ar,{ws:e.webSocket,tm:e.transactionManager}),e.webSocket):new Promise(((t,r)=>{e.webSocket=new WebSocket(e.wsUrl),e.transactionManager=new ir(e.webSocket),e.webSocket.onopen=()=>{or.info("WebSocket opened"),e.transactionManager.on("event",(t=>{e.emit(lr,t)})),or.info("Connected to server: ",e.webSocket.url),or.debug("WebSocket value: ",{url:e.webSocket.url,protocol:e.webSocket.protocol,readyState:e.webSocket.readyState,binaryType:e.webSocket.binaryType,extensions:e.webSocket.extensions}),e.emit(ar,{ws:e.webSocket,tm:e.transactionManager}),t(e.webSocket)},e.webSocket.onerror=()=>{or.error("WebSocket not connected: ",e.webSocket.url),e.emit(cr,e.webSocket.url),r(e.webSocket.url)},e.webSocket.onclose=()=>{e.webSocket=null,e.transactionManager=null,or.info("Connection closed with Signaling Server."),e.emit(ur)}}))}))()}close(){var e;or.info("Closing connection with Signaling Server."),null===(e=this.webSocket)||void 0===e||e.close()}subscribe(e){var t=this;return o((function*(){or.info("Starting subscription to streamName: ",t.streamName),or.debug("Subcription local description: ",e);const r={sdp:e=rr.adaptCodecName(e,"AV1X",dr.AV1),streamId:t.streamName};try{yield t.connect(),or.info("Sending view command");const e=yield t.transactionManager.cmd("view",r);return e.sdp=rr.adaptCodecName(e.sdp,dr.AV1,"AV1X"),or.info("Command sent, subscriberId: ",e.subscriberId),or.debug("Command result: ",e),e.sdp}catch(e){throw or.error("Error sending view command, error: ",e),e}}))()}publish(e,t=dr.H264,r=null){var n=this;return o((function*(){or.info(`Starting publishing to streamName: ${n.streamName}, codec: ${t}`),or.debug("Publishing local description: ",e);const s=Object.values(dr);if(-1===s.indexOf(t))throw or.error("Invalid codec. Possible values are: ",s),new Error(`Invalid codec. Possible values are: ${s}`);t===dr.AV1&&(e=rr.adaptCodecName(e,"AV1X",dr.AV1));const i={name:n.streamName,sdp:e,codec:t};null!==r&&(i.record=r);try{var o;yield n.connect(),or.info("Sending publish command");const e=yield n.transactionManager.cmd("publish",i);return t===dr.AV1&&(e.sdp=rr.adaptCodecName(e.sdp,dr.AV1,"AV1X")),-1!==(null===(o=e.sdp)||void 0===o?void 0:o.indexOf("\na=extmap-allow-mixed"))&&(e.sdp=rr.removeSdpLine(e.sdp,"a=extmap-allow-mixed")),or.info("Command sent, publisherId: ",e.publisherId),or.debug("Command result: ",e),e.sdp}catch(e){throw or.error("Error sending publish command, error: ",e),e}}))()}}const hr=S.get("PeerConnection"),mr={track:"track",connectionStateChange:"connectionStateChange"},gr={stereo:!1,mediaStream:null,codec:"h264",simulcast:!1,scalabilityMode:null,disableAudio:!1,disableVideo:!1};class yr extends pe{constructor(){super(),this.sessionDescription=null,this.peer=null,this.peerConnectionStats=null}createRTCPeer(e=null){var t=this;return o((function*(){hr.info("Creating new RTCPeerConnection"),hr.debug("RTC configuration provided by user: ",e),e=yield t.getRTCConfiguration(e),t.peer=br(t,e)}))()}getRTCPeer(){if(hr.info("Getting RTC Peer"),this.peer){const e=Tr(this.peer),t=this.peer,r=t.currentLocalDescription,n=t.currentRemoteDescription;hr.debug("getRTCPeer return: ",{connectionState:e,currentLocalDescription:r,currentRemoteDescription:n})}return this.peer}closeRTCPeer(){var e=this;return o((function*(){var t;hr.info("Closing RTCPeerConnection"),null===(t=e.peer)||void 0===t||t.close(),e.peer=null,e.stopStats(),e.emit(mr.connectionStateChange,"closed")}))()}getRTCConfiguration(e){var t=this;return o((function*(){var r;hr.info("Getting RTC configuration");const n=null!=e?e:{};return n.iceServers=null!==(r=n.iceServers)&&void 0!==r?r:yield t.getRTCIceServers(),n}))()}getRTCIceServers(e="https://turn1.wowza.com/webrtc/_turn"){return o((function*(){hr.info("Getting RTC ICE servers"),hr.debug("RTC ICE servers request location: ",e);const t=[];try{const s=(yield ce.put(e)).data;if(hr.debug("RTC ICE servers response: ",s),"ok"===s.s){var r,n=u(s.v.iceServers);try{for(n.s();!(r=n.n()).done;){const e=r.value,n=e.url;n&&(e.urls=n,delete e.url),t.push(e)}}catch(e){n.e(e)}finally{n.f()}hr.info("RTC ICE servers successfully obtained.")}}catch(e){hr.error("Error while getting RTC ICE servers: ",e.response.data)}return t}))()}setRTCRemoteSDP(e){var t=this;return o((function*(){hr.info("Setting RTC Remote SDP");const r={type:"answer",sdp:e};try{yield t.peer.setRemoteDescription(r),hr.info("RTC Remote SDP was set successfully."),hr.debug("RTC Remote SDP new value: ",e)}catch(e){throw hr.error("Error while setting RTC Remote SDP: ",e),e}}))()}getRTCLocalSDP(e=gr){var t=this;return o((function*(){hr.info("Getting RTC Local SDP"),e=s(s({},gr),e),hr.debug("Options: ",e);const r=vr(e.mediaStream);r?Cr(t.peer,r,e):Er(t.peer,e),hr.info("Creating peer offer");const n=yield t.peer.createOffer();return hr.info("Peer offer created"),hr.debug("Peer offer response: ",n.sdp),t.sessionDescription=n,e.disableAudio||(t.sessionDescription.sdp=rr.setMultiopus(t.sessionDescription.sdp,r),e.stereo&&(t.sessionDescription.sdp=rr.setStereo(t.sessionDescription.sdp))),!e.disableVideo&&e.simulcast&&(t.sessionDescription.sdp=rr.setSimulcast(t.sessionDescription.sdp,e.codec)),yield t.peer.setLocalDescription(t.sessionDescription),hr.info("Peer local description set"),t.sessionDescription.sdp}))()}updateBandwidthRestriction(e,t){return hr.info("Updating bandwidth restriction, bitrate value: ",t),hr.debug("SDP value: ",e),rr.setVideoBitrate(e,t)}updateBitrate(e=0){var t=this;return o((function*(){if(!t.peer)throw hr.error("Cannot update bitrate. No peer found."),new Error("Cannot update bitrate. No peer found.");hr.info("Updating bitrate to value: ",e),t.sessionDescription=yield t.peer.createOffer(),yield t.peer.setLocalDescription(t.sessionDescription);const r=t.updateBandwidthRestriction(t.peer.remoteDescription.sdp,e);yield t.setRTCRemoteSDP(r),hr.info("Bitrate restirctions updated: ",`${e>0?e:"unlimited"} kbps`)}))()}getRTCPeerStatus(){if(hr.info("Getting RTC peer status"),!this.peer)return null;const e=Tr(this.peer);return hr.info("RTC peer status getted, value: ",e),e}replaceTrack(e){if(!this.peer)return void hr.error("Could not change track if there is not an active connection.");const t=this.peer.getSenders().find((t=>t.track.kind===e.kind));t?t.replaceTrack(e):hr.error(`There is no ${e.kind} track in active broadcast.`)}static getCapabilities(e){const t=new Kt;if(t.isFirefox())return(e=>"video"===e?{codecs:[{codec:"vp8",mimeType:"video/VP8"},{codec:"vp9",mimeType:"video/VP9"},{codec:"h264",mimeType:"video/H264"}],headerExtensions:[]}:"audio"===e?{codecs:[{codec:"opus",mimeType:"audio/opus",channels:2}],headerExtensions:[]}:null)(e);const r=RTCRtpSender.getCapabilities(e);if(r){const o={};let a=new RegExp(`^video/(${Object.values(dr).join("|")})x?$`,"i");"audio"===e&&(a=new RegExp(`^audio/(${Object.values(fr).join("|")})$`,"i"),t.isChrome()&&(o.multiopus={mimeType:"audio/multiopus",channels:6}));var n,i=u(r.codecs);try{for(i.s();!(n=i.n()).done;){const e=n.value,t=e.mimeType.match(a);if(t){const r=t[1].toLowerCase();if(o[r]=s(s({},o[r]),{},{mimeType:e.mimeType}),e.scalabilityModes){let t=o[r].scalabilityModes||[];t=[...t,...e.scalabilityModes],o[r].scalabilityModes=[...new Set(t)]}e.channels&&(o[r].channels=e.channels)}}}catch(e){i.e(e)}finally{i.f()}r.codecs=Object.keys(o).map((e=>s({codec:e},o[e])))}return r}getTracks(){var e,t;return null===(e=this.peer)||void 0===e||null===(t=e.getSenders())||void 0===t?void 0:t.map((e=>e.track))}initStats(){this.peerConnectionStats?hr.warn("Cannot init peer stats: Already initialized"):this.peer?(this.peerConnectionStats=new Le(this.peer),this.peerConnectionStats.init(),Ie(this.peerConnectionStats,this,[Pe])):hr.warn("Cannot init peer stats: RTCPeerConnection not initialized")}stopStats(){var e;null===(e=this.peerConnectionStats)||void 0===e||e.stop(),this.peerConnectionStats=null}}const wr=e=>(null==e?void 0:e.getAudioTracks().length)<=1&&(null==e?void 0:e.getVideoTracks().length)<=1,vr=e=>{if(!e)return null;if(e instanceof MediaStream&&wr(e))return e;if(!(e instanceof MediaStream)){hr.info("Creating MediaStream to add received tracks.");const n=new MediaStream;var t,r=u(e);try{for(r.s();!(t=r.n()).done;){const e=t.value;n.addTrack(e)}}catch(e){r.e(e)}finally{r.f()}if(wr(n))return n}throw hr.error("MediaStream must have 1 audio track and 1 video track, or at least one of them."),new Error("MediaStream must have 1 audio track and 1 video track, or at least one of them.")},br=(e,t)=>{const r=new RTCPeerConnection(t);return Sr(e,r),r},Sr=(e,t)=>{t.ontrack=t=>{hr.info("New track from peer."),hr.debug("Track event value: ",t),e.emit(mr.track,t)},t.connectionState?t.onconnectionstatechange=r=>{hr.info("Peer connection state change: ",t.connectionState),e.emit(mr.connectionStateChange,t.connectionState)}:t.oniceconnectionstatechange=r=>{hr.info("Peer ICE connection state change: ",t.iceConnectionState),e.emit(mr.connectionStateChange,t.iceConnectionState)}},Cr=(e,t,r)=>{hr.info("Adding mediaStream tracks to RTCPeerConnection");var n,s=u(t.getTracks());try{for(s.s();!(n=s.n()).done;){const s=n.value,i={streams:[t]};"audio"===s.kind&&(i.direction=r.disableAudio?"inactive":"sendonly"),"video"===s.kind&&(i.direction=r.disableVideo?"inactive":"sendonly",r.scalabilityMode&&(new Kt).isChrome()?(hr.debug(`Video track with scalability mode: ${r.scalabilityMode}.`),i.sendEncodings=[{scalabilityMode:r.scalabilityMode}]):r.scalabilityMode&&hr.warn("SVC is only supported in Google Chrome")),e.addTransceiver(s,i),hr.info(`Track '${s.label}' added: `,`id: ${s.id}`,`kind: ${s.kind}`)}}catch(e){s.e(e)}finally{s.f()}},Er=(e,t)=>{e.addTransceiver("video",{direction:t.disableVideo?"inactive":"recvonly"}),e.addTransceiver("audio",{direction:t.disableAudio?"inactive":"recvonly"})},Tr=e=>{var t;const r=null!==(t=e.connectionState)&&void 0!==t?t:e.iceConnectionState;switch(r){case"checking":return"connecting";case"completed":return"connected";default:return r}},Ir=S.get("Director"),xr="WebRtc";let Rr="https://realtime1.wowza.com";const kr=(e,t,r)=>{let n="object"==typeof e?e:{};return 0===Object.keys(n).length&&(n={token:e,streamName:t,streamType:r}),n},Ar=(e,t,r)=>{let n="object"==typeof e?e:{};return 0===Object.keys(n).length&&(n={streamName:e,streamAccountId:t,subscriberToken:r}),n};function Pr(e){this.message=e}function Lr(e){this.message=e}let Or;Pr.prototype=new Error,Pr.prototype.name="InvalidCharacterError","undefined"!=typeof window&&window.atob&&window.atob.bind(window),Lr.prototype=new Error,Lr.prototype.name="InvalidTokenError";class Nr extends pe{constructor(e,t,r,n){if(super(),Or=r,!e)throw Or.error("Stream Name is required to construct this module."),new Error("Stream Name is required to construct this module.");if(!t)throw Or.error("Token generator is required to construct this module."),new Error("Token generator is required to construct this module.");this.webRTCPeer=new yr,this.signaling=null,this.streamName=e,this.autoReconnect=n,this.reconnectionInterval=1e3,this.alreadyDisconnected=!1,this.firstReconnection=!0,this.tokenGenerator=t,this.options=null}getRTCPeerConnection(){return this.webRTCPeer?this.webRTCPeer.getRTCPeer():null}stop(){var e;Or.info("Stopping"),this.webRTCPeer.closeRTCPeer(),null===(e=this.signaling)||void 0===e||e.close(),this.signaling=null,this.webRTCPeer=new yr}isActive(){const e=this.webRTCPeer.getRTCPeerStatus();return Or.info("Broadcast status: ",e||"not_established"),"connected"===e}setReconnect(){this.autoReconnect&&(this.signaling.on(cr,(()=>{!this.firstReconnection&&this.alreadyDisconnected||(this.firstReconnection=!1,this.reconnect())})),this.webRTCPeer.on(mr.connectionStateChange,(e=>{("failed"===e||"disconnected"===e&&this.alreadyDisconnected)&&this.firstReconnection?(this.firstReconnection=!1,this.reconnect()):"disconnected"===e?(this.alreadyDisconnected=!0,setTimeout((()=>this.reconnect()),1500)):this.alreadyDisconnected=!1})))}reconnect(){var e=this;return o((function*(){try{e.isActive()||(e.stop(),yield e.connect(e.options),e.alreadyDisconnected=!1,e.reconnectionInterval=1e3,e.firstReconnection=!0)}catch(t){e.reconnectionInterval=Br(e.reconnectionInterval),Or.error(`Reconnection failed, retrying in ${e.reconnectionInterval}ms. Error was: `,t),e.emit("reconnect",{timeout:e.reconnectionInterval,error:t}),setTimeout((()=>e.reconnect()),e.reconnectionInterval)}}))()}}const Br=e=>e<32e3?2*e:e;S.get("Publish");const Dr=S.get("View"),Mr={disableVideo:!1,disableAudio:!1,peerConfig:null};class Ur extends Nr{constructor(e,t,r=null,n=!0){super(e,t,Dr,n),r&&this.on(mr.track,(e=>{r.srcObject=e.streams[0]}))}connect(e=Mr){var t=this;return o((function*(){if(Dr.debug("Viewer connect options values: ",e),t.options=s(s({},Mr),e),t.isActive())throw Dr.warn("Viewer currently subscribed"),new Error("Viewer currently subscribed");let r;try{r=yield t.tokenGenerator()}catch(e){throw Dr.error("Error generating token."),e}if(!r)throw Dr.error("Error while subscribing. Subscriber data required"),new Error("Subscriber data required");t.signaling=new pr({streamName:t.streamName,url:`${r.urls[0]}?token=${r.jwt}`}),yield t.webRTCPeer.createRTCPeer(t.options.peerConfig),Ie(t.webRTCPeer,t,Object.values(mr));const n=yield t.webRTCPeer.getRTCLocalSDP(s(s({},t.options),{},{stereo:!0})),i=yield t.signaling.subscribe(n);Ie(t.signaling,t,[lr]),yield t.webRTCPeer.setRTCRemoteSDP(i),t.setReconnect(),Dr.info("Connected to streamName: ",t.streamName)}))()}}S.get("EventSubscriber"),S.get("StreamEvents"),window.Logger=S;var _r=new URL(window.location.href);!_r.searchParams.get("url")||_r.searchParams.get("url");var jr=_r.searchParams.get("streamName")?_r.searchParams.get("streamName"):process.env.MILLICAST_STREAM_NAME,Fr=_r.searchParams.get("streamAccountId")?_r.searchParams.get("streamAccountId"):"bUEzT6";console.log("name "+jr),console.log("account "+Fr);var Vr="true"===_r.searchParams.get("disableVideo"),$r="true"===_r.searchParams.get("disableAudio"),zr="true"===_r.searchParams.get("muted")||null===_r.searchParams.get("muted"),Gr="true"===_r.searchParams.get("autoplay")||null===_r.searchParams.get("autoplay"),qr="true"===_r.searchParams.get("autoReconnect")||null===_r.searchParams.get("autoReconnect");"true"===_r.searchParams.get("disableControls")&&_r.searchParams.get("disableControls");"true"===_r.searchParams.get("disableVolume")&&_r.searchParams.get("disableVolume"),"true"===_r.searchParams.get("disablePlay")&&_r.searchParams.get("disablePlay"),"true"===_r.searchParams.get("disableFull")&&_r.searchParams.get("disableFull");var Xr,Hr=document.querySelector("#fullBtn"),Wr=document.querySelector("video"),Yr=null,Jr=function(){var e=new Ur(jr,(function(){return class{static setEndpoint(e){Rr=e.replace(/\/$/,"")}static getEndpoint(){return Rr}static getPublisher(e,t=null,r=xr){var n=this;return o((function*(){const s=kr(e,t,r);Ir.info("Getting publisher connection path for stream name: ",s.streamName);const i={streamName:s.streamName,streamType:s.streamType},o={Authorization:`Bearer ${s.token}`},a=`${n.getEndpoint()}/api/director/publish`;try{const e=(yield ce.post(a,i,{headers:o})).data;return Ir.debug("Getting publisher response: ",e),e.data}catch(e){var c;throw Ir.error("Error while getting publisher connection path: ",null===(c=e.response)||void 0===c?void 0:c.data),e}}))()}static getSubscriber(e,t=null,r=null){var n=this;return o((function*(){const s=Ar(e,t,r);Ir.info(`Getting subscriber connection data for stream name: ${s.streamName} and account id: ${s.streamAccountId}`);const i={streamAccountId:s.streamAccountId,streamName:s.streamName};let o={};s.subscriberToken&&(o={Authorization:`Bearer ${s.subscriberToken}`});const a=`${n.getEndpoint()}/api/director/subscribe`;try{const e=(yield ce.post(a,i,{headers:o})).data;return Ir.debug("Getting subscriber response: ",e),e.data}catch(e){var c;throw Ir.error("Error while getting subscriber connection path: ",null===(c=e.response)||void 0===c?void 0:c.data),e}}))()}}.getSubscriber(jr,Fr)}),null,qr);return e.on("broadcastEvent",(function(e){if(qr){var t=null!==e.data.layers?e.data.layers:{};"layers"===e.name&&Object.keys(t).length}})),e.on("track",(function(e){Kr(e.streams[0])})),e},Zr=function(){var e=Hr.children[0];document.fullscreenElement?document.exitFullscreen&&(document.exitFullscreen(),e.classList.remove("fa-expand"),e.classList.add("fa-compress")):(document.documentElement.requestFullscreen(),e.classList.remove("fa-compress"),e.classList.add("fa-expand"))},Kr=function(e){var t=document.querySelector("audio");Vr?(t&&(t.srcObject=e),Wr&&Wr.parentNode.removeChild(Wr),Wr.paused?Wr.play():Wr.pause()):(Wr.id=e.id,zr||Wr.removeAttribute("muted"),Gr||(Wr.autoplay=!1,Wr.removeAttribute("autoplay")),Wr.srcObject=e,t&&t.parentNode.removeChild(t))},Qr=!1,en=function(){var e,t;return Wr.srcObject=null,null===(e=Yr)||void 0===e||null===(t=e.millicastSignaling)||void 0===t||t.close(),Yr=null,Qr=!1,Promise.resolve({})},tn=(Xr=function(t){return function(){var r=this,n=arguments;return new Promise((function(s,i){var o=t.apply(r,n);function a(t){e(o,s,i,a,c,"next",t)}function c(t){e(o,s,i,a,c,"throw",t)}a(void 0)}))}}(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null!==(t=Yr)&&void 0!==t&&t.isActive()||Qr)){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,Qr=!0,n={disableVideo:Vr,disableAudio:$r},Yr=Jr(),e.next=8,Yr.connect(n);case 8:e.next=15;break;case 10:if(e.prev=10,e.t0=e.catch(2),qr){e.next=14;break}return e.abrupt("return");case 14:Yr.reconnect();case 15:case"end":return e.stop()}}),e,null,[[2,10]])}))),function(){return Xr.apply(this,arguments)});document.addEventListener("DOMContentLoaded",(function(){var e,t,r,n=function(n){e&&clearInterval(e),e=setInterval((function(){var s=n.clientX,i=n.clientY;s===t&&i===r?clearInterval(e):(t=s,r=i)}),1e3)};Hr&&(Hr.onclick=Zr),Wr.onmousemove=function(e){n(e)},Wr.addEventListener("touchstart",(function(e){n(e)}),!1),e=setInterval((function(){clearInterval(e)}),2e3),tn()}));window.__onGCastApiAvailable=function(e){if(!e)return!1;var t=cast.framework.CastContextEventType.CAST_STATE_CHANGED,r=cast.framework.CastContext.getInstance();r.setOptions({autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,receiverApplicationId:"B5B8307B"}),r.addEventListener(t,(function(e){var t=e.castState;if(t===cast.framework.CastState.NOT_CONNECTED&&tn(),t===cast.framework.CastState.CONNECTED){var n=r.getCurrentSession(),s=new chrome.cast.media.MediaInfo(jr,"");s.customData={streamName:jr,streamAccountId:Fr},s.streamType=chrome.cast.media.StreamType.LIVE;var i=new chrome.cast.media.LoadRequest(s);n.loadMedia(i).then(en)}}))}}));
